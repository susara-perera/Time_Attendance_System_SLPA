{"version":3,"file":"static/js/515.1bcd9837.chunk.js","mappings":"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","sources":["components/dashboard/PageHeader.jsx","components/dashboard/Settings.jsx"],"sourcesContent":["import React from 'react';\r\nimport './PageHeader.css';\r\nimport logo from '../../assets/logo.jpg';\r\n\r\n/**\r\n * Reusable Page Header Component with Logo\r\n * @param {string} title - The page title\r\n * @param {string} subtitle - The page subtitle/description\r\n * @param {string} icon - Bootstrap icon class (e.g., \"bi-building\")\r\n * @param {React.ReactNode} actions - Optional action buttons\r\n * @param {function} onBack - Optional back navigation function\r\n */\r\nconst PageHeader = ({ title, subtitle, icon = 'bi-folder', actions, onBack }) => {\r\n  return (\r\n    <>\r\n      {onBack && (\r\n        <button \r\n          className=\"back-arrow-btn\"\r\n          onClick={onBack}\r\n          title=\"Back to Dashboard\"\r\n          style={{ marginBottom: '12px', background: 'transparent', color: '#0f172a', border: '1px solid rgba(15,23,42,0.08)', width: 'auto', padding: '8px 12px' }}\r\n        >\r\n          <i className=\"bi bi-arrow-left\"></i>&nbsp;<span style={{ fontWeight: 600 }}>Back</span>\r\n        </button>\r\n      )}\r\n      <div className=\"page-header-banner\">\r\n        <div className=\"page-header-content\">\r\n          <div className=\"page-header-left\">\r\n            <div className=\"page-header-icon\">\r\n              <i className={`bi ${icon}`}></i>\r\n            </div>\r\n            <div className=\"page-header-text\">\r\n              <h1>{title}</h1>\r\n              {subtitle && <p>{subtitle}</p>}\r\n            </div>\r\n          </div>\r\n        <div className=\"page-header-right\">\r\n          {actions && <div className=\"page-header-actions\">{actions}</div>}\r\n          <div className=\"page-header-logo\">\r\n            <img src={logo} alt=\"Company Logo\" />\r\n          </div>\r\n        </div>\r\n      </div>\r\n      {/* Decorative Elements */}\r\n      <div className=\"page-header-decoration\">\r\n        <div className=\"decoration-circle decoration-circle-1\"></div>\r\n        <div className=\"decoration-circle decoration-circle-2\"></div>\r\n        <div className=\"decoration-circle decoration-circle-3\"></div>\r\n      </div>\r\n    </div>\r\n    </>\r\n  );\r\n};\r\n\r\nexport default PageHeader;\r\n","\r\n\r\nimport React, { useState, useEffect, useContext } from 'react';\r\nimport './settings-theme.css';\r\nimport { useLanguage } from '../../context/LanguageContext';\r\nimport { AuthContext } from '../../context/AuthContext';\r\nimport PageHeader from './PageHeader';\r\n\r\nconst TOOLTIP = {\r\n  systemName: 'The name displayed across the system.',\r\n  timezone: 'Select the timezone for attendance records.',\r\n  workingHours: 'Set the official working hours for employees.',\r\n  emailNotifications: 'Enable or disable system email notifications.',\r\n  autoLogout: 'Time in minutes before automatic logout due to inactivity.',\r\n};\r\n\r\nconst Settings = ({ onBack }) => {\r\n  const formatAddress = (addr) => {\r\n    if (!addr) return '';\r\n    if (typeof addr === 'string') return addr;\r\n    if (typeof addr === 'object') {\r\n      return addr.city || addr.street || addr.address || addr.line1 || Object.values(addr).find(v => typeof v === 'string') || JSON.stringify(addr);\r\n    }\r\n    return String(addr);\r\n  };\r\n  const [settings, setSettings] = useState({\r\n    systemName: 'Time Attendance System',\r\n    timezone: 'Asia/Colombo',\r\n    workingHours: {\r\n      start: '09:00',\r\n      end: '17:00',\r\n    },\r\n    emailNotifications: true,\r\n    autoLogout: 30,\r\n  });\r\n  const [activeTab, setActiveTab] = useState('general');\r\n  // Additional settings state\r\n  const { lang, setLang, t } = useLanguage();\r\n  const { user, hasPermission } = useContext(AuthContext);\r\n\r\n  const hasSettingPerm = (permId) => {\r\n    if (!user) return false;\r\n    if (user.role === 'super_admin') return true;\r\n    // If the AuthContext exposes hasPermission, prefer it (supports dotted paths)\r\n    if (typeof hasPermission === 'function') {\r\n      if (permId.includes('.')) return hasPermission(permId);\r\n      return hasPermission(`settings.${permId}`);\r\n    }\r\n    const s = user.permissions?.settings || {};\r\n    // support boolean or string 'true' values\r\n    return s[permId] === true || s[permId] === 'true' || false;\r\n  };\r\n\r\n  // Ensure activeTab defaults to the first permitted tab and cannot point to a tab the user\r\n  // does not have permission for.\r\n  useEffect(() => {\r\n    const tabsOrder = ['profile', 'general', 'appearance', 'security'];\r\n    const mapping = {\r\n      // profile has no permission requirement; available to any authenticated user\r\n      profile: null,\r\n      general: 'settings_general',\r\n      appearance: 'settings_appearance',\r\n      security: 'settings_security'\r\n    };\r\n    // If current activeTab has a mapped permission, ensure it's permitted; otherwise allow it\r\n    if (mapping[activeTab] && !hasSettingPerm(mapping[activeTab])) {\r\n      const firstAllowed = tabsOrder.find(t => !mapping[t] || hasSettingPerm(mapping[t]));\r\n      if (firstAllowed) setActiveTab(firstAllowed);\r\n    }\r\n  }, [user, activeTab]);\r\n  const [theme, setTheme] = useState(() => {\r\n    try {\r\n      return localStorage.getItem('appTheme') || 'Light';\r\n    } catch (e) {\r\n      return 'Light';\r\n    }\r\n  });\r\n  const [password, setPassword] = useState('');\r\n  const [notificationSound, setNotificationSound] = useState(true);\r\n  const [exportType, setExportType] = useState('CSV');\r\n  const [notificationEmails, setNotificationEmails] = useState(() => {\r\n    try {\r\n      const raw = localStorage.getItem('notificationEmails');\r\n      return raw ? JSON.parse(raw) : [];\r\n    } catch (e) {\r\n      return [];\r\n    }\r\n  });\r\n  const [newMail, setNewMail] = useState('');\r\n  const [mailError, setMailError] = useState('');\r\n  // Profile edit states\r\n  const [profileLoading, setProfileLoading] = useState(false);\r\n  const [profileSubmitting, setProfileSubmitting] = useState(false);\r\n  const [profileMsg, setProfileMsg] = useState(null);\r\n  const [profileSuccess, setProfileSuccess] = useState(false);\r\n  const [profileFirstName, setProfileFirstName] = useState('');\r\n  const [profileLastName, setProfileLastName] = useState('');\r\n  const [profilePhone, setProfilePhone] = useState('');\r\n  const [profileAddress, setProfileAddress] = useState('');\r\n  const API_BASE_URL = process.env.REACT_APP_API_URL || 'http://localhost:5000/api';\r\n\r\n  // Password change / verify states\r\n  const [oldPassword, setOldPassword] = useState('');\r\n  const [oldPasswordValid, setOldPasswordValid] = useState(false);\r\n  const [oldPasswordChecking, setOldPasswordChecking] = useState(false);\r\n  const [oldPasswordError, setOldPasswordError] = useState('');\r\n  const [oldPasswordSuccess, setOldPasswordSuccess] = useState('');\r\n  const [newPassword, setNewPassword] = useState('');\r\n  const [confirmNewPassword, setConfirmNewPassword] = useState('');\r\n  const [changeMsg, setChangeMsg] = useState('');\r\n  const [submittingPassword, setSubmittingPassword] = useState(false);\r\n  const [changeSuccess, setChangeSuccess] = useState(false);\r\n  const [showForgotForm, setShowForgotForm] = useState(false);\r\n  const [forgotEmail, setForgotEmail] = useState('');\r\n  const [forgotStatus, setForgotStatus] = useState(null);\r\n  // OTP / reset flow states\r\n  const [otpSent, setOtpSent] = useState(false);\r\n  const [otpValue, setOtpValue] = useState('');\r\n  const [otpError, setOtpError] = useState('');\r\n  const [verifyingOtp, setVerifyingOtp] = useState(false);\r\n  const [resetToken, setResetToken] = useState('');\r\n  const [showResetForm, setShowResetForm] = useState(false);\r\n  const [resetNewPassword, setResetNewPassword] = useState('');\r\n  const [resetConfirmPassword, setResetConfirmPassword] = useState('');\r\n  const [resettingPassword, setResettingPassword] = useState(false);\r\n  const [resetStatus, setResetStatus] = useState(null);\r\n\r\n  \r\n\r\n  // Apply theme to document root and persist choice\r\n  useEffect(() => {\r\n    try {\r\n      const mode = theme === 'Dark' ? 'dark' : 'light';\r\n      document.documentElement.setAttribute('data-theme', mode);\r\n      localStorage.setItem('appTheme', theme);\r\n    } catch (e) {\r\n      // ignore\r\n    }\r\n  }, [theme]);\r\n\r\n  // Persist notification emails whenever they change\r\n  useEffect(() => {\r\n    try {\r\n      localStorage.setItem('notificationEmails', JSON.stringify(notificationEmails));\r\n    } catch (e) {\r\n      // ignore\r\n    }\r\n  }, [notificationEmails]);\r\n\r\n  // Prevent background scroll when forgot-password modal is open\r\n  useEffect(() => {\r\n    if (showForgotForm) {\r\n      document.body.style.overflow = 'hidden';\r\n    } else {\r\n      document.body.style.overflow = '';\r\n    }\r\n    return () => { document.body.style.overflow = ''; };\r\n  }, [showForgotForm]);\r\n\r\n  // Load profile when profile tab becomes active\r\n  useEffect(() => {\r\n    const loadProfile = async () => {\r\n      setProfileLoading(true);\r\n      setProfileMsg(null);\r\n      try {\r\n        const token = localStorage.getItem('token');\r\n        const res = await fetch(`${API_BASE_URL}/auth/me`, {\r\n          method: 'GET',\r\n          headers: { 'Content-Type': 'application/json', Authorization: token ? `Bearer ${token}` : '' },\r\n          credentials: 'include'\r\n        });\r\n        if (res.ok) {\r\n          const data = await res.json();\r\n          const user = data.data;\r\n          setProfileFirstName(user.firstName || '');\r\n          setProfileLastName(user.lastName || '');\r\n          setProfilePhone(user.phone || '');\r\n          setProfileAddress(formatAddress(user.address));\r\n        } else {\r\n          setProfileMsg('Failed to load profile');\r\n        }\r\n      } catch (err) {\r\n        console.error('Load profile error', err);\r\n        setProfileMsg('Failed to load profile');\r\n      } finally {\r\n        setProfileLoading(false);\r\n      }\r\n    };\r\n\r\n    if (activeTab === 'profile') {\r\n      loadProfile();\r\n    }\r\n  }, [activeTab]);\r\n\r\n  const validateEmail = (email) => {\r\n    const re = /^[^\\s@]+@[^\\s@]+\\.[^\\s@]+$/;\r\n    return re.test(String(email).toLowerCase());\r\n  };\r\n\r\n  const handleAddMail = () => {\r\n    const mail = newMail.trim();\r\n    if (!mail) {\r\n      setMailError('Please enter an email address');\r\n      return;\r\n    }\r\n    if (!validateEmail(mail)) {\r\n      setMailError('Please enter a valid email address');\r\n      return;\r\n    }\r\n    if (notificationEmails.includes(mail)) {\r\n      setMailError('This email is already added');\r\n      return;\r\n    }\r\n    setNotificationEmails((prev) => [...prev, mail]);\r\n    setNewMail('');\r\n    setMailError('');\r\n  };\r\n\r\n  const handleRemoveMail = (mailToRemove) => {\r\n    setNotificationEmails((prev) => prev.filter((m) => m !== mailToRemove));\r\n  };\r\n\r\n  return (\r\n    <div\r\n      className=\"settings-page container-fluid\"\r\n      style={{ width: '100%', margin: '6px 0', padding: '12px 12px', boxSizing: 'border-box' }}\r\n    >\r\n      {/* Professional Section Header with Logo */}\r\n      <PageHeader\r\n        title={t('systemSettings')}\r\n        subtitle=\"Configure system preferences and user settings\"\r\n        icon=\"bi-gear-fill\"\r\n        actions={\r\n          <button \r\n            className=\"btn-professional btn-secondary\"\r\n            onClick={onBack}\r\n            title=\"Back to Dashboard\"\r\n          >\r\n            <i className=\"bi bi-arrow-left\"></i> Back\r\n          </button>\r\n        }\r\n      />\r\n      \r\n      <div className=\"row\" style={{ marginTop: '20px' }}>\r\n        {/* Sidebar Navigation */}\r\n        <div className=\"col-12 col-md-3 col-lg-2 mb-4\">\r\n          <div className=\"list-group shadow-sm\" style={{ maxWidth: 220 }}>\r\n            {user && (\r\n              <button\r\n                className={`list-group-item list-group-item-action${activeTab === 'profile' ? ' active' : ''}`}\r\n                onClick={() => setActiveTab('profile')}\r\n              >\r\n                <i className=\"bi bi-person me-2\"></i> {t('profile')}\r\n              </button>\r\n            )}\r\n\r\n            {hasSettingPerm('settings_general') && (\r\n              <button\r\n                className={`list-group-item list-group-item-action${activeTab === 'general' ? ' active' : ''}`}\r\n                onClick={() => setActiveTab('general')}\r\n              >\r\n                <i className=\"bi bi-gear me-2\"></i> {t('general')}\r\n              </button>\r\n            )}\r\n\r\n            {hasSettingPerm('settings_appearance') && (\r\n              <button\r\n                className={`list-group-item list-group-item-action${activeTab === 'appearance' ? ' active' : ''}`}\r\n                onClick={() => setActiveTab('appearance')}\r\n              >\r\n                <i className=\"bi bi-palette me-2\"></i> {t('appearance')}\r\n              </button>\r\n            )}\r\n\r\n            {hasSettingPerm('settings_security') && (\r\n              <button\r\n                className={`list-group-item list-group-item-action${activeTab === 'security' ? ' active' : ''}`}\r\n                onClick={() => setActiveTab('security')}\r\n              >\r\n                <i className=\"bi bi-shield-lock me-2\"></i> {t('security')}\r\n              </button>\r\n            )}\r\n          </div>\r\n        </div>\r\n\r\n        {/* Main Content */}\r\n        <div className=\"col-12 col-md-9 col-lg-10\">\r\n          {/* Subsection buttons are hidden when the user lacks their permissions. */}\r\n          {activeTab === 'general' && (\r\n            <div className=\"card shadow-sm\" style={{ width: '100%' }}>\r\n              <div className=\"card-body\" style={{ padding: '22px' }}>\r\n                <h5 className=\"fw-bold mb-4\">{t('general')}</h5>\r\n                {/* System Name */}\r\n                <div className=\"mb-4\">\r\n                  <label className=\"form-label fw-bold\">\r\n                    {t('systemName')}\r\n                    <span className=\"ms-1 text-muted\" title={TOOLTIP.systemName}>\r\n                      <i className=\"bi bi-info-circle\"></i>\r\n                    </span>\r\n                  </label>\r\n                  <input\r\n                    type=\"text\"\r\n                    className=\"form-control\"\r\n                    value={settings.systemName}\r\n                    onChange={(e) => setSettings({ ...settings, systemName: e.target.value })}\r\n                  />\r\n                  <small className=\"form-text text-muted\">{TOOLTIP.systemName}</small>\r\n                </div>\r\n\r\n                {/* Timezone */}\r\n                <div className=\"mb-4\">\r\n                  <label className=\"form-label fw-bold\">\r\n                    {t('timezone')}\r\n                    <span className=\"ms-1 text-muted\" title={TOOLTIP.timezone}>\r\n                      <i className=\"bi bi-info-circle\"></i>\r\n                    </span>\r\n                  </label>\r\n                  <select\r\n                    className=\"form-select\"\r\n                    value={settings.timezone}\r\n                    onChange={(e) => setSettings({ ...settings, timezone: e.target.value })}\r\n                  >\r\n                    <option value=\"Asia/Colombo\">Asia/Colombo</option>\r\n                    <option value=\"UTC\">UTC</option>\r\n                  </select>\r\n                  <small className=\"form-text text-muted\">{TOOLTIP.timezone}</small>\r\n                </div>\r\n\r\n                {/* Working Hours */}\r\n                <div className=\"mb-4 p-3 bg-light rounded\" style={{ background: '#fafbfc' }}>\r\n                  <h6 className=\"fw-bold mb-3\">\r\n                    <i className=\"bi bi-clock me-2\"></i>{t('workingHours')}\r\n                    <span className=\"ms-1 text-muted\" title={TOOLTIP.workingHours}>\r\n                      <i className=\"bi bi-info-circle\"></i>\r\n                    </span>\r\n                  </h6>\r\n                  <div className=\"row g-3\">\r\n                    <div className=\"col-12 col-sm-6\">\r\n                      <label className=\"form-label\">{t('startTime')}</label>\r\n                      <input\r\n                        type=\"time\"\r\n                        className=\"form-control\"\r\n                        value={settings.workingHours.start}\r\n                        onChange={(e) =>\r\n                          setSettings({\r\n                            ...settings,\r\n                            workingHours: { ...settings.workingHours, start: e.target.value },\r\n                          })\r\n                        }\r\n                      />\r\n                    </div>\r\n                    <div className=\"col-12 col-sm-6\">\r\n                      <label className=\"form-label\">{t('endTime')}</label>\r\n                      <input\r\n                        type=\"time\"\r\n                        className=\"form-control\"\r\n                        value={settings.workingHours.end}\r\n                        onChange={(e) =>\r\n                          setSettings({\r\n                            ...settings,\r\n                            workingHours: { ...settings.workingHours, end: e.target.value },\r\n                          })\r\n                        }\r\n                      />\r\n                    </div>\r\n                  </div>\r\n                  <small className=\"form-text text-muted\">{TOOLTIP.workingHours}</small>\r\n                </div>\r\n\r\n                {/* Language */}\r\n                <div className=\"mb-4\">\r\n                  <label className=\"form-label fw-bold\">{t('language')}</label>\r\n                  <select\r\n                    className=\"form-select\"\r\n                    value={lang}\r\n                    onChange={(e) => setLang(e.target.value)}\r\n                  >\r\n                    <option value=\"en\">English</option>\r\n                    <option value=\"si\">Sinhala</option>\r\n                    <option value=\"ta\">Tamil</option>\r\n                  </select>\r\n                  <small className=\"form-text text-muted\">Select your preferred language.</small>\r\n                </div>\r\n\r\n                {/* Clear Cache Button */}\r\n                <div className=\"mb-4 p-3 bg-light rounded\" style={{ background: '#fafbfc' }}>\r\n                  <h6 className=\"fw-bold mb-3\">\r\n                    <i className=\"bi bi-arrow-clockwise me-2\"></i>Cache Management\r\n                  </h6>\r\n                  <p className=\"text-muted small mb-3\">\r\n                    Clear all cached data to force fresh data retrieval from the database. This may temporarily slow down the system until cache is rebuilt.\r\n                  </p>\r\n                  <button\r\n                    className=\"btn btn-warning\"\r\n                    onClick={async () => {\r\n                      if (!window.confirm('Are you sure you want to clear all cached data? This may temporarily slow down the system.')) {\r\n                        return;\r\n                      }\r\n                      try {\r\n                        const token = localStorage.getItem('token');\r\n                        const res = await fetch(`${API_BASE_URL}/cache/clear-all`, {\r\n                          method: 'POST',\r\n                          headers: { \r\n                            'Content-Type': 'application/json', \r\n                            Authorization: token ? `Bearer ${token}` : '' \r\n                          },\r\n                          credentials: 'include'\r\n                        });\r\n                        const data = await res.json();\r\n                        if (res.ok) {\r\n                          alert('Cache cleared successfully!');\r\n                        } else {\r\n                          alert(`Failed to clear cache: ${data.message || 'Unknown error'}`);\r\n                        }\r\n                      } catch (err) {\r\n                        console.error('Clear cache error:', err);\r\n                        alert('Failed to clear cache. Please try again.');\r\n                      }\r\n                    }}\r\n                  >\r\n                    <i className=\"bi bi-trash me-2\"></i>Clear All Cache\r\n                  </button>\r\n                </div>\r\n              </div>\r\n            </div>\r\n          )}\r\n\r\n          {activeTab === 'profile' && (\r\n            <div className=\"card shadow-sm\" style={{ width: '100%' }}>\r\n              <div className=\"card-body\" style={{ padding: '22px' }}>\r\n                <h5 className=\"fw-bold mb-4\">{t('profile')}</h5>\r\n                {profileLoading ? (\r\n                  <div className=\"text-muted\">{t('loading')}</div>\r\n                ) : (\r\n                  <form onSubmit={async (e) => { e.preventDefault();\r\n                    setProfileSubmitting(true); setProfileMsg(null);\r\n                    try {\r\n                      const token = localStorage.getItem('token');\r\n                      const res = await fetch(`${API_BASE_URL}/auth/profile`, {\r\n                        method: 'PUT',\r\n                        headers: { 'Content-Type': 'application/json', Authorization: token ? `Bearer ${token}` : '' },\r\n                        credentials: 'include',\r\n                        // normalize address to an object (backend accepts either string or object)\r\n                        body: JSON.stringify({ firstName: profileFirstName, lastName: profileLastName, phone: profilePhone, address: profileAddress ? { city: profileAddress } : '' })\r\n                      });\r\n                      const data = await res.json();\r\n                      if (res.ok) {\r\n                        setProfileMsg(data.message || 'Profile updated');\r\n                        setProfileSuccess(true);\r\n                        setTimeout(() => setProfileSuccess(false), 3000);\r\n                        // Notify AuthContext / other components about updated profile\r\n                        try {\r\n                          const updatedUser = data.data || null;\r\n                          if (updatedUser && updatedUser.address) {\r\n                            setProfileAddress(formatAddress(updatedUser.address));\r\n                          }\r\n                          window.dispatchEvent(new CustomEvent('profileUpdated', { detail: updatedUser }));\r\n                        } catch (evErr) {\r\n                          // ignore\r\n                        }\r\n                      } else {\r\n                        setProfileMsg(data.message || 'Failed to update profile');\r\n                        setProfileSuccess(false);\r\n                      }\r\n                    } catch (err) {\r\n                      console.error('Update profile error', err);\r\n                      setProfileMsg('Failed to update profile');\r\n                      setProfileSuccess(false);\r\n                    } finally {\r\n                      setProfileSubmitting(false);\r\n                    }\r\n                  }}>\r\n                    <div className=\"row g-3\">\r\n                      <div className=\"col-12 col-sm-6\">\r\n                        <label className=\"form-label\">{t('firstName')}</label>\r\n                        <input className=\"form-control\" value={profileFirstName} onChange={(e) => setProfileFirstName(e.target.value)} />\r\n                      </div>\r\n                      <div className=\"col-12 col-sm-6\">\r\n                        <label className=\"form-label\">{t('lastName')}</label>\r\n                        <input className=\"form-control\" value={profileLastName} onChange={(e) => setProfileLastName(e.target.value)} />\r\n                      </div>\r\n                      <div className=\"col-12 col-sm-6\">\r\n                        <label className=\"form-label\">Phone</label>\r\n                        <input className=\"form-control\" value={profilePhone} onChange={(e) => setProfilePhone(e.target.value)} />\r\n                      </div>\r\n                      <div className=\"col-12\">\r\n                        <label className=\"form-label\">Address</label>\r\n                        <input className=\"form-control\" value={profileAddress} onChange={(e) => setProfileAddress(e.target.value)} />\r\n                      </div>\r\n                    </div>\r\n                    <div className=\"mt-3 d-flex gap-2\">\r\n                      <button className=\"btn btn-primary\" type=\"submit\" disabled={profileSubmitting}>{profileSubmitting ? t('loading') : t('saveChanges')}</button>\r\n                      <button className=\"btn btn-outline-secondary\" type=\"button\" onClick={() => {\r\n                        // reload profile\r\n                        setActiveTab('profile');\r\n                      }}>{t('cancel')}</button>\r\n                    </div>\r\n                    {profileMsg && <div className=\"mt-3\" style={{ color: profileSuccess ? 'var(--bs-success)' : 'var(--bs-danger)' }}>{profileMsg}</div>}\r\n                  </form>\r\n                )}\r\n              </div>\r\n            </div>\r\n          )}\r\n\r\n          {activeTab === 'appearance' && (\r\n            <div className=\"card shadow-sm\">\r\n              <div className=\"card-body\">\r\n                <h5 className=\"fw-bold mb-4\">{t('appearance')}</h5>\r\n                <div className=\"mb-4\">\r\n                  <label className=\"form-label fw-bold\">{t('theme')}</label>\r\n                  <select\r\n                    className=\"form-select\"\r\n                    value={theme}\r\n                    onChange={(e) => setTheme(e.target.value)}\r\n                  >\r\n                    <option value=\"Light\">Light</option>\r\n                    <option value=\"Dark\">Dark</option>\r\n                  </select>\r\n                  <small className=\"form-text text-muted\">Choose your preferred theme.</small>\r\n                </div>\r\n              </div>\r\n            </div>\r\n          )}\r\n\r\n          {activeTab === 'security' && (\r\n            <div className=\"card shadow-sm\">\r\n              <div className=\"card-body\">\r\n                <h5 className=\"fw-bold mb-4\">{t('security')}</h5>\r\n\r\n                <form onSubmit={(e) => e.preventDefault()}>\r\n                  <div className=\"mb-3\">\r\n                    <label className=\"form-label fw-bold\">{t('changePasswordTitle')}</label>\r\n\r\n                    <div>\r\n                      <input\r\n                        type=\"password\"\r\n                        className=\"form-control\"\r\n                        placeholder={t('enterCurrentPasswordPlaceholder')}\r\n                        value={oldPassword}\r\n                        onChange={(e) => { setOldPassword(e.target.value); setOldPasswordValid(false); setChangeMsg(''); setOldPasswordError(''); }}\r\n                        onBlur={async () => {\r\n                          // auto-verify on blur\r\n                          if (!oldPassword) return;\r\n                          setOldPasswordChecking(true);\r\n                          setOldPasswordError('');\r\n                          try {\r\n                            const token = localStorage.getItem('token');\r\n                            const res = await fetch(`${API_BASE_URL}/auth/verify-password`, {\r\n                              method: 'POST',\r\n                              headers: { 'Content-Type': 'application/json', Authorization: token ? `Bearer ${token}` : '' },\r\n                              credentials: 'include',\r\n                              body: JSON.stringify({ password: oldPassword })\r\n                            });\r\n                              if (res.ok) {\r\n                                setOldPasswordValid(true);\r\n                                setOldPasswordSuccess(t('passwordVerifiedSuccess'));\r\n                                // clear success after a short delay\r\n                                setTimeout(() => setOldPasswordSuccess(''), 3000);\r\n                              } else {\r\n                                setOldPasswordValid(false);\r\n                                setOldPasswordError(t('verifyPasswordFailed'));\r\n                              }\r\n                          } catch (err) {\r\n                            console.error('Verify password error', err);\r\n                            setOldPasswordValid(false);\r\n                            setOldPasswordError(t('passwordChangeError'));\r\n                          } finally {\r\n                            setOldPasswordChecking(false);\r\n                          }\r\n                        }}\r\n                      />\r\n                      <div className=\"d-flex justify-content-between align-items-center mt-2\">\r\n                        <small className=\"form-text text-muted\">{oldPasswordChecking ? t('verifyingPassword') : ''}</small>\r\n                        <button type=\"button\" className=\"btn btn-link p-0\" onClick={() => setShowForgotForm(s => !s)}>{t('forgotPasswordText')}</button>\r\n                      </div>\r\n                      {oldPasswordError && <div className=\"mt-2 text-danger\">{oldPasswordError}</div>}\r\n                      {oldPasswordSuccess && <div className=\"mt-2 text-success\">{oldPasswordSuccess}</div>}\r\n                    </div>\r\n\r\n                      <div className=\"mt-3\">\r\n                        <label className=\"form-label\">{t('enterNewPasswordLabel')}</label>\r\n                        <input\r\n                          type=\"password\"\r\n                          className=\"form-control\"\r\n                          value={newPassword}\r\n                          onChange={(e) => setNewPassword(e.target.value)}\r\n                          disabled={!oldPasswordValid}\r\n                        />\r\n                      </div>\r\n\r\n                      <div className=\"mt-3\">\r\n                        <label className=\"form-label\">{t('confirmNewPasswordLabel')}</label>\r\n                        <input\r\n                          type=\"password\"\r\n                          className=\"form-control\"\r\n                          value={confirmNewPassword}\r\n                          onChange={(e) => setConfirmNewPassword(e.target.value)}\r\n                          disabled={!oldPasswordValid}\r\n                        />\r\n                      </div>\r\n\r\n                      <div className=\"mt-3\">\r\n                        <button\r\n                          className=\"btn btn-primary\"\r\n                          type=\"button\"\r\n                          disabled={submittingPassword || !oldPasswordValid}\r\n                          onClick={async () => {\r\n                            setChangeMsg('');\r\n                            if (newPassword !== confirmNewPassword) {\r\n                              setChangeMsg(t('passwordMismatch'));\r\n                              return;\r\n                            }\r\n                            if (!oldPasswordValid) {\r\n                              setChangeMsg(t('verifyPasswordFailed'));\r\n                              return;\r\n                            }\r\n                            setSubmittingPassword(true);\r\n                            try {\r\n                              const token = localStorage.getItem('token');\r\n                                const res = await fetch(`${API_BASE_URL}/auth/change-password`, {\r\n                                  method: 'PUT',\r\n                                  headers: { 'Content-Type': 'application/json', Authorization: token ? `Bearer ${token}` : '' },\r\n                                  credentials: 'include',\r\n                                  body: JSON.stringify({ currentPassword: oldPassword, newPassword, confirmPassword: confirmNewPassword })\r\n                                });\r\n                              const data = await res.json();\r\n                              if (res.ok) {\r\n                                setChangeMsg(t('passwordChangedSuccess'));\r\n                                setChangeSuccess(true);\r\n                                setOldPassword('');\r\n                                setNewPassword('');\r\n                                setConfirmNewPassword('');\r\n                                setOldPasswordValid(false);\r\n                                // clear success after a short delay\r\n                                setTimeout(() => setChangeSuccess(false), 4000);\r\n                              } else {\r\n                                setChangeMsg(data.message || t('passwordChangeError'));\r\n                                setChangeSuccess(false);\r\n                              }\r\n                            } catch (err) {\r\n                              console.error('Change password error', err);\r\n                              setChangeMsg(t('passwordChangeError'));\r\n                            } finally {\r\n                              setSubmittingPassword(false);\r\n                            }\r\n                          }}\r\n                        >\r\n                          {submittingPassword ? t('verifyingPassword') : t('changePasswordButton')}\r\n                        </button>\r\n                      </div>\r\n\r\n                    {changeMsg && (\r\n                      <div className=\"mt-3\" style={{ color: changeSuccess ? 'var(--bs-success)' : 'var(--bs-danger)' }}>\r\n                        {changeMsg}\r\n                      </div>\r\n                    )}\r\n                  </div>\r\n\r\n                  {/* Forgot password modal (renders as overlay) */}\r\n                  {showForgotForm && (\r\n                    <div className=\"custom-modal-overlay\" role=\"dialog\" aria-modal=\"true\" style={{ zIndex: 1080 }}>\r\n                      <div className=\"custom-modal-backdrop\" onClick={() => setShowForgotForm(false)} style={{ position: 'fixed', inset: 0, background: 'rgba(0,0,0,0.45)' }} />\r\n                      <div className=\"custom-modal-content\" style={{ position: 'fixed', top: '50%', left: '50%', transform: 'translate(-50%, -50%)', maxWidth: 640, width: '95%', background: '#fff', borderRadius: 8, boxShadow: '0 8px 24px rgba(0,0,0,0.2)', padding: 20 }}>\r\n                        <div className=\"d-flex justify-content-between align-items-center mb-3\">\r\n                          <h5 className=\"mb-0\">{t('forgotPasswordText')}</h5>\r\n                          <button className=\"btn btn-sm btn-light\" onClick={() => setShowForgotForm(false)}></button>\r\n                        </div>\r\n                        <div className=\"mb-2\"><small className=\"text-muted\">{t('forgotPasswordInstructions')}</small></div>\r\n                        <div className=\"d-flex gap-2 align-items-start mb-3\">\r\n                          <input type=\"email\" className=\"form-control\" placeholder=\"you@company.com\" value={forgotEmail} onChange={(e) => { setForgotEmail(e.target.value); setForgotStatus(null); }} style={{ maxWidth: 360 }} />\r\n                          <button className=\"btn btn-secondary\" onClick={async () => {\r\n                            setForgotStatus(null);\r\n                            setOtpError('');\r\n                            setOtpSent(false);\r\n                            setResetStatus(null);\r\n                            try {\r\n                              if (!forgotEmail) {\r\n                                setForgotStatus('Please enter an email');\r\n                                return;\r\n                              }\r\n                              const res = await fetch(`${API_BASE_URL}/auth/request-otp`, {\r\n                                method: 'POST',\r\n                                headers: { 'Content-Type': 'application/json' },\r\n                                body: JSON.stringify({ email: forgotEmail })\r\n                              });\r\n                              const data = await res.json();\r\n                              if (res.ok) {\r\n                                setOtpSent(true);\r\n                                setForgotStatus(data.message || t('resetEmailSentMsg'));\r\n                                if (data.otp) setForgotStatus((prev) => prev + ` OTP: ${data.otp}`);\r\n                              } else {\r\n                                setForgotStatus(data.message || t('resetEmailSentMsg'));\r\n                              }\r\n                            } catch (err) {\r\n                              console.error('Request OTP error', err);\r\n                              setForgotStatus(t('passwordChangeError'));\r\n                            }\r\n                          }}>Send</button>\r\n                        </div>\r\n                        {forgotStatus && <div className=\"mb-2 text-muted\">{forgotStatus}</div>}\r\n\r\n                        {otpSent && (\r\n                          <div className=\"mb-3 p-3 bg-light border rounded\">\r\n                            <label className=\"form-label fw-bold\">Enter OTP</label>\r\n                            <div className=\"d-flex gap-2\">\r\n                              <input type=\"text\" className=\"form-control\" placeholder=\"6-digit OTP\" value={otpValue} onChange={(e) => { setOtpValue(e.target.value); setOtpError(''); }} style={{ maxWidth: 220 }} />\r\n                              <button className=\"btn btn-primary\" onClick={async () => {\r\n                                setOtpError('');\r\n                                setVerifyingOtp(true);\r\n                                try {\r\n                                  const res = await fetch(`${API_BASE_URL}/auth/verify-otp`, {\r\n                                    method: 'POST',\r\n                                    headers: { 'Content-Type': 'application/json' },\r\n                                    body: JSON.stringify({ email: forgotEmail, otp: otpValue })\r\n                                  });\r\n                                  const data = await res.json();\r\n                                  if (res.ok) {\r\n                                    if (data.resetToken) {\r\n                                      setResetToken(data.resetToken);\r\n                                      setShowResetForm(true);\r\n                                      setResetStatus('OTP verified. You can now set a new password.');\r\n                                    } else {\r\n                                      setResetStatus(data.message || 'OTP verified. Check your email for reset link.');\r\n                                    }\r\n                                  } else {\r\n                                    setOtpError(data.message || 'Invalid OTP');\r\n                                  }\r\n                                } catch (err) {\r\n                                  console.error('Verify OTP error', err);\r\n                                  setOtpError('Failed to verify OTP');\r\n                                } finally {\r\n                                  setVerifyingOtp(false);\r\n                                }\r\n                              }}>{verifyingOtp ? t('verifyingPassword') : 'Verify OTP'}</button>\r\n                            </div>\r\n                            {otpError && <div className=\"mt-2 text-danger\">{otpError}</div>}\r\n                            {resetStatus && <div className=\"mt-2 text-success\">{resetStatus}</div>}\r\n                          </div>\r\n                        )}\r\n\r\n                        {showResetForm && (\r\n                          <div className=\"mb-0 p-3 bg-white border rounded\">\r\n                            <label className=\"form-label fw-bold\">Reset Password</label>\r\n                            <div className=\"mb-2\">\r\n                              <input type=\"password\" className=\"form-control\" placeholder={t('enterNewPasswordLabel')} value={resetNewPassword} onChange={(e) => setResetNewPassword(e.target.value)} />\r\n                            </div>\r\n                            <div className=\"mb-2\">\r\n                              <input type=\"password\" className=\"form-control\" placeholder={t('confirmNewPasswordLabel')} value={resetConfirmPassword} onChange={(e) => setResetConfirmPassword(e.target.value)} />\r\n                            </div>\r\n                            <div className=\"d-flex gap-2\">\r\n                              <button className=\"btn btn-success\" onClick={async () => {\r\n                                setResetStatus(null);\r\n                                if (!resetNewPassword || !resetConfirmPassword) {\r\n                                  setResetStatus('Please fill both password fields');\r\n                                  return;\r\n                                }\r\n                                if (resetNewPassword !== resetConfirmPassword) {\r\n                                  setResetStatus(t('passwordMismatch'));\r\n                                  return;\r\n                                }\r\n                                setResettingPassword(true);\r\n                                try {\r\n                                  const tokenToUse = resetToken;\r\n                                  const res = await fetch(`${API_BASE_URL}/auth/reset-password/${tokenToUse}`, {\r\n                                    method: 'PUT',\r\n                                    headers: { 'Content-Type': 'application/json' },\r\n                                    body: JSON.stringify({ password: resetNewPassword })\r\n                                  });\r\n                                  const data = await res.json();\r\n                                  if (res.ok) {\r\n                                    setResetStatus(t('passwordChangedSuccess'));\r\n                                    setShowForgotForm(false);\r\n                                    // cleanup\r\n                                    setShowResetForm(false);\r\n                                    setOtpSent(false);\r\n                                    setForgotEmail('');\r\n                                    setOtpValue('');\r\n                                    setResetNewPassword('');\r\n                                    setResetConfirmPassword('');\r\n                                  } else {\r\n                                    setResetStatus(data.message || t('passwordChangeError'));\r\n                                  }\r\n                                } catch (err) {\r\n                                  console.error('Reset password error', err);\r\n                                  setResetStatus(t('passwordChangeError'));\r\n                                } finally {\r\n                                  setResettingPassword(false);\r\n                                }\r\n                              }} disabled={resettingPassword}>{resettingPassword ? t('verifyingPassword') : 'Reset Password'}</button>\r\n                              <button className=\"btn btn-outline-secondary\" onClick={() => { setShowResetForm(false); setResetToken(''); }}>{t('cancel')}</button>\r\n                            </div>\r\n                            {resetStatus && <div className=\"mt-2\" style={{ color: resetStatus === t('passwordChangedSuccess') ? 'var(--bs-success)' : 'var(--bs-danger)' }}>{resetStatus}</div>}\r\n                          </div>\r\n                        )}\r\n                      </div>\r\n                    </div>\r\n                  )}\r\n                </form>\r\n              </div>\r\n            </div>\r\n          )}\r\n\r\n          \r\n\r\n          \r\n        </div>\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default Settings;"],"names":["_ref","title","subtitle","icon","actions","onBack","_jsxs","_Fragment","children","className","onClick","style","marginBottom","background","color","border","width","padding","_jsx","fontWeight","src","logo","alt","TOOLTIP","formatAddress","addr","city","street","address","line1","Object","values","find","v","JSON","stringify","String","settings","setSettings","useState","systemName","timezone","workingHours","start","end","emailNotifications","autoLogout","activeTab","setActiveTab","lang","setLang","t","useLanguage","user","hasPermission","useContext","AuthContext","hasSettingPerm","permId","_user$permissions","role","includes","s","permissions","useEffect","tabsOrder","mapping","profile","general","appearance","security","firstAllowed","theme","setTheme","localStorage","getItem","e","password","setPassword","notificationSound","setNotificationSound","exportType","setExportType","notificationEmails","setNotificationEmails","raw","parse","newMail","setNewMail","mailError","setMailError","profileLoading","setProfileLoading","profileSubmitting","setProfileSubmitting","profileMsg","setProfileMsg","profileSuccess","setProfileSuccess","profileFirstName","setProfileFirstName","profileLastName","setProfileLastName","profilePhone","setProfilePhone","profileAddress","setProfileAddress","API_BASE_URL","process","oldPassword","setOldPassword","oldPasswordValid","setOldPasswordValid","oldPasswordChecking","setOldPasswordChecking","oldPasswordError","setOldPasswordError","oldPasswordSuccess","setOldPasswordSuccess","newPassword","setNewPassword","confirmNewPassword","setConfirmNewPassword","changeMsg","setChangeMsg","submittingPassword","setSubmittingPassword","changeSuccess","setChangeSuccess","showForgotForm","setShowForgotForm","forgotEmail","setForgotEmail","forgotStatus","setForgotStatus","otpSent","setOtpSent","otpValue","setOtpValue","otpError","setOtpError","verifyingOtp","setVerifyingOtp","resetToken","setResetToken","showResetForm","setShowResetForm","resetNewPassword","setResetNewPassword","resetConfirmPassword","setResetConfirmPassword","resettingPassword","setResettingPassword","resetStatus","setResetStatus","mode","document","documentElement","setAttribute","setItem","body","overflow","async","token","res","fetch","method","headers","Authorization","credentials","ok","json","data","firstName","lastName","phone","err","console","error","loadProfile","margin","boxSizing","PageHeader","marginTop","maxWidth","type","value","onChange","target","window","confirm","alert","message","onSubmit","preventDefault","setTimeout","updatedUser","dispatchEvent","CustomEvent","detail","evErr","disabled","placeholder","onBlur","currentPassword","confirmPassword","zIndex","position","inset","top","left","transform","borderRadius","boxShadow","email","otp","prev","tokenToUse"],"sourceRoot":""}