"use strict";(self.webpackChunktime_attendance_frontend=self.webpackChunktime_attendance_frontend||[]).push([[825],{83:(e,i,n)=>{n.d(i,{A:()=>t});n(43);var l=n(769),s=n(579);const t=e=>{let{title:i,subtitle:n,icon:t="bi-folder",actions:a,onBack:d}=e;return(0,s.jsxs)(s.Fragment,{children:[d&&(0,s.jsxs)("button",{className:"back-arrow-btn",onClick:d,title:"Back to Dashboard",style:{marginBottom:"12px",background:"transparent",color:"#0f172a",border:"1px solid rgba(15,23,42,0.08)",width:"auto",padding:"8px 12px"},children:[(0,s.jsx)("i",{className:"bi bi-arrow-left"}),"\xa0",(0,s.jsx)("span",{style:{fontWeight:600},children:"Back"})]}),(0,s.jsxs)("div",{className:"page-header-banner",children:[(0,s.jsxs)("div",{className:"page-header-content",children:[(0,s.jsxs)("div",{className:"page-header-left",children:[(0,s.jsx)("div",{className:"page-header-icon",children:(0,s.jsx)("i",{className:`bi ${t}`})}),(0,s.jsxs)("div",{className:"page-header-text",children:[(0,s.jsx)("h1",{children:i}),n&&(0,s.jsx)("p",{children:n})]})]}),(0,s.jsxs)("div",{className:"page-header-right",children:[a&&(0,s.jsx)("div",{className:"page-header-actions",children:a}),(0,s.jsx)("div",{className:"page-header-logo",children:(0,s.jsx)("img",{src:l,alt:"Company Logo"})})]})]}),(0,s.jsxs)("div",{className:"page-header-decoration",children:[(0,s.jsx)("div",{className:"decoration-circle decoration-circle-1"}),(0,s.jsx)("div",{className:"decoration-circle decoration-circle-2"}),(0,s.jsx)("div",{className:"decoration-circle decoration-circle-3"})]})]})]})}},825:(e,i,n)=>{n.r(i),n.d(i,{default:()=>d});var l=n(43),s=n(213),t=n(83),a=n(579);const d=e=>{let{onBack:i}=e;const[n,d]=(0,l.useState)([]),[o,r]=(0,l.useState)([]),[c,v]=(0,l.useState)([]),[u,m]=(0,l.useState)(!1),[h,x]=(0,l.useState)("divisions"),[g,N]=(0,l.useState)(null),[j,f]=(0,l.useState)([]),[p,b]=(0,l.useState)("all"),[S,I]=(0,l.useState)([]),[_,y]=(0,l.useState)("all"),[E,D]=(0,l.useState)("all"),[C,w]=(0,l.useState)([]),[A,O]=(0,l.useState)(!1),[k,$]=(0,l.useState)(!1),[M,T]=(0,l.useState)(!1),[H,F]=(0,l.useState)(()=>{const e=new Date;return e.setDate(e.getDate()-7),re(e)}),[V,L]=(0,l.useState)(()=>re(new Date)),[R,P]=(0,l.useState)("last7"),[B,U]=(0,l.useState)(!1),[J,G]=(0,l.useState)(null),[W,z]=(0,l.useState)([]),[Y,q]=(0,l.useState)(null),[K,Q]=(0,l.useState)(null),[X,Z]=(0,l.useState)("all"),[ee,ie]=(0,l.useState)("all"),[ne,le]=(0,l.useState)([]),[se,te]=(0,l.useState)([]),[ae,de]=(0,l.useState)([]),oe="http://10.70.4.186:5000/api";function re(e){const i=e=>String(e).padStart(2,"0");return`${e.getFullYear()}-${i(e.getMonth()+1)}-${i(e.getDate())}`}const ce=e=>{if(!e)return"";try{if("string"===typeof e){const i=Number(e);if(!Number.isNaN(i)&&""!==e.trim()){const e=new Date(i);return Number.isNaN(e)?"":re(e)}const n=new Date(e);return Number.isNaN(n)?"":re(n)}if("number"===typeof e){const i=new Date(e);return Number.isNaN(i)?"":re(i)}if("object"===typeof e){if(e.$date){const i=e.$date;if("object"===typeof i&&i.$numberLong){const e=new Date(Number(i.$numberLong));return Number.isNaN(e)?"":re(e)}if("string"===typeof i||"number"===typeof i){const e=new Date(i);return Number.isNaN(e)?"":re(e)}}if(e.$numberLong){const i=new Date(Number(e.$numberLong));return Number.isNaN(i)?"":re(i)}}}catch(i){return""}return""},ve=e=>"string"===typeof e&&e.toLowerCase().includes("colombo"),ue=e=>{var i;return!!e&&(ve(e.DIVISION_NAME)||ve(e.HIE_NAME_3)||ve(null===e||void 0===e||null===(i=e.currentwork)||void 0===i?void 0:i.HIE_NAME_3)||ve(null===e||void 0===e?void 0:e.division_name)||ve(null===e||void 0===e?void 0:e.divisionName))},me=e=>ve(e.divisionHierarchyName)||ve(e.divisionName),he=e=>e&&"string"===typeof e?e.replace(/\s+/g," ").trim().toLowerCase():"",xe=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];const i=[],n=new Set;return e.forEach(e=>{var l,s,t,a,d,o,r,c,v,u,m,h,x,g,N,j,f,p;const b=String(null!==(l=null!==(s=null!==(t=null!==(a=null!==(d=null!==(o=e._id)&&void 0!==o?o:e.id)&&void 0!==d?d:e.DIVISION_ID)&&void 0!==a?a:e.code)&&void 0!==t?t:e.hie_code)&&void 0!==s?s:e.DIVISION_CODE)&&void 0!==l?l:"");b&&(n.has(b)||(n.add(b),i.push({id:b,code:String(null!==(r=null!==(c=null!==(v=null!==(u=null!==(m=e.code)&&void 0!==m?m:e.DIVISION_CODE)&&void 0!==u?u:e.hie_code)&&void 0!==v?v:e._id)&&void 0!==c?c:e.id)&&void 0!==r?r:b),name:null!==(h=null!==(x=null!==(g=null!==(N=e.name)&&void 0!==N?N:e.DIVISION_NAME)&&void 0!==g?g:e.hie_name)&&void 0!==x?x:e.hie_relationship)&&void 0!==h?h:"Unknown Division",def_level:null!==(j=e.def_level)&&void 0!==j?j:e.DEF_LEVEL,hie_relationship:e.hie_relationship,isActive:null===(f=null!==(p=e.isActive)&&void 0!==p?p:e.active)||void 0===f||f})))}),i.sort((e,i)=>e.name.localeCompare(i.name))},ge=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];const i=[],n=new Set;return e.forEach(e=>{var l,s,t,a,d,o,r,c,v,u,m,h,x,g,N,j,f,p,b,S,I,_,y,E,D,C,w;const A=String(null!==(l=null!==(s=null!==(t=null!==(a=null!==(d=null!==(o=null!==(r=e._id)&&void 0!==r?r:e.id)&&void 0!==o?o:e.SECTION_ID)&&void 0!==d?d:e.code)&&void 0!==a?a:e.hie_code)&&void 0!==t?t:e.SECTION_CODE)&&void 0!==s?s:e.section_code)&&void 0!==l?l:"");if(!A)return;if(n.has(A))return;n.add(A);const O=String(null!==(c=null!==(v=null!==(u=null!==(m=null!==(h=e.division_id)&&void 0!==h?h:e.DIVISION_ID)&&void 0!==m?m:e.division_code)&&void 0!==u?u:e.DIVISION_CODE)&&void 0!==v?v:e.hie_relationship)&&void 0!==c?c:"");i.push({id:A,code:String(null!==(x=null!==(g=null!==(N=null!==(j=e.code)&&void 0!==j?j:e.SECTION_CODE)&&void 0!==N?N:e.hie_code)&&void 0!==g?g:e.section_code)&&void 0!==x?x:A),name:null!==(f=null!==(p=null!==(b=null!==(S=e.name)&&void 0!==S?S:e.section_name)&&void 0!==b?b:e.SECTION_NAME)&&void 0!==p?p:e.hie_relationship)&&void 0!==f?f:`Section ${A}`,divisionId:O||"",divisionCode:String(null!==(I=null!==(_=e.division_code)&&void 0!==_?_:e.DIVISION_CODE)&&void 0!==I?I:""),divisionName:null!==(y=null!==(E=e.division_name)&&void 0!==E?E:e.DIVISION_NAME)&&void 0!==y?y:"",def_level:null!==(D=e.def_level)&&void 0!==D?D:e.DEF_LEVEL,isActive:null===(C=null!==(w=e.isActive)&&void 0!==w?w:e.active)||void 0===C||C})}),i.sort((e,i)=>e.name.localeCompare(i.name))},Ne=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];const i=[],n=new Set;return e.forEach(e=>{var l,s,t,a,d,o,r,c,v,u,m,h,x,g,N,j,f,p,b,S,I,_,y,E,D,C,w,A,O,k,$,M,T,H,F,V,L,R,P,B,U,J,G,W,z,Y,q,K,Q;const X=String(null!==(l=null!==(s=null!==(t=e.EMP_NUMBER)&&void 0!==t?t:e.empNumber)&&void 0!==s?s:e.id)&&void 0!==l?l:"");if(!X)return;if(n.has(X))return;n.add(X);const Z=null!==(a=null!==(d=null!==(o=e.HIE_NAME_3)&&void 0!==o?o:e.hie_name_3)&&void 0!==d?d:null===e||void 0===e||null===(r=e.currentwork)||void 0===r?void 0:r.HIE_NAME_3)&&void 0!==a?a:null===e||void 0===e||null===(c=e.currentwork)||void 0===c?void 0:c.hie_name_3,ee=null!==(v=null!==(u=null!==(m=e.HIE_NAME_4)&&void 0!==m?m:e.hie_name_4)&&void 0!==u?u:null===e||void 0===e||null===(h=e.currentwork)||void 0===h?void 0:h.HIE_NAME_4)&&void 0!==v?v:null===e||void 0===e||null===(x=e.currentwork)||void 0===x?void 0:x.hie_name_4;i.push({empNumber:X,fullName:null!==(g=null!==(N=null!==(j=e.FULLNAME)&&void 0!==j?j:e.fullName)&&void 0!==N?N:e.name)&&void 0!==g?g:"Unknown",callingName:null!==(f=null!==(p=null!==(b=e.CALLING_NAME)&&void 0!==b?b:e.calling_name)&&void 0!==p?p:e.preferredName)&&void 0!==f?f:"",designation:null!==(S=null!==(I=e.DESIGNATION)&&void 0!==I?I:e.designation)&&void 0!==S?S:"",nic:String(null!==(_=null!==(y=e.NIC)&&void 0!==y?y:e.nic)&&void 0!==_?_:""),divisionId:String(null!==(E=null!==(D=null!==(C=null!==(w=e.DIVISION_ID)&&void 0!==w?w:e.division_id)&&void 0!==C?C:e.DIVISION_CODE)&&void 0!==D?D:e.division_code)&&void 0!==E?E:""),divisionCode:String(null!==(A=null!==(O=e.DIVISION_CODE)&&void 0!==O?O:e.division_code)&&void 0!==A?A:""),divisionName:null!==(k=null!==($=null!==(M=e.DIVISION_NAME)&&void 0!==M?M:e.division_name)&&void 0!==$?$:Z)&&void 0!==k?k:"",sectionId:String(null!==(T=null!==(H=null!==(F=null!==(V=e.SECTION_ID)&&void 0!==V?V:e.section_id)&&void 0!==F?F:e.SECTION_CODE)&&void 0!==H?H:e.section_code)&&void 0!==T?T:""),sectionCode:String(null!==(L=null!==(R=e.SECTION_CODE)&&void 0!==R?R:e.section_code)&&void 0!==L?L:""),sectionName:null!==(P=null!==(B=null!==(U=e.SECTION_NAME)&&void 0!==U?U:e.section_name)&&void 0!==B?B:ee)&&void 0!==P?P:"",gender:null!==(J=null!==(G=e.GENDER)&&void 0!==G?G:e.gender)&&void 0!==J?J:"",status:null!==(W=null!==(z=e.STATUS)&&void 0!==z?z:e.status)&&void 0!==W?W:"ACTIVE",dateOfBirth:ce(null!==(Y=null!==(q=e.DATE_OF_BIRTH)&&void 0!==q?q:e.date_of_birth)&&void 0!==Y?Y:e.dob),dateOfJoining:ce(null!==(K=null!==(Q=e.DATE_OF_JOINING)&&void 0!==Q?Q:e.date_of_joining)&&void 0!==K?K:e.doj),divisionHierarchyName:null!==Z&&void 0!==Z?Z:"",sectionHierarchyName:null!==ee&&void 0!==ee?ee:""})}),i},je=()=>{const e=new Map,i=new Map,l=new Map;return n.forEach(n=>{n.code&&e.set(String(n.code),String(n.id)),n.name&&i.set(String(n.name),String(n.id)),l.set(String(n.id),n.name)}),{codeToId:e,nameToId:i,idToName:l}},fe=e=>e.divisionHierarchyName||e.divisionName||String(e.divisionId||e.divisionCode||"Unknown Division"),pe=(e,i)=>{var n,l,s;const t=String(e.divisionId||"");if(t&&null!==i&&void 0!==i&&null!==(n=i.idToName)&&void 0!==n&&n.has(t))return`id:${t}`;const a=String(e.divisionCode||"");if(a&&null!==i&&void 0!==i&&null!==(l=i.codeToId)&&void 0!==l&&l.has(a))return`id:${i.codeToId.get(a)}`;const d=fe(e);return d&&null!==i&&void 0!==i&&null!==(s=i.nameToId)&&void 0!==s&&s.has(d)?`id:${i.nameToId.get(d)}`:`name:${d}`},be=function(e){let i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:j;if(!i.length)return void r([]);if("all"===e)return void r(i);const n=i.filter(i=>String(i.divisionId)===String(e));r(n)},Se=async()=>{try{m(!0),N(null);const e=await s.A.get(`${oe}/divisions/hris`);if(e.data.success){const i=e.data.data||[];le(i);const n=xe(i);d(n),e.data.fallback&&N(`\u26a0\ufe0f ${e.data.message}`)}else N("Failed to fetch divisions from HRIS API")}catch(g){var e;console.error("Error fetching divisions:",g),N(`Failed to fetch divisions: ${(null===(e=g.response)||void 0===e?void 0:e.status)||500}`)}finally{m(!1)}},Ie=async()=>{try{m(!0),N(null);const e=await s.A.get(`${oe}/sections/hris`);if(e.data.success){const i=e.data.data||[];te(i);const n=ge(i);f(n),be(p,n),e.data.fallback&&N(`\u26a0\ufe0f ${e.data.message}`)}else N("Failed to fetch sections from HRIS API")}catch(g){var e;console.error("Error fetching sections:",g),N(`Failed to fetch sections: ${(null===(e=g.response)||void 0===e?void 0:e.status)||500}`)}finally{m(!1)}},_e=async()=>{try{m(!0),N(null);const e=[s.A.get(`${oe}/users/hris`),s.A.get(`${oe}/sections/hris`),s.A.get(`${oe}/divisions/hris`)],[i,n,l]=await Promise.all(e);if(l.data.success){const e=l.data.data||[];le(e);const i=xe(e);d(i),l.data.fallback&&N(`\u26a0\ufe0f ${l.data.message}`)}else N("Failed to fetch divisions from HRIS API");if(n.data.success){const e=n.data.data||[];te(e);const i=ge(e);f(i),be(p,i),n.data.fallback&&N(e=>null!==e&&void 0!==e?e:`\u26a0\ufe0f ${n.data.message}`)}else N("Failed to fetch sections from HRIS API");if(i.data.success){const e=(i.data.data||[]).filter(ue);de(e);const n=Ne(e);I(n),v(n),i.data.fallback&&N(e=>null!==e&&void 0!==e?e:`\u26a0\ufe0f ${i.data.message}`)}else N("Failed to fetch employees from HRIS API")}catch(g){var e;console.error("Error fetching data:",g),N(`Failed to fetch data: ${(null===(e=g.response)||void 0===e?void 0:e.status)||500}`)}finally{m(!1)}};(0,l.useEffect)(()=>{"divisions"===h?Se():"sections"===h?Ie():"employees"!==h&&"individual-attendance"!==h||_e()},[h]);const ye=e=>{const i=e.target.value;b(i),be(i)},Ee=()=>n,De=()=>{const e=je();if(n&&n.length){const i=new Map;S.forEach(n=>{const l=pe(n,e);i.set(l,(i.get(l)||0)+1)});const l=n.map(e=>{const n=`id:${String(e.id)}`;return{key:n,name:e.name,count:i.get(n)||0}}),s=[],t=new Set(l.map(e=>e.key));return S.forEach(i=>{const n=pe(i,e);if(t.has(n)){const e=s.find(e=>e.key===n);e&&(e.count+=1)}else t.add(n),s.push({key:n,name:fe(i),count:1})}),[...l,...s].sort((e,i)=>e.name.localeCompare(i.name))}const i=new Map;return S.forEach(n=>{const l=pe(n,e),s=fe(n),t=i.get(l);t?t.count+=1:i.set(l,{key:l,name:s,count:1})}),Array.from(i.values()).sort((e,i)=>e.name.localeCompare(i.name))},Ce=e=>{if("all"===e)return[];const i=je();if(e.startsWith("id:")){const i=e.slice(3),n=j.filter(e=>String(e.divisionId)===String(i)).map(e=>({id:e.id,code:e.code,name:e.name}));if(n.length){const e=new Set,i=[];return n.forEach(n=>{e.has(n.id)||(e.add(n.id),i.push(n))}),i.sort((e,i)=>e.name.localeCompare(i.name))}}const n=[],l=new Set;return S.filter(n=>pe(n,i)===String(e)).forEach(e=>{const i=e.sectionId||e.sectionCode,s=e.sectionHierarchyName||e.sectionName||String(i),t=String(i||"");t&&!l.has(t)&&(l.add(t),n.push({id:t,code:t,name:s}))}),n.sort((e,i)=>e.name.localeCompare(i.name))};(0,l.useEffect)(()=>{const e=new Date;let i=new Date,n=new Date;switch(R){case"last7":i=new Date,i.setDate(e.getDate()-7),n=e;break;case"last30":i=new Date,i.setDate(e.getDate()-30),n=e;break;case"thisMonth":i=new Date(e.getFullYear(),e.getMonth(),1),n=e;break;default:return}F(re(i)),L(re(n))},[R]);const we=e=>{const i=e.target.value;y(i),D("all")},Ae=e=>{const i=e.target.value;D(i)};(0,l.useEffect)(()=>{if("all"===_)return void w([]);const e=Ce(_);w(e)},[_,j,S]);const Oe=(0,l.useRef)(!1),ke=(0,l.useRef)(!1);(0,l.useEffect)(()=>{if("all"!==_)return;if(!n||!n.length)return;if(Oe.current)return;const e=n.find(e=>{const i=String(e.code||"").toLowerCase(),n=String(e.name||"").toLowerCase();return"is"===i||n.includes("information systems")||n.includes("information system")});e&&(y(`id:${String(e.id)}`),Oe.current=!0,ke.current=!1)},[n,_]),(0,l.useEffect)(()=>{if("all"!==E)return;if(!C||!C.length)return;if(ke.current)return;const e=C.find(e=>{const i=String(e.code||"").toLowerCase(),n=String(e.name||"").toLowerCase();return"is"===i||n.includes("(is)")||n.includes("information systems")||n.includes("information system")});e&&(D(String(e.id)),ke.current=!0)},[C,E]),(0,l.useEffect)(()=>{let e=S;if("all"!==_){const i=je();e=e.filter(e=>pe(e,i)===String(_))}if("all"!==E){const i=C.find(e=>String(e.id)===String(E)),n=he((null===i||void 0===i?void 0:i.name)||"");e=e.filter(e=>{if(String(e.sectionId||e.sectionCode)===String(E))return!0;const i=he((l=e).sectionHierarchyName||l.sectionName||String(l.sectionId||l.sectionCode||""));var l;return n&&i===n})}e=e.filter(me),v(e)},[S,_,E]);const $e=async e=>{try{U(!0),G(null),z([]),q(null),Q(e);const n={report_type:"individual",employee_id:e,from_date:H,to_date:V},l=await s.A.post(`${oe}/reports/mysql/attendance`,n);var i;if(l.data&&l.data.success)z(l.data.data||[]),q(l.data.summary||null);else G((null===(i=l.data)||void 0===i?void 0:i.message)||"Failed to fetch attendance")}catch(g){var n,l;console.error("Error fetching attendance:",g),G((null===(n=g.response)||void 0===n||null===(l=n.data)||void 0===l?void 0:l.message)||g.message||"Error fetching attendance")}finally{U(!1)}};return(0,a.jsxs)("div",{className:"api-data-viewer",children:[(0,a.jsx)(t.A,{title:"HRIS API Data Viewer",subtitle:"View and explore synchronized HRIS data",icon:"bi-cloud-download",onBack:i,actions:(0,a.jsxs)("button",{className:"btn btn-outline-primary refresh-btn",onClick:()=>{"divisions"===h?Se():"sections"===h?(Ie(),b("all")):"employees"===h?(_e(),y("all"),D("all"),w([])):"individual-attendance"===h&&(_e(),Z("all"),ie("all"),Q(null),P("last7")),O(!1),$(!1),T(!1)},disabled:u,children:[(0,a.jsx)("i",{className:"bi bi-arrow-clockwise"}),"Refresh"]})}),(0,a.jsxs)("div",{className:"api-tabs",children:[(0,a.jsxs)("button",{className:"tab-btn "+("divisions"===h?"active":""),onClick:()=>x("divisions"),children:[(0,a.jsx)("i",{className:"bi bi-building"}),"Divisions"]}),(0,a.jsxs)("button",{className:"tab-btn "+("sections"===h?"active":""),onClick:()=>x("sections"),children:[(0,a.jsx)("i",{className:"bi bi-diagram-3"}),"Sections"]}),(0,a.jsxs)("button",{className:"tab-btn "+("employees"===h?"active":""),onClick:()=>x("employees"),children:[(0,a.jsx)("i",{className:"bi bi-people"}),"Employees"]}),(0,a.jsxs)("button",{className:"tab-btn "+("individual-attendance"===h?"active":""),onClick:()=>{x("individual-attendance"),_e()},children:[(0,a.jsx)("i",{className:"bi bi-person-lines-fill"}),"Individual Attendance"]})]}),(0,a.jsxs)("div",{className:"api-content",children:[g&&(0,a.jsxs)("div",{className:"alert "+(g.includes("\u26a0\ufe0f")?"alert-warning":"alert-danger"),children:[(0,a.jsx)("i",{className:"bi "+(g.includes("\u26a0\ufe0f")?"bi-exclamation-triangle":"bi-exclamation-circle")}),g]}),u?(0,a.jsxs)("div",{className:"loading-container",children:[(0,a.jsx)("div",{className:"spinner-border text-primary",role:"status",children:(0,a.jsx)("span",{className:"visually-hidden",children:"Loading..."})}),(0,a.jsx)("p",{children:"Fetching data from HRIS API..."})]}):(0,a.jsxs)(a.Fragment,{children:["divisions"===h&&(0,a.jsxs)("div",{className:"api-table-container",children:[(0,a.jsx)("h3",{children:"HRIS Divisions (Level 3)"}),(0,a.jsx)("div",{className:"mb-3",children:(0,a.jsxs)("button",{className:"btn btn-sm btn-outline-secondary",onClick:()=>$(!k),children:[k?"Hide":"Show"," Division JSON"]})}),k&&(0,a.jsx)("div",{className:"json-viewer",children:(0,a.jsx)("pre",{children:JSON.stringify(n,null,2)})}),(0,a.jsx)("div",{className:"table-responsive",children:(0,a.jsxs)("table",{className:"table table-striped",children:[(0,a.jsx)("thead",{children:(0,a.jsxs)("tr",{children:[(0,a.jsx)("th",{children:"_ID"}),(0,a.jsx)("th",{children:"NAME"}),(0,a.jsx)("th",{children:"STATUS"}),(0,a.jsx)("th",{children:"EMP COUNT"})]})}),(0,a.jsx)("tbody",{children:(()=>{const e=new Map;return S.forEach(i=>{const n=i.divisionHierarchyName||i.divisionName||"",l=he(n);l&&e.set(l,(e.get(l)||0)+1)}),ne.map((i,n)=>{var l,s,t,d,o,r,c,v,u;const m=String(null!==(l=null!==(s=null!==(t=null===i||void 0===i?void 0:i._id)&&void 0!==t?t:null===i||void 0===i?void 0:i.id)&&void 0!==s?s:null===i||void 0===i?void 0:i.code)&&void 0!==l?l:n),h=null!==(d=null!==(o=null===i||void 0===i?void 0:i._id)&&void 0!==o?o:null===i||void 0===i?void 0:i.id)&&void 0!==d?d:"",x=null!==(r=null!==(c=null!==(v=null===i||void 0===i?void 0:i.name)&&void 0!==v?v:null===i||void 0===i?void 0:i.DIVISION_NAME)&&void 0!==c?c:null===i||void 0===i?void 0:i.hie_name)&&void 0!==r?r:"",g=null!==(u=null===i||void 0===i?void 0:i.status)&&void 0!==u?u:"boolean"===typeof(null===i||void 0===i?void 0:i.isActive)?i.isActive?"ACTIVE":"INACTIVE":"",N=e.get(he(String(x)))||0;return(0,a.jsxs)("tr",{children:[(0,a.jsx)("td",{children:String(h)}),(0,a.jsx)("td",{children:String(x)}),(0,a.jsx)("td",{children:String(g)}),(0,a.jsx)("td",{children:String(N)})]},m)})})()})]})})]}),"sections"===h&&(()=>{var e;return(0,a.jsxs)("div",{className:"api-table-container",children:[(0,a.jsxs)("div",{className:"d-flex justify-content-between align-items-center mb-3",children:[(0,a.jsxs)("h3",{children:["HRIS Sections (Level 4)",(0,a.jsxs)("span",{className:"badge bg-primary ms-2",children:[o.length,"all"!==p&&` of ${j.length}`]})]}),(0,a.jsxs)("div",{className:"division-filter",children:[(0,a.jsx)("label",{htmlFor:"division-select",className:"form-label me-2",children:"Filter by Division:"}),(0,a.jsxs)("select",{id:"division-select",className:"form-select",value:p,onChange:ye,style:{width:"auto",display:"inline-block"},children:[(0,a.jsxs)("option",{value:"all",children:["All Divisions (",j.length," sections)"]}),Ee().map(e=>(0,a.jsxs)("option",{value:e.id,children:[e.name," (",j.filter(i=>String(i.divisionId)===String(e.id)).length," sections)"]},e.id))]})]})]}),"all"!==p&&(0,a.jsxs)("div",{className:"alert alert-info mb-3",children:[(0,a.jsx)("i",{className:"bi bi-filter"}),"Showing sections from: ",(0,a.jsx)("strong",{children:(null===(e=Ee().find(e=>String(e.id)===String(p)))||void 0===e?void 0:e.name)||p}),(0,a.jsxs)("span",{className:"ms-2",children:["(",o.length," of ",j.length," sections)"]})]}),(0,a.jsx)("div",{className:"mb-3",children:(0,a.jsxs)("button",{className:"btn btn-sm btn-outline-secondary",onClick:()=>T(!M),children:[M?"Hide":"Show"," Section JSON"]})}),M&&(0,a.jsx)("div",{className:"json-viewer",children:(()=>{const e="all"===p?se:se.filter(e=>String((e=>{var i,n,l,s,t,a,d,o,r,c,v,u;return{id:String(null!==(i=null!==(n=null!==(l=null!==(s=null!==(t=null!==(a=null!==(d=null===e||void 0===e?void 0:e._id)&&void 0!==d?d:null===e||void 0===e?void 0:e.id)&&void 0!==a?a:null===e||void 0===e?void 0:e.SECTION_ID)&&void 0!==t?t:null===e||void 0===e?void 0:e.code)&&void 0!==s?s:null===e||void 0===e?void 0:e.hie_code)&&void 0!==l?l:null===e||void 0===e?void 0:e.SECTION_CODE)&&void 0!==n?n:null===e||void 0===e?void 0:e.section_code)&&void 0!==i?i:""),divisionId:String(null!==(o=null!==(r=null!==(c=null!==(v=null!==(u=null===e||void 0===e?void 0:e.division_id)&&void 0!==u?u:null===e||void 0===e?void 0:e.DIVISION_ID)&&void 0!==v?v:null===e||void 0===e?void 0:e.division_code)&&void 0!==c?c:null===e||void 0===e?void 0:e.DIVISION_CODE)&&void 0!==r?r:null===e||void 0===e?void 0:e.hie_relationship)&&void 0!==o?o:"")}})(e).divisionId)===String(p));return(0,a.jsx)("pre",{children:JSON.stringify(e,null,2)})})()}),(0,a.jsx)("div",{className:"table-responsive",children:(0,a.jsxs)("table",{className:"table table-striped",children:[(0,a.jsx)("thead",{children:(0,a.jsxs)("tr",{children:[(0,a.jsx)("th",{children:"_ID"}),(0,a.jsx)("th",{children:"NAME"}),(0,a.jsx)("th",{children:"DIVISION CODE"}),(0,a.jsx)("th",{children:"DIVISION NAME"}),(0,a.jsx)("th",{children:"EMP COUNT"})]})}),(0,a.jsx)("tbody",{children:(()=>{const e=new Map;return S.forEach(i=>{const n=i.sectionId?String(i.sectionId):"",l=i.sectionCode?String(i.sectionCode):"",s=he(i.sectionHierarchyName||i.sectionName||"");n&&e.set(n,(e.get(n)||0)+1),l&&e.set(l,(e.get(l)||0)+1),s&&e.set(s,(e.get(s)||0)+1)}),o.map(i=>{const n=String(i.id||""),l=String(i.code||""),s=he(i.name||""),t=e.get(n)||e.get(l)||e.get(s)||0;return(0,a.jsxs)("tr",{children:[(0,a.jsx)("td",{children:String(i.id||"")}),(0,a.jsx)("td",{children:String(i.name||"")}),(0,a.jsx)("td",{children:String(i.divisionCode||"")}),(0,a.jsx)("td",{children:String(i.divisionName||"")}),(0,a.jsx)("td",{children:String(t)})]},n||l||s)})})()})]})})]})})(),"employees"===h&&(()=>{var e,i,l;const s="all"!==_,t=je(),d=s?S.filter(e=>pe(e,t)===String(_)):[],o=new Map;d.forEach(e=>{const i=e.sectionId?String(e.sectionId):"",n=e.sectionCode?String(e.sectionCode):"",l=he(e.sectionHierarchyName||e.sectionName||"");i&&o.set(i,(o.get(i)||0)+1),n&&o.set(n,(o.get(n)||0)+1),l&&o.set(l,(o.get(l)||0)+1)});const r=new Map(n.map(e=>[String(e.id),e.name])),v=new Map(j.map(e=>[String(e.id),e.name]));return(0,a.jsxs)("div",{className:"api-table-container",children:[(0,a.jsxs)("div",{className:"d-flex justify-content-between align-items-start mb-3",children:[(0,a.jsxs)("h3",{children:["HRIS Employees",(0,a.jsxs)("span",{className:"badge bg-primary ms-2",children:[c.length,(s||"all"!==E)&&S.length>0&&` of ${S.length}`]})]}),(0,a.jsxs)("div",{className:"employee-filters d-flex gap-3",children:[(0,a.jsxs)("div",{className:"division-filter",children:[(0,a.jsx)("label",{htmlFor:"employee-division-select",className:"form-label me-2",children:"Division:"}),(0,a.jsxs)("select",{id:"employee-division-select",className:"form-select",value:_,onChange:we,style:{width:"auto",minWidth:"200px"},children:[(0,a.jsx)("option",{value:"all",children:"All Divisions"}),De().map(e=>(0,a.jsx)("option",{value:e.key,children:e.name},e.key))]})]}),(0,a.jsxs)("div",{className:"section-filter",children:[(0,a.jsx)("label",{htmlFor:"employee-section-select",className:"form-label me-2",children:"Section:"}),(0,a.jsx)("select",{id:"employee-section-select",className:"form-select",value:E,onChange:Ae,style:{width:"auto",minWidth:"200px"},disabled:!s,children:s?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("option",{value:"all",children:["All Sections (",d.length," employees)"]}),C.length?C.map(e=>{const i=String(e.id||""),n=String(e.code||""),l=he(e.name||""),s=o.get(i)||o.get(n)||o.get(l)||0;return(0,a.jsxs)("option",{value:e.id,children:[e.name," (",s," employees)"]},e.id)}):(0,a.jsx)("option",{value:"__no_sections",disabled:!0,children:"No sections available"})]}):(0,a.jsx)("option",{value:"all",children:"Select a division first"})})]})]})]}),(0,a.jsxs)("div",{className:"mb-3 d-flex align-items-center gap-2",children:[(0,a.jsx)("label",{className:"form-label mb-0",children:"From:"}),(0,a.jsx)("input",{type:"date",className:"form-control",style:{width:"180px"},value:H,onChange:e=>F(e.target.value)}),(0,a.jsx)("label",{className:"form-label mb-0",children:"To:"}),(0,a.jsx)("input",{type:"date",className:"form-control",style:{width:"180px"},value:V,onChange:e=>L(e.target.value)}),(0,a.jsx)("small",{className:"text-muted ms-2",children:'Click "View Attendance" on an employee row to load individual punches.'})]}),("all"!==_||"all"!==E)&&(0,a.jsxs)("div",{className:"alert alert-info mb-3",children:[(0,a.jsx)("i",{className:"bi bi-filter"}),"Showing employees from:","all"!==_&&(0,a.jsx)("strong",{className:"ms-1",children:(null===(e=De().find(e=>String(e.key)===String(_)))||void 0===e?void 0:e.name)||_}),"all"!==E&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("i",{className:"bi bi-arrow-right mx-2"}),(0,a.jsx)("strong",{children:(null===(i=C.find(e=>String(e.id)===String(E)))||void 0===i?void 0:i.name)||E})]}),(0,a.jsxs)("span",{className:"ms-2",children:["(",c.length," of ",S.length," employees)"]})]}),(0,a.jsx)("div",{className:"mb-3",children:(0,a.jsxs)("button",{className:"btn btn-sm btn-outline-secondary",onClick:()=>O(!A),children:[A?"Hide":"Show"," Employee JSON"]})}),A&&(0,a.jsx)("div",{className:"json-viewer",children:(()=>{const e=C.find(e=>String(e.id)===String(E)),i=he((null===e||void 0===e?void 0:e.name)||""),n=ae.filter(e=>{const n=(e=>{var i,n,l,s,t,a,d,o,r,c,v;return{empNumber:String(null!==(i=null!==(n=null!==(l=null===e||void 0===e?void 0:e.EMP_NUMBER)&&void 0!==l?l:null===e||void 0===e?void 0:e.empNumber)&&void 0!==n?n:null===e||void 0===e?void 0:e.id)&&void 0!==i?i:""),divisionId:String(null!==(s=null!==(t=null!==(a=null!==(d=null===e||void 0===e?void 0:e.DIVISION_ID)&&void 0!==d?d:null===e||void 0===e?void 0:e.division_id)&&void 0!==a?a:null===e||void 0===e?void 0:e.DIVISION_CODE)&&void 0!==t?t:null===e||void 0===e?void 0:e.division_code)&&void 0!==s?s:""),sectionId:String(null!==(o=null!==(r=null!==(c=null!==(v=null===e||void 0===e?void 0:e.SECTION_ID)&&void 0!==v?v:null===e||void 0===e?void 0:e.section_id)&&void 0!==c?c:null===e||void 0===e?void 0:e.SECTION_CODE)&&void 0!==r?r:null===e||void 0===e?void 0:e.section_code)&&void 0!==o?o:"")}})(e);if("all"!==_&&String(n.divisionId)!==String(_))return!1;if("all"!==E){var l;if(String(n.sectionId)===String(E))return!0;const s=e.HIE_NAME_4||e.SECTION_NAME||(null===e||void 0===e||null===(l=e.currentwork)||void 0===l?void 0:l.HIE_NAME_4)||"",t=he(s);return i&&t===i}return!0});return(0,a.jsx)("pre",{children:JSON.stringify(n,null,2)})})()}),(0,a.jsx)("div",{className:"table-responsive",children:(0,a.jsxs)("table",{className:"table table-striped",children:[(0,a.jsx)("thead",{children:(0,a.jsxs)("tr",{children:[(0,a.jsx)("th",{children:"Employee ID"}),(0,a.jsx)("th",{children:"Full Name"}),(0,a.jsx)("th",{children:"Designation"}),(0,a.jsx)("th",{children:"Gender"}),(0,a.jsx)("th",{children:"NIC"}),(0,a.jsx)("th",{children:"Division"}),(0,a.jsx)("th",{children:"Section"}),(0,a.jsx)("th",{children:"Actions"})]})}),(0,a.jsx)("tbody",{children:c.map(e=>(0,a.jsxs)("tr",{children:[(0,a.jsx)("td",{children:e.empNumber}),(0,a.jsx)("td",{children:e.fullName}),(0,a.jsx)("td",{children:e.designation}),(0,a.jsx)("td",{children:e.gender}),(0,a.jsx)("td",{children:e.nic}),(0,a.jsx)("td",{children:e.divisionHierarchyName||e.divisionName||r.get(String(e.divisionId))||e.divisionCode||"-"}),(0,a.jsx)("td",{children:e.sectionHierarchyName||e.sectionName||v.get(String(e.sectionId))||e.sectionCode||"-"}),(0,a.jsx)("td",{children:(0,a.jsx)("button",{className:"btn btn-sm btn-outline-primary",onClick:()=>$e(e.empNumber),disabled:B,children:"View Attendance"})})]},e.empNumber))})]})}),K&&(0,a.jsxs)("div",{className:"attendance-panel mt-4",children:[(0,a.jsxs)("h5",{children:["Attendance for ",K," \xa0 ",(0,a.jsxs)("small",{className:"text-muted",children:["(",H," to ",V,")"]})]}),B?(0,a.jsx)("div",{className:"spinner-border text-primary",role:"status",children:(0,a.jsx)("span",{className:"visually-hidden",children:"Loading..."})}):J?(0,a.jsx)("div",{className:"alert alert-danger",children:J}):(0,a.jsxs)(a.Fragment,{children:[Y&&(0,a.jsxs)("div",{className:"mb-2",children:[(0,a.jsx)("strong",{children:"Summary:"})," ",(null!==(l=Y.total_records)&&void 0!==l?l:0===Y.total_records)?` ${Y.total_records} records`:""]}),(0,a.jsx)("div",{className:"table-responsive",children:(0,a.jsxs)("table",{className:"table table-sm table-bordered",children:[(0,a.jsx)("thead",{children:(0,a.jsxs)("tr",{children:[(0,a.jsx)("th",{children:"Date"}),(0,a.jsx)("th",{children:"Time"}),(0,a.jsx)("th",{children:"Scan Type"}),(0,a.jsx)("th",{children:"Division"}),(0,a.jsx)("th",{children:"Section"})]})}),(0,a.jsx)("tbody",{children:W&&W.length?W.map(e=>(0,a.jsxs)("tr",{children:[(0,a.jsx)("td",{children:e.date_}),(0,a.jsx)("td",{children:e.time_}),(0,a.jsx)("td",{children:e.scan_type}),(0,a.jsx)("td",{children:e.division_name||e.divisionName||""}),(0,a.jsx)("td",{children:e.section_name||e.sectionName||""})]},`${e.attendance_id||e.employee_ID}-${e.date_}-${e.time_}`)):(0,a.jsx)("tr",{children:(0,a.jsx)("td",{colSpan:5,className:"text-center",children:"No attendance records found for this period."})})})]})})]})]})]})})(),"individual-attendance"===h&&(()=>{var e;const i=n||[];return(0,a.jsxs)("div",{className:"api-table-container",children:[(0,a.jsx)("h3",{children:"Individual Attendance Report"}),(0,a.jsxs)("div",{className:"mb-3 d-flex align-items-center gap-2 flex-wrap",children:[(0,a.jsx)("label",{className:"form-label mb-0",children:"Division:"}),(0,a.jsxs)("select",{className:"form-select",style:{width:"260px"},value:X,onChange:e=>{Z(e.target.value),ie("all")},children:[(0,a.jsx)("option",{value:"all",children:"All Divisions"}),i.map(e=>(0,a.jsx)("option",{value:`id:${e.id}`,children:e.name},e.id))]}),(0,a.jsx)("label",{className:"form-label mb-0",children:"Section:"}),(0,a.jsx)("select",{className:"form-select",style:{width:"260px"},value:ee,onChange:e=>ie(e.target.value),disabled:"all"===X,children:"all"===X?(0,a.jsx)("option",{value:"all",children:"Select a division first"}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("option",{value:"all",children:"All Sections"}),Ce(X).map(e=>(0,a.jsx)("option",{value:e.id,children:e.name},e.id))]})}),(0,a.jsx)("label",{className:"form-label mb-0",children:"Period:"}),(0,a.jsxs)("select",{className:"form-select",style:{width:"180px"},value:R,onChange:e=>P(e.target.value),children:[(0,a.jsx)("option",{value:"last7",children:"Last 7 days"}),(0,a.jsx)("option",{value:"last30",children:"Last 30 days"}),(0,a.jsx)("option",{value:"thisMonth",children:"This month"}),(0,a.jsx)("option",{value:"custom",children:"Custom"})]}),(0,a.jsx)("label",{className:"form-label mb-0",children:"From:"}),(0,a.jsx)("input",{type:"date",className:"form-control",style:{width:"180px"},value:H,onChange:e=>{F(e.target.value),P("custom")}}),(0,a.jsx)("label",{className:"form-label mb-0",children:"To:"}),(0,a.jsx)("input",{type:"date",className:"form-control",style:{width:"180px"},value:V,onChange:e=>{L(e.target.value),P("custom")}}),(0,a.jsx)("label",{className:"form-label mb-0",children:"Employee ID:"}),(0,a.jsx)("input",{type:"text",className:"form-control",style:{width:"320px"},placeholder:"Enter employee ID",value:K||"",onChange:e=>Q(e.target.value||null),onKeyDown:e=>{if("Enter"===e.key){if(!K)return void G("Please enter an employee ID");$e(K)}}}),(0,a.jsx)("button",{className:"btn btn-primary",onClick:()=>{K?$e(K):G("Please select an employee")},disabled:B,children:B?"Loading...":"Load Report"})]}),J&&(0,a.jsx)("div",{className:"alert alert-danger",children:J}),Y&&(0,a.jsxs)("div",{className:"mb-2",children:[(0,a.jsx)("strong",{children:"Summary:"})," ",(null!==(e=Y.total_records)&&void 0!==e?e:0===Y.total_records)?` ${Y.total_records} records`:""]}),(0,a.jsx)("div",{className:"table-responsive",children:(0,a.jsxs)("table",{className:"table table-sm table-bordered",children:[(0,a.jsx)("thead",{children:(0,a.jsxs)("tr",{children:[(0,a.jsx)("th",{children:"Date"}),(0,a.jsx)("th",{children:"Time"}),(0,a.jsx)("th",{children:"Scan Type"}),(0,a.jsx)("th",{children:"Division"}),(0,a.jsx)("th",{children:"Section"})]})}),(0,a.jsx)("tbody",{children:W&&W.length?W.map(e=>(0,a.jsxs)("tr",{children:[(0,a.jsx)("td",{children:e.date_}),(0,a.jsx)("td",{children:e.time_}),(0,a.jsx)("td",{children:e.scan_type}),(0,a.jsx)("td",{children:e.division_name||e.divisionName||""}),(0,a.jsx)("td",{children:e.section_name||e.sectionName||""})]},`${e.attendance_id||e.employee_ID}-${e.date_}-${e.time_}`)):(0,a.jsx)("tr",{children:(0,a.jsx)("td",{colSpan:5,className:"text-center",children:"No attendance records loaded."})})})]})})]})})()]})]}),(0,a.jsxs)("div",{className:"api-stats",children:[(0,a.jsxs)("div",{className:"stat-card",children:[(0,a.jsx)("div",{className:"stat-value",children:n.length}),(0,a.jsx)("div",{className:"stat-label",children:"Divisions"})]}),(0,a.jsxs)("div",{className:"stat-card",children:[(0,a.jsxs)("div",{className:"stat-value",children:[o.length,"all"!==p&&j.length>0&&(0,a.jsxs)("small",{style:{fontSize:"0.6em",display:"block"},children:["of ",j.length]})]}),(0,a.jsx)("div",{className:"stat-label",children:"Sections"})]}),(0,a.jsxs)("div",{className:"stat-card",children:[(0,a.jsxs)("div",{className:"stat-value",children:[c.length,("all"!==_||"all"!==E)&&S.length>0&&(0,a.jsxs)("small",{style:{fontSize:"0.6em",display:"block"},children:["of ",S.length]})]}),(0,a.jsx)("div",{className:"stat-label",children:"Employees"})]})]})]})}}}]);
//# sourceMappingURL=825.22520e84.chunk.js.map