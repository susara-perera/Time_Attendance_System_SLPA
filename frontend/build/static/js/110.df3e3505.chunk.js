"use strict";(self.webpackChunktime_attendance_frontend=self.webpackChunktime_attendance_frontend||[]).push([[110],{83:(e,i,o)=>{o.d(i,{A:()=>l});o(43);var n=o(769),t=o(579);const l=e=>{let{title:i,subtitle:o,icon:l="bi-folder",actions:r,onBack:s}=e;return(0,t.jsxs)(t.Fragment,{children:[s&&(0,t.jsxs)("button",{className:"back-arrow-btn",onClick:s,title:"Back to Dashboard",style:{marginBottom:"12px",background:"transparent",color:"#0f172a",border:"1px solid rgba(15,23,42,0.08)",width:"auto",padding:"8px 12px"},children:[(0,t.jsx)("i",{className:"bi bi-arrow-left"}),"\xa0",(0,t.jsx)("span",{style:{fontWeight:600},children:"Back"})]}),(0,t.jsxs)("div",{className:"page-header-banner",children:[(0,t.jsxs)("div",{className:"page-header-content",children:[(0,t.jsxs)("div",{className:"page-header-left",children:[(0,t.jsx)("div",{className:"page-header-icon",children:(0,t.jsx)("i",{className:`bi ${l}`})}),(0,t.jsxs)("div",{className:"page-header-text",children:[(0,t.jsx)("h1",{children:i}),o&&(0,t.jsx)("p",{children:o})]})]}),(0,t.jsxs)("div",{className:"page-header-right",children:[r&&(0,t.jsx)("div",{className:"page-header-actions",children:r}),(0,t.jsx)("div",{className:"page-header-logo",children:(0,t.jsx)("img",{src:n,alt:"Company Logo"})})]})]}),(0,t.jsxs)("div",{className:"page-header-decoration",children:[(0,t.jsx)("div",{className:"decoration-circle decoration-circle-1"}),(0,t.jsx)("div",{className:"decoration-circle decoration-circle-2"}),(0,t.jsx)("div",{className:"decoration-circle decoration-circle-3"})]})]})]})}},110:(e,i,o)=>{o.r(i),o.d(i,{default:()=>d});var n=o(43),t=o(715),l=o(154),r=o(83),s=o(579);const d=e=>{var i,o,d,a,c,p,u,x,v,g,h,m,b,f,y,S,j,_,w,N,C,k,I,E,A,z,T,M,R,D;let{onBack:L}=e;const[O,W]=(0,n.useState)([]),[B,P]=(0,n.useState)([]),[$,F]=(0,n.useState)(!0),[U,H]=(0,n.useState)(""),[Y,V]=(0,n.useState)(""),[q,G]=(0,n.useState)("name_asc"),[J,Z]=(0,n.useState)(!1),[Q,K]=(0,n.useState)(!1),[X,ee]=(0,n.useState)(null),[ie,oe]=(0,n.useState)(!1),[ne,te]=(0,n.useState)(null),[le,re]=(0,n.useState)({name:"",code:""}),[se,de]=(0,n.useState)(!1),[ae,ce]=(0,n.useState)({}),[pe,ue]=(0,n.useState)(!1),[xe,ve]=(0,n.useState)(null),[ge,he]=(0,n.useState)({name:"",code:""}),[me,be]=(0,n.useState)(!1),[fe,ye]=(0,n.useState)({}),[Se,je]=(0,n.useState)([]),[_e,we]=(0,n.useState)([]),[Ne,Ce]=(0,n.useState)({name:"",division:""}),[ke,Ie]=(0,n.useState)({}),[Ee,Ae]=(0,n.useState)(!1),[ze,Te]=(0,n.useState)({}),[Me,Re]=(0,n.useState)({}),[De,Le]=(0,n.useState)({}),[Oe,We]=(0,n.useState)(!1),[Be,Pe]=(0,n.useState)(null),[$e,Fe]=(0,n.useState)(!1),[Ue,He]=(0,n.useState)(null),[Ye,Ve]=(0,n.useState)(!1),[qe,Ge]=(0,n.useState)(new Set),[Je,Ze]=(0,n.useState)(!1),[Qe,Ke]=(0,n.useState)([]),[Xe,ei]=(0,n.useState)(!1),[ii,oi]=(0,n.useState)(null),[ni,ti]=(0,n.useState)(!1),[li,ri]=(0,n.useState)(null),[si,di]=(0,n.useState)(!1),[ai,ci]=(0,n.useState)([]),[pi,ui]=(0,n.useState)(!1),[xi,vi]=(0,n.useState)(null),[gi,hi]=(0,n.useState)(!1),[mi,bi]=(0,n.useState)(!1),[fi,yi]=(0,n.useState)(new Set),[Si,ji]=(0,n.useState)(!1),[_i,wi]=(0,n.useState)(!1),[Ni,Ci]=(0,n.useState)([]),[ki,Ii]=(0,n.useState)(!1),[Ei,Ai]=(0,n.useState)(0),[zi,Ti]=(0,n.useState)(0),[Mi,Ri]=(0,n.useState)(""),[Di,Li]=(0,n.useState)(""),[Oi,Wi]=(0,n.useState)({show:!1,type:"success",title:"",message:""}),Bi=(0,n.useRef)(null),Pi=(0,t.A)("sections","read"),$i=(0,t.A)("sections","create"),Fi=(0,t.A)("subsections","read"),Ui=(0,t.A)("subsections","create"),Hi=(0,t.A)("subsections","update"),Yi=(0,t.A)("subsections","delete"),Vi=(0,t.A)("subsections","transfer"),qi=(0,t.A)("subsections","recall"),Gi="http://10.70.4.186:5000/api",Ji=e=>{let{type:i="success",title:o="",message:n="",duration:t=3e3}=e;Bi.current&&(clearTimeout(Bi.current),Bi.current=null);const l=n&&"object"===typeof n?n.message||JSON.stringify(n):String(n||"");Wi({show:!0,type:i,title:o,message:l}),Bi.current=setTimeout(()=>{Wi(e=>({...e,show:!1})),Bi.current=null},t)},Zi=e=>{const i=e=>String(e).padStart(2,"0");return`${e.getFullYear()}-${i(e.getMonth()+1)}-${i(e.getDate())}`},Qi=async function(e){let{force:i=!1}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!e)return;if(ze[e]&&!i)return;const o=localStorage.getItem("token");if(o){Re(i=>({...i,[e]:!0})),Le(i=>({...i,[e]:""}));try{const i=O.find(i=>i._id===e),n=(null===i||void 0===i?void 0:i.code)||e,t=await fetch(`${Gi}/mysql-subsections?sectionId=${encodeURIComponent(n)}`,{headers:{Authorization:`Bearer ${o}`},credentials:"include"});if(!t.ok)throw new Error(`HTTP ${t.status}`);const l=await t.json(),r=Array.isArray(null===l||void 0===l?void 0:l.data)?l.data:[];Te(i=>({...i,[e]:r}))}catch(n){console.error("Failed to fetch sub-sections:",n),Le(i=>({...i,[e]:"Failed to load sub-sections"}))}finally{Re(i=>({...i,[e]:!1}))}}},Ki=()=>{We(!1),Pe(null)},Xi=()=>{ue(!1),ve(null),he({name:"",code:""}),ye({}),be(!1)},eo=async(e,i)=>{try{console.log("\ud83d\udd0d Fetching transferred employees for subsection:",e);const o=await fetch(`${Gi}/mysql-subsections/transferred/${e}`,{method:"GET",headers:{Authorization:`Bearer ${i}`,"Content-Type":"application/json"},credentials:"include"});if(console.log("\ud83d\udce1 Response status:",o.status),!o.ok)return console.error("\u274c Failed to fetch transferred employees. Status:",o.status),[];const n=await o.json();console.log("\ud83d\udce6 Response data:",n);const t=(null===n||void 0===n?void 0:n.data)||[];console.log("\ud83d\udcca Number of transfers found:",t.length),t.length>0&&console.log("\ud83d\udccb Transfer records:",t);const l=t.map(e=>({employeeId:String(e.employeeId||e.employee_id||e.empId||e.emp_id||""),sub_section_id:e.sub_section_id||e.subSectionId||e.subsection_id||e.subsectionId}));return console.log("\ud83c\udfaf Mapped transferred IDs:",l),ci(i=>{const o=[...i.filter(i=>i.sub_section_id!==e),...l];return console.log("\u2705 Updated transferred employees list:",o),o}),l}catch(o){return console.error("\u274c Error fetching transferred employees:",o),[]}},[io,oo]=(0,n.useState)(!1),no=()=>{Fe(!1),He(null)},to=async e=>{if(qi){oi(e),bi(!0),yi(new Set),Ii(!0),Ci([]);try{const i=localStorage.getItem("token");if(!i)throw new Error("No authentication token");console.log("\ud83d\udd0d Fetching transferred employees for subsection:",e._id);const o=await fetch(`${Gi}/mysql-subsections/transferred/${e._id}`,{method:"GET",headers:{Authorization:`Bearer ${i}`,"Content-Type":"application/json"},credentials:"include"});if(!o.ok)throw new Error(`HTTP ${o.status}`);const n=await o.json(),t=(null===n||void 0===n?void 0:n.data)||[];console.log("\ud83d\udcca Transferred employees:",t);const l=t.map(e=>{var i,o;const n=null!==(i=null!==(o=e.employeeData)&&void 0!==o?o:e.employee_data)&&void 0!==i?i:null;if(!n)return{};try{return"string"===typeof n?JSON.parse(n):n}catch(t){return{}}}),r=l.filter(ro);console.log("\ud83c\udfaf Active transferred employees:",r.length,"(filtered out:",l.length-r.length,")"),Ci(r),Ii(!1)}catch(i){console.error("Error fetching transferred employees:",i),Ii(!1),Ji({type:"error",title:"Error",message:"Failed to fetch transferred employees"})}}else Ji({type:"error",title:"Permission",message:"You do not have permission to view transferred employees."})},lo=e=>"string"===typeof e?e.replace(/\s+/g," ").trim().toLowerCase():"",ro=e=>1===(null===e||void 0===e?void 0:e.ACTIVE_HRM_FLG)||"ACTIVE"===(null===e||void 0===e?void 0:e.STATUS)||"ACTIVE"===(null===e||void 0===e?void 0:e.status)||!0===(null===e||void 0===e?void 0:e.isActive),so=(0,n.useCallback)(async()=>{try{const e=localStorage.getItem("token"),[i,o]=await Promise.all([fetch(`${Gi}/mysql-data/sections`,{headers:{"Content-Type":"application/json"},credentials:"include"}).catch(()=>fetch(`${Gi}/sections/hris`,{headers:{Authorization:e?`Bearer ${e}`:"","Content-Type":"application/json"},credentials:"include"})),fetch(`${Gi}/mysql-data/divisions`,{headers:{"Content-Type":"application/json"},credentials:"include"}).catch(()=>fetch(`${Gi}/divisions/hris`,{headers:{Authorization:e?`Bearer ${e}`:"","Content-Type":"application/json"},credentials:"include"}))]);let n=[],t=[],l={};if(o.ok){const e=await o.json(),i=Array.isArray(null===e||void 0===e?void 0:e.data)?e.data:[];we(i),t=i.map(e=>{var i,n,t,r,s,d,a,c,p,u,x,v,g,h,m,b,f,y,S,j,_,w,N,C,k,I,E,A,z;const T=String(null!==(i=null!==(n=null!==(t=null!==(r=null!==(s=null!==(d=null!==(a=null!==(c=null===e||void 0===e?void 0:e._id)&&void 0!==c?c:null===e||void 0===e?void 0:e.id)&&void 0!==a?a:null===e||void 0===e?void 0:e.DIVISION_ID)&&void 0!==d?d:null===e||void 0===e?void 0:e.code)&&void 0!==s?s:null===e||void 0===e?void 0:e.division_code)&&void 0!==r?r:null===e||void 0===e?void 0:e.DIVISION_CODE)&&void 0!==t?t:null===e||void 0===e?void 0:e.hie_code)&&void 0!==n?n:null===e||void 0===e?void 0:e.HIE_CODE)&&void 0!==i?i:""),M=String(null!==(p=null!==(u=null!==(x=null!==(v=null!==(g=null===e||void 0===e?void 0:e.code)&&void 0!==g?g:null===e||void 0===e?void 0:e.DIVISION_CODE)&&void 0!==v?v:null===e||void 0===e?void 0:e.division_code)&&void 0!==x?x:null===e||void 0===e?void 0:e.hie_code)&&void 0!==u?u:null===e||void 0===e?void 0:e.HIE_CODE)&&void 0!==p?p:"");return M&&(l[M]=T),{_id:T,name:null!==(h=null!==(m=null!==(b=null!==(f=null!==(y=null!==(S=null===e||void 0===e?void 0:e.name)&&void 0!==S?S:null===e||void 0===e?void 0:e.division_name)&&void 0!==y?y:null===e||void 0===e?void 0:e.DIVISION_NAME)&&void 0!==f?f:null===e||void 0===e?void 0:e.hie_name)&&void 0!==b?b:null===e||void 0===e?void 0:e.HIE_NAME)&&void 0!==m?m:null===e||void 0===e?void 0:e.HIE_NAME_3)&&void 0!==h?h:`Division ${T}`,code:M,isActive:"boolean"===typeof(null===e||void 0===e?void 0:e.isActive)?e.isActive:"boolean"===typeof(null===e||void 0===e?void 0:e.active)?e.active:"ACTIVE"===(null===e||void 0===e?void 0:e.STATUS),status:null!==(j=null!==(_=null===e||void 0===e?void 0:e.status)&&void 0!==_?_:null===e||void 0===e?void 0:e.STATUS)&&void 0!==j?j:void 0,createdAt:null!==(w=null!==(N=null!==(C=null!==(k=null!==(I=null!==(E=null===e||void 0===e?void 0:e.createdAt)&&void 0!==E?E:null===e||void 0===e?void 0:e.created_at)&&void 0!==I?I:null===e||void 0===e?void 0:e.CREATED_AT)&&void 0!==k?k:null===e||void 0===e?void 0:e.createdOn)&&void 0!==C?C:null===e||void 0===e?void 0:e.CREATED_ON)&&void 0!==N?N:null===e||void 0===e?void 0:e.synced_at)&&void 0!==w?w:null,source:null!==(A=null===e||void 0===e?void 0:e.source)&&void 0!==A?A:null!==(z=o.url)&&void 0!==z&&z.includes("/mysql-data")?"MySQL Sync":"HRIS",_raw:e}}).sort((e,i)=>e.name.localeCompare(i.name)),console.log("Division Map (Code -> ID):",Object.keys(l).length,"entries"),P(t);const n=t.find(e=>{var i,o;return"66"===e.code||66===e.code||"66"===e.divisionCode||66===e.divisionCode||"66"===String(e.code).trim()||(null===(i=e.name)||void 0===i?void 0:i.toLowerCase().includes("information systems"))||(null===(o=e.name)||void 0===o?void 0:o.toLowerCase().includes("is division"))});n?(H(n._id),console.log("\u2705 Set default division to IS Division (66):",n._id,n.name)):(console.log('\u26a0\ufe0f IS Division (66) not found, using "all"'),H("all"))}if(i.ok){const e=await i.json(),o=Array.isArray(null===e||void 0===e?void 0:e.data)?e.data:[];je(o),n=o.map(e=>{var o,n,t,r,s,d,a,c,p,u,x,v,g,h,m,b,f,y,S,j,_,w,N,C,k,I,E,A,z,T,M,R,D,L,O,W,B,P,$,F,U,H,Y;const V=String(null!==(o=null!==(n=null!==(t=null!==(r=null===e||void 0===e?void 0:e.division_code)&&void 0!==r?r:null===e||void 0===e?void 0:e.DIVISION_CODE)&&void 0!==t?t:null===e||void 0===e?void 0:e.HIE_RELATIONSHIP)&&void 0!==n?n:null===e||void 0===e?void 0:e.HIE_CODE_3)&&void 0!==o?o:""),q=V&&l[V]?l[V]:String(null!==(s=null!==(d=null!==(a=null===e||void 0===e?void 0:e.division_id)&&void 0!==a?a:null===e||void 0===e?void 0:e.DIVISION_ID)&&void 0!==d?d:V)&&void 0!==s?s:""),G=null!==(c=null!==(p=null!==(u=null!==(x=null===e||void 0===e?void 0:e.division_name)&&void 0!==x?x:null===e||void 0===e?void 0:e.DIVISION_NAME)&&void 0!==u?u:null===e||void 0===e||null===(v=e.parentDivision)||void 0===v?void 0:v.division_name)&&void 0!==p?p:null===e||void 0===e||null===(g=e.parentDivision)||void 0===g?void 0:g.name)&&void 0!==c?c:"",J=String(null!==(h=null!==(m=null!==(b=null!==(f=null!==(y=null!==(S=null!==(j=null!==(_=null===e||void 0===e?void 0:e._id)&&void 0!==_?_:null===e||void 0===e?void 0:e.id)&&void 0!==j?j:null===e||void 0===e?void 0:e.SECTION_ID)&&void 0!==S?S:null===e||void 0===e?void 0:e.code)&&void 0!==y?y:null===e||void 0===e?void 0:e.hie_code)&&void 0!==f?f:null===e||void 0===e?void 0:e.SECTION_CODE)&&void 0!==b?b:null===e||void 0===e?void 0:e.section_code)&&void 0!==m?m:null===e||void 0===e?void 0:e.HIE_CODE)&&void 0!==h?h:"");return{_id:J,name:null!==(w=null!==(N=null!==(C=null!==(k=null!==(I=null!==(E=null!==(A=null===e||void 0===e?void 0:e.name)&&void 0!==A?A:null===e||void 0===e?void 0:e.section_name)&&void 0!==E?E:null===e||void 0===e?void 0:e.SECTION_NAME)&&void 0!==I?I:null===e||void 0===e?void 0:e.hie_name)&&void 0!==k?k:null===e||void 0===e?void 0:e.HIE_NAME)&&void 0!==C?C:null===e||void 0===e?void 0:e.HIE_NAME_4)&&void 0!==N?N:null===e||void 0===e?void 0:e.hie_relationship)&&void 0!==w?w:`Section ${J}`,division:G?{_id:q||void 0,name:G}:q||"",code:String(null!==(z=null!==(T=null!==(M=null!==(R=null!==(D=null===e||void 0===e?void 0:e.code)&&void 0!==D?D:null===e||void 0===e?void 0:e.SECTION_CODE)&&void 0!==R?R:null===e||void 0===e?void 0:e.hie_code)&&void 0!==M?M:null===e||void 0===e?void 0:e.HIE_CODE)&&void 0!==T?T:null===e||void 0===e?void 0:e.section_code)&&void 0!==z?z:""),divisionCode:V,isActive:"boolean"===typeof(null===e||void 0===e?void 0:e.isActive)?e.isActive:"boolean"===typeof(null===e||void 0===e?void 0:e.active)?e.active:"ACTIVE"===(null===e||void 0===e?void 0:e.STATUS),status:null!==(L=null!==(O=null===e||void 0===e?void 0:e.status)&&void 0!==O?O:null===e||void 0===e?void 0:e.STATUS)&&void 0!==L?L:void 0,createdAt:null!==(W=null!==(B=null!==(P=null!==($=null!==(F=null!==(U=null===e||void 0===e?void 0:e.createdAt)&&void 0!==U?U:null===e||void 0===e?void 0:e.created_at)&&void 0!==F?F:null===e||void 0===e?void 0:e.CREATED_AT)&&void 0!==$?$:null===e||void 0===e?void 0:e.createdOn)&&void 0!==P?P:null===e||void 0===e?void 0:e.CREATED_ON)&&void 0!==B?B:null===e||void 0===e?void 0:e.synced_at)&&void 0!==W?W:null,source:null!==(H=null===e||void 0===e?void 0:e.source)&&void 0!==H?H:null!==(Y=i.url)&&void 0!==Y&&Y.includes("/mysql-data")?"MySQL Sync":"HRIS",_raw:e}}).sort((e,i)=>e.name.localeCompare(i.name)),W(n)}F(!1)}catch(e){console.error("Error fetching data:",e),F(!1)}},[Gi]),ao=e=>{if("object"===typeof e&&null!==e&&void 0!==e&&e.name)return e.name;if(!e)return"N/A";const i=B.find(i=>String(i._id)===String(e)||String(i.code)===String(e));return i?i.name:"N/A"},co=e=>{const{name:i,value:o}=e.target;Ce(e=>({...e,[i]:o})),ke[i]&&Ie(e=>({...e,[i]:""}))},po=()=>{oe(!1),te(null),re({name:"",code:""}),ce({})},uo=()=>{Z(!1),K(!1),ee(null),Ce({name:"",division:""}),Ie({})};if((0,n.useEffect)(()=>{so()},[so]),$)return(0,s.jsx)("div",{className:"loading-container",children:(0,s.jsx)("div",{className:"spinner-border",role:"status",children:(0,s.jsx)("span",{className:"visually-hidden",children:"Loading..."})})});if(!Pi)return(0,s.jsxs)("div",{className:"section-management",children:[(0,s.jsx)(r.A,{title:"Section Management",subtitle:"Manage organizational sections, sub-sections and employee assignments",icon:"bi-diagram-3"}),(0,s.jsx)("div",{className:"professional-card",children:(0,s.jsx)("div",{className:"no-data",children:(0,s.jsx)("p",{children:"You do not have permission to view sections. Contact a Super Admin for access."})})})]});const xo=e=>{var i;return e?"object"===typeof e.division&&null!==(i=e.division)&&void 0!==i&&i._id?String(e.division._id):"string"===typeof e.division?String(e.division):"":""},vo=U&&"all"!==U?O.filter(e=>{var i,o;const n=xo(e);if(n)return String(n)===String(U);const t=lo("object"===typeof e.division?null===(i=e.division)||void 0===i?void 0:i.name:""),l=(null===(o=B.find(e=>String(e._id)===String(U)))||void 0===o?void 0:o.name)||"",r=lo(l);return t&&r&&t===r}):O,go=(()=>{const e=lo(Y);return(e?vo.filter(i=>{const o=String(i._id||i.code||i.sectionId||""),n=lo(i.name||"");return o.includes(e)||n.includes(e)}):vo).slice().sort((e,i)=>{const o=e=>String((null===e||void 0===e?void 0:e.name)||"").toLowerCase(),n=e=>{var i,o,n;const t=null!==(i=null!==(o=null!==(n=null===e||void 0===e?void 0:e.code)&&void 0!==n?n:null===e||void 0===e?void 0:e.sectionId)&&void 0!==o?o:null===e||void 0===e?void 0:e._id)&&void 0!==i?i:"",l=Number(String(t).replace(/[^0-9.-]/g,""));return Number.isFinite(l)?l:String(t)};if("name_asc"===q)return o(e).localeCompare(o(i));if("name_desc"===q)return o(i).localeCompare(o(e));if("id_asc"===q){const o=n(e),t=n(i);return"number"===typeof o&&"number"===typeof t?o-t:String(o).localeCompare(String(t))}if("id_desc"===q){const o=n(e),t=n(i);return"number"===typeof o&&"number"===typeof t?t-o:String(t).localeCompare(String(o))}return 0})})(),ho=e=>H(e.target.value);return(0,s.jsxs)("div",{className:"section-management",children:[(0,s.jsx)("style",{children:"\n        @keyframes toast-slide-in { from { transform: translateY(-12px); opacity: 0 } to { transform: translateY(0); opacity: 1 } }\n        @keyframes toast-progress { from { width: 100% } to { width: 0 } }\n      "}),Oi.show&&(0,s.jsx)("div",{role:"status","aria-live":"polite",style:{position:"fixed",top:20,right:20,zIndex:12e3},children:(0,s.jsxs)("div",{style:{minWidth:320,maxWidth:420,background:"#111827",color:"white",borderRadius:12,boxShadow:"0 10px 30px rgba(0,0,0,0.25)",padding:14,display:"flex",gap:12,alignItems:"flex-start",animation:"toast-slide-in 200ms ease-out",borderLeft:"6px solid "+("success"===Oi.type?"#10b981":"warning"===Oi.type?"#f59e0b":"#ef4444")},children:[(0,s.jsx)("div",{style:{width:36,height:36,borderRadius:8,background:"success"===Oi.type?"rgba(16,185,129,0.18)":"warning"===Oi.type?"rgba(245,158,11,0.18)":"rgba(239,68,68,0.18)",display:"flex",alignItems:"center",justifyContent:"center",color:"success"===Oi.type?"#34d399":"warning"===Oi.type?"#fbbf24":"#f87171",flexShrink:0},children:(0,s.jsx)("i",{className:"bi "+("success"===Oi.type?"bi-check2-circle":"warning"===Oi.type?"bi-exclamation-triangle":"bi-x-circle"),style:{fontSize:18}})}),(0,s.jsxs)("div",{style:{flex:1},children:[Oi.title?(0,s.jsx)("div",{style:{fontWeight:700,fontSize:15,marginBottom:2},children:Oi.title}):null,(0,s.jsx)("div",{style:{fontSize:14,opacity:.95},children:Oi.message}),(0,s.jsx)("div",{style:{height:3,background:"rgba(255,255,255,0.2)",borderRadius:2,marginTop:10,overflow:"hidden"},children:(0,s.jsx)("div",{style:{height:"100%",background:"success"===Oi.type?"#34d399":"warning"===Oi.type?"#fbbf24":"#f87171",animation:"toast-progress 3s linear forwards"}})})]}),(0,s.jsx)("button",{onClick:()=>{Bi.current&&(clearTimeout(Bi.current),Bi.current=null),Wi(e=>({...e,show:!1}))},"aria-label":"Close notification",style:{background:"transparent",border:"none",color:"rgba(255,255,255,0.8)",cursor:"pointer",padding:6,borderRadius:6,alignSelf:"center"},children:(0,s.jsx)("i",{className:"bi bi-x-lg"})})]})}),Je&&ii&&(0,s.jsx)("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(0, 0, 0, 0.5)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:10001,padding:"20px"},children:(0,s.jsxs)("div",{style:{background:"white",borderRadius:"16px",maxWidth:"700px",width:"100%",boxShadow:"0 20px 60px rgba(0, 0, 0, 0.3)",overflow:"hidden"},children:[(0,s.jsxs)("div",{style:{background:"linear-gradient(135deg, #667eea 0%, #764ba2 100%)",padding:"20px 28px",display:"flex",alignItems:"center",gap:"12px"},children:[(0,s.jsx)("i",{className:"bi bi-people-fill",style:{fontSize:"22px",color:"white"}}),(0,s.jsxs)("h3",{style:{margin:0,color:"white",fontSize:"18px",fontWeight:"600"},children:["Confirm Bulk Transfer (",qe.size," selected)"]})]}),(0,s.jsxs)("div",{style:{padding:"24px"},children:[(0,s.jsxs)("p",{style:{fontSize:"14px",color:"#374151",marginBottom:"12px"},children:["You're about to transfer ",(0,s.jsx)("strong",{children:qe.size})," employee",1!==qe.size?"s":""," to:"]}),(0,s.jsxs)("div",{style:{padding:"12px 16px",background:"#f9fafb",borderRadius:"8px",border:"1px solid #e5e7eb"},children:[(0,s.jsx)("div",{style:{fontSize:"14px",color:"#1f2937",fontWeight:"600"},children:(null===ii||void 0===ii||null===(i=ii.subSection)||void 0===i?void 0:i.sub_hie_name)||(null===ii||void 0===ii||null===(o=ii.subSection)||void 0===o?void 0:o.hie_name)||"N/A"}),(0,s.jsx)("div",{style:{fontSize:"13px",color:"#6b7280"},children:(null===ii||void 0===ii||null===(d=ii.parentSection)||void 0===d?void 0:d.hie_name)||"Section: N/A"}),(0,s.jsx)("div",{style:{fontSize:"13px",color:"#6b7280"},children:(null===ii||void 0===ii||null===(a=ii.parentDivision)||void 0===a?void 0:a.division_name)||"Division: N/A"})]}),(0,s.jsxs)("div",{style:{marginTop:"18px"},children:[(0,s.jsx)("strong",{style:{color:"#374151"},children:"Selected employees preview:"}),(0,s.jsxs)("div",{style:{marginTop:"8px",maxHeight:"160px",overflowY:"auto",border:"1px solid #e5e7eb",borderRadius:"8px",padding:"8px"},children:[Array.from(qe).slice(0,10).map((e,i)=>{const o=Qe.find(i=>String((null===i||void 0===i?void 0:i.EMP_NUMBER)||(null===i||void 0===i?void 0:i.empNumber)||(null===i||void 0===i?void 0:i.EMP_ID)||(null===i||void 0===i?void 0:i.emp_id)||"")===e),n=(null===o||void 0===o?void 0:o.FULLNAME)||(null===o||void 0===o?void 0:o.fullName)||(null===o||void 0===o?void 0:o.CALLING_NAME)||(null===o||void 0===o?void 0:o.calling_name)||(null===o||void 0===o?void 0:o.name)||e;return(0,s.jsxs)("div",{style:{padding:"6px 8px",borderBottom:"1px dashed #e5e7eb",fontSize:"13px"},children:[e," - ",n]},e+i)}),qe.size>10&&(0,s.jsxs)("div",{style:{padding:"6px 8px",color:"#6b7280",fontSize:"13px"},children:["+ ",qe.size-10," more..."]})]})]})]}),(0,s.jsxs)("div",{style:{padding:"20px 28px",borderTop:"1px solid #e5e7eb",background:"#f9fafb",display:"flex",justifyContent:"flex-end",gap:"12px"},children:[(0,s.jsx)("button",{onClick:()=>Ze(!1),disabled:io,style:{padding:"10px 20px",border:"2px solid #d1d5db",borderRadius:"8px",backgroundColor:"white",color:"#6b7280",fontSize:"13px",fontWeight:"600",cursor:io?"not-allowed":"pointer"},children:"Cancel"}),(0,s.jsx)("button",{onClick:async()=>{if(!Vi)return Ze(!1),Ji({type:"error",title:"Permission",message:"You do not have permission to transfer employees."});if(!ii||0===qe.size)return;oo(!0);const e=localStorage.getItem("token");if(!e)return oo(!1),Ze(!1),Ji({type:"error",title:"Auth",message:"Token missing. Please login."});try{const o=Array.from(qe),n=Qe.filter(e=>o.includes(String((null===e||void 0===e?void 0:e.EMP_NUMBER)||(null===e||void 0===e?void 0:e.empNumber)||(null===e||void 0===e?void 0:e.EMP_ID)||(null===e||void 0===e?void 0:e.emp_id)||""))).map(e=>{var i,o,n,t,l,r,s,d;return{employeeId:String((null===e||void 0===e?void 0:e.EMP_NUMBER)||(null===e||void 0===e?void 0:e.empNumber)||(null===e||void 0===e?void 0:e.EMP_ID)||(null===e||void 0===e?void 0:e.emp_id)||""),employeeName:(null===e||void 0===e?void 0:e.FULLNAME)||(null===e||void 0===e?void 0:e.fullName)||(null===e||void 0===e?void 0:e.CALLING_NAME)||(null===e||void 0===e?void 0:e.calling_name)||(null===e||void 0===e?void 0:e.name)||"",division_code:(null===ii||void 0===ii||null===(i=ii.parentDivision)||void 0===i?void 0:i.division_code)||"",division_name:(null===ii||void 0===ii||null===(o=ii.parentDivision)||void 0===o?void 0:o.division_name)||"",hie_code:(null===ii||void 0===ii||null===(n=ii.parentSection)||void 0===n?void 0:n.hie_code)||"",hie_name:(null===ii||void 0===ii||null===(t=ii.parentSection)||void 0===t?void 0:t.hie_name)||"",sub_section_id:(null===ii||void 0===ii?void 0:ii._id)||"",sub_hie_code:(null===ii||void 0===ii||null===(l=ii.subSection)||void 0===l?void 0:l.sub_hie_code)||(null===ii||void 0===ii||null===(r=ii.subSection)||void 0===r?void 0:r.hie_code)||"",sub_hie_name:(null===ii||void 0===ii||null===(s=ii.subSection)||void 0===s?void 0:s.sub_hie_name)||(null===ii||void 0===ii||null===(d=ii.subSection)||void 0===d?void 0:d.hie_name)||"",transferredAt:(new Date).toISOString(),employeeData:e}});let t=await fetch(`${Gi}/mysql-subsections/transfer/bulk`,{method:"POST",headers:{Authorization:`Bearer ${e}`,"Content-Type":"application/json"},credentials:"include",body:JSON.stringify(n)});if(t.ok){const e=await t.json();console.log("Bulk transfer result:",e)}else if(console.warn("Bulk transfer failed, will fallback to single inserts if supported. Status:",t.status),404===t.status||501===t.status||405===t.status){const i=[];for(const o of n){const n=await fetch(`${Gi}/mysql-subsections/transfer`,{method:"POST",headers:{Authorization:`Bearer ${e}`,"Content-Type":"application/json"},credentials:"include",body:JSON.stringify(o)});i.push(n)}if(i.some(e=>!e.ok))throw new Error("One or more single transfers failed in fallback")}else{const i=[];for(const o of n){const n=await fetch(`${Gi}/mysql-subsections/transfer`,{method:"POST",headers:{Authorization:`Bearer ${e}`,"Content-Type":"application/json"},credentials:"include",body:JSON.stringify(o)});i.push(n)}if(i.some(e=>!e.ok))throw new Error("One or more single transfers failed in fallback")}ci(e=>{const i=[...e,...n.map(e=>({employeeId:String(e.employeeId),sub_section_id:String(e.sub_section_id)}))],o=[],t=new Set;return i.forEach(e=>{const i=`${e.employeeId}_${e.sub_section_id}`;t.has(i)||(t.add(i),o.push(e))}),o}),Ke(e=>e.filter(e=>!qe.has(String((null===e||void 0===e?void 0:e.EMP_NUMBER)||(null===e||void 0===e?void 0:e.empNumber)||(null===e||void 0===e?void 0:e.EMP_ID)||(null===e||void 0===e?void 0:e.emp_id)||"")))),Ge(new Set),Ze(!1),oo(!1),Ji({type:"success",title:"Bulk Transfer Completed",message:`${n.length} employee${1!==n.length?"s were":" was"} transferred successfully.`});try{await eo(ii._id,e)}catch(i){console.warn("Failed to refresh transfers after bulk operation",i)}}catch(o){console.error("Bulk transfer failed:",o),Ze(!1),oo(!1),Ji({type:"error",title:"Transfer Failed",message:"Bulk transfer failed. Check console for details."})}},disabled:io,style:{padding:"10px 20px",border:"none",borderRadius:"8px",background:io?"#9ca3af":"linear-gradient(135deg, #10b981, #059669)",color:"white",fontSize:"13px",fontWeight:"600",cursor:io?"not-allowed":"pointer"},children:io?"Transferring...":`Confirm (${qe.size})`})]})]})}),(0,s.jsx)("style",{children:"\n        @keyframes spin {\n          from { transform: rotate(0deg); }\n          to { transform: rotate(360deg); }\n        }\n        .modal-overlay {\n          backdrop-filter: blur(2px);\n        }\n      "}),(0,s.jsx)(r.A,{title:"Section Management",subtitle:"Manage organizational sections, sub-sections and employee assignments",icon:"bi-diagram-3",onBack:L}),(0,s.jsxs)("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",background:"#fff",borderRadius:"16px",boxShadow:"0 2px 12px rgba(102,126,234,0.07)",padding:"28px 32px",marginBottom:"28px",gap:"32px",flexWrap:"wrap"},children:[(0,s.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"18px",flex:1,minWidth:320},children:[(0,s.jsx)("label",{htmlFor:"divisionFilter",className:"form-label m-0",style:{fontWeight:600,color:"#374151",fontSize:"16px"},children:"Filter by Division:"}),(()=>{const e=new Map,i=new Map(B.map(e=>[lo(e.name||""),String(e._id)]));O.forEach(o=>{let n=xo(o);if(!n){var t;const e="object"===typeof o.division?null===(t=o.division)||void 0===t?void 0:t.name:"",l=i.get(lo(e||""));l&&(n=l)}n&&e.set(String(n),(e.get(String(n))||0)+1)});return(0,s.jsxs)("select",{id:"divisionFilter",className:"form-select",value:U||"all",onChange:ho,style:{minWidth:"260px",fontSize:"15px",borderRadius:"8px",border:"2px solid #e0e7ff",background:"#f8fafc",color:"#374151",fontWeight:500,boxShadow:"0 1px 4px rgba(102,126,234,0.04)",padding:"10px 18px",outline:"none",transition:"border 0.2s"},children:[(0,s.jsxs)("option",{value:"all",children:["All Divisions (",O.length," sections)"]}),B.map(i=>{return(0,s.jsxs)("option",{value:i._id,children:[i.name," (",(o=i._id,e.get(String(o))||0),")"]},i._id);var o})]})})()]}),(0,s.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"12px",flex:1,minWidth:320,justifyContent:"flex-end"},children:[(0,s.jsx)("label",{htmlFor:"sectionSearch",className:"form-label m-0",style:{fontWeight:600,color:"#374151",fontSize:"16px"},children:"Search:"}),(0,s.jsxs)("select",{id:"sectionSort",value:q,onChange:e=>G(e.target.value),style:{fontSize:"14px",borderRadius:"8px",border:"2px solid #e0e7ff",background:"#fff",color:"#374151",fontWeight:600,boxShadow:"0 1px 4px rgba(102,126,234,0.04)",padding:"8px 12px",outline:"none",marginRight:"8px"},children:[(0,s.jsx)("option",{value:"name_asc",children:"Name A \u2192 Z"}),(0,s.jsx)("option",{value:"name_desc",children:"Name Z \u2192 A"}),(0,s.jsx)("option",{value:"id_asc",children:"ID Small \u2192 High"}),(0,s.jsx)("option",{value:"id_desc",children:"ID High \u2192 Small"})]}),(0,s.jsx)("input",{id:"sectionSearch",type:"text",className:"form-control",placeholder:"Search by Section ID or Name",value:Y,onChange:e=>V(e.target.value),style:{maxWidth:"320px",fontSize:"15px",borderRadius:"8px",border:"2px solid #e0e7ff",background:"#f8fafc",color:"#374151",fontWeight:500,boxShadow:"0 1px 4px rgba(102,126,234,0.04)",padding:"10px 18px",outline:"none",transition:"border 0.2s"}})]})]}),(0,s.jsxs)("div",{className:"professional-card",children:[(0,s.jsx)("div",{className:"table-responsive",children:(0,s.jsxs)("table",{className:"professional-table",children:[(0,s.jsx)("thead",{children:(0,s.jsxs)("tr",{children:[(0,s.jsx)("th",{children:"Section Name"}),(0,s.jsx)("th",{children:"Division"}),(0,s.jsx)("th",{children:"Sub Section"})]})}),(0,s.jsx)("tbody",{children:go.map(e=>{var i,o,n,t;return(0,s.jsxs)("tr",{className:"section-row section-card",children:[(0,s.jsx)("td",{"data-label":"Section Name",style:{minWidth:320},children:(0,s.jsxs)("div",{style:{display:"flex",flexDirection:"column",gap:6},children:[(0,s.jsx)("div",{style:{fontSize:"15px",fontWeight:700,color:"#0f172a"},children:e.name}),(0,s.jsx)("div",{style:{color:"#6b7280",fontSize:"13px"},children:String(e.code||"").toUpperCase()})]})}),(0,s.jsx)("td",{"data-label":"Division",style:{width:260},children:(0,s.jsx)("span",{className:"role-badge",children:ao(e.division)})}),(0,s.jsx)("td",{"data-label":"Sub Section",children:(0,s.jsxs)("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",gap:12},children:[(0,s.jsxs)("div",{className:"sub-count",children:[null!==(i=null===(o=ze[e._id])||void 0===o?void 0:o.length)&&void 0!==i?i:0," sub-section",1!==(null!==(n=null===(t=ze[e._id])||void 0===t?void 0:t.length)&&void 0!==n?n:0)?"s":""]}),(0,s.jsxs)("div",{className:"sub-actions",children:[(0,s.jsx)("button",{className:"btn-professional btn-success",onClick:Ui?()=>(e=>{te(e),re({name:"",code:""}),ce({}),oe(!0)})(e):void 0,title:Ui?"Create Sub-Section":"No permission to create sub sections",disabled:!Ui,style:{padding:"8px 12px",fontSize:"12px",cursor:Ui?"pointer":"not-allowed"},children:(0,s.jsx)("i",{className:"bi bi-plus"})}),Fi?(0,s.jsx)("button",{className:"btn-professional btn-light",onClick:()=>(async e=>{Pe(e),We(!0);const i=e._id;ze[i]||await Qi(i)})(e),title:"View Sub-Sections",style:{padding:"8px 12px",fontSize:"12px"},children:(0,s.jsx)("i",{className:"bi bi-chevron-right"})}):null]})]})})]},e._id)})})]})}),0===O.length&&(0,s.jsx)("div",{className:"no-data",children:(0,s.jsx)("p",{children:"No sections found."})})]}),(J||Q)&&(0,s.jsx)("div",{className:"modal-overlay",onClick:uo,children:(0,s.jsxs)("div",{className:"modal-content professional-form",onClick:e=>e.stopPropagation(),children:[(0,s.jsxs)("div",{className:"modal-header",style:{borderBottom:"2px solid var(--gray-200)",paddingBottom:"20px",marginBottom:"24px"},children:[(0,s.jsxs)("h3",{style:{fontSize:"24px",fontWeight:"700",color:"var(--gray-900)",display:"flex",alignItems:"center",gap:"12px"},children:[(0,s.jsx)("i",{className:"bi "+(X?"bi-pencil-square":"bi-plus-circle"),style:{color:"var(--primary)"}}),X?"Edit Section":"Add New Section"]}),(0,s.jsx)("button",{className:"modal-close btn-professional btn-danger",onClick:uo,style:{padding:"8px 12px",fontSize:"16px"},children:(0,s.jsx)("i",{className:"bi bi-x"})})]}),(0,s.jsxs)("form",{onSubmit:async e=>{if(e.preventDefault(),!$i)return void(0,l.Vv)({type:"error",title:"Permission Denied",message:"You do not have permission to perform this action.",duration:3e3});const i=(()=>{const e={};return Ne.name.trim()||(e.name="Section name is required"),Ne.division||(e.division="Division is required"),console.log("Form validation:",{formData:Ne,errors:e,divisionsCount:B.length}),e})();if(Object.keys(i).length>0)Ie(i);else{Ae(!0);try{const e=localStorage.getItem("token");if(!e)return(0,l.Vv)({type:"error",title:"Authentication Required",message:"Authentication token not found. Please log in again.",duration:3e3}),void Ae(!1);const i={name:Ne.name.trim(),division:Ne.division,code:Ne.name.trim().toUpperCase().replace(/[^A-Z0-9]/g,"_").slice(0,10),status:"active"};if(console.log("Submitting section data:",i),console.log("Token available:",!!e),console.log("Request URL:",X?`http://localhost:5000/api/sections/${X._id}`:"http://localhost:5000/api/sections"),X){const n=await fetch(`http://localhost:5000/api/sections/${X._id}`,{method:"PUT",headers:{Authorization:`Bearer ${e}`,"Content-Type":"application/json"},credentials:"include",body:JSON.stringify(i)});if(console.log("Update response status:",n.status),console.log("Update response headers:",Object.fromEntries(n.headers.entries())),n.ok){const e=await n.json();console.log("Section updated:",e),await so(),(0,l.Vv)({type:"success",title:"Updated!",message:"Section updated successfully!",duration:3e3})}else{let e="Unknown error";try{const i=await n.json();console.error("Failed to update section:",n.status,i),i.errors&&Array.isArray(i.errors)?e=i.errors.map(e=>e.message).join(", "):i.error?e=i.error:i.message&&(e=i.message)}catch(o){console.error("Error parsing response:",o),e=`HTTP ${n.status}: ${n.statusText}`}(0,l.Vv)({type:"error",title:"Update Failed",message:`Failed to update section: ${e}`,duration:4e3})}}else{const n=await fetch("http://localhost:5000/api/sections",{method:"POST",headers:{Authorization:`Bearer ${e}`,"Content-Type":"application/json"},credentials:"include",body:JSON.stringify(i)});if(console.log("Create response status:",n.status),console.log("Create response headers:",Object.fromEntries(n.headers.entries())),n.ok){const e=await n.json();console.log("Section created:",e),await so(),(0,l.Vv)({type:"success",title:"Created!",message:"Section created successfully!",duration:3e3,showConfetti:!0})}else{let e="Unknown error";try{const i=await n.json();console.error("Failed to create section:",n.status,i),i.errors&&Array.isArray(i.errors)?e=i.errors.map(e=>e.message).join(", "):i.error?e=i.error:i.message&&(e=i.message)}catch(o){console.error("Error parsing response:",o),e=`HTTP ${n.status}: ${n.statusText}`}(0,l.Vv)({type:"error",title:"Creation Failed",message:`Failed to create section: ${e}`,duration:4e3})}}uo()}catch(n){console.error("Error submitting section:",n),(0,l.Vv)({type:"error",title:"Error",message:`Error ${X?"updating":"adding"} section. Please try again.`,duration:4e3})}finally{Ae(!1)}}},className:"modal-body",children:[(0,s.jsxs)("div",{className:"form-group",children:[(0,s.jsx)("label",{className:"form-label",children:"Section Name *"}),(0,s.jsx)("input",{type:"text",name:"name",className:"form-input "+(ke.name?"error":""),value:Ne.name,onChange:co,placeholder:"Enter section name",required:!0}),ke.name&&(0,s.jsx)("span",{className:"error-text",children:ke.name})]}),(0,s.jsxs)("div",{className:"form-group",children:[(0,s.jsx)("label",{className:"form-label",children:"Division *"}),(0,s.jsxs)("select",{name:"division",className:"form-select "+(ke.division?"error":""),value:Ne.division,onChange:co,required:!0,children:[(0,s.jsx)("option",{value:"",children:"Select Division"}),B.map(e=>(0,s.jsxs)("option",{value:e._id,children:[e.name," (",e.code,")"]},e._id))]}),ke.division&&(0,s.jsx)("span",{className:"error-text",children:ke.division})]}),(0,s.jsxs)("div",{className:"modal-footer",style:{borderTop:"2px solid var(--gray-200)",paddingTop:"20px",marginTop:"24px",display:"flex",gap:"12px",justifyContent:"flex-end"},children:[(0,s.jsx)("button",{type:"button",className:"btn-professional btn-secondary",onClick:uo,disabled:Ee,style:{background:"var(--gray-500)"},children:"Cancel"}),(0,s.jsxs)("button",{type:"submit",className:"btn-professional btn-success",disabled:Ee||!$i,"aria-disabled":Ee||!$i,title:$i?"":"You do not have permission to perform this action",children:[(0,s.jsx)("i",{className:"bi "+(X?"bi-check-circle":"bi-plus-circle")}),Ee?X?"Updating...":"Adding...":X?"Update Section":"Add Section"]})]})]})]})}),ie&&ne&&(0,s.jsx)("div",{className:"modal-overlay",onClick:po,style:{position:"fixed",top:0,left:0,width:"100%",height:"100%",backgroundColor:"rgba(0, 0, 0, 0.6)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:1050,backdropFilter:"blur(2px)",padding:"20px",boxSizing:"border-box"},children:(0,s.jsxs)("div",{className:"modal-content",onClick:e=>e.stopPropagation(),style:{backgroundColor:"#fff",borderRadius:"16px",boxShadow:"0 20px 60px rgba(0, 0, 0, 0.15)",width:"100%",maxWidth:"950px",maxHeight:"calc(100vh - 40px)",position:"relative",border:"none",overflow:"hidden",display:"flex",flexDirection:"column"},children:[(0,s.jsxs)("div",{style:{background:"linear-gradient(135deg, #667eea 0%, #764ba2 100%)",color:"white",padding:"24px 32px 20px",borderRadius:"16px 16px 0 0",position:"relative",overflow:"hidden",flexShrink:0},children:[(0,s.jsx)("div",{style:{position:"relative",zIndex:2},children:(0,s.jsxs)("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between"},children:[(0,s.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"16px"},children:[(0,s.jsx)("div",{style:{backgroundColor:"rgba(255, 255, 255, 0.2)",borderRadius:"12px",padding:"12px",backdropFilter:"blur(10px)"},children:(0,s.jsx)("i",{className:"bi bi-diagram-3-fill",style:{fontSize:"24px",color:"white"}})}),(0,s.jsxs)("div",{children:[(0,s.jsx)("h3",{style:{margin:0,fontSize:"22px",fontWeight:"700",letterSpacing:"-0.5px",textShadow:"0 2px 4px rgba(0, 0, 0, 0.1)"},children:"Create Sub-Section"}),(0,s.jsx)("p",{style:{margin:"4px 0 0",fontSize:"14px",opacity:.9,fontWeight:"400"},children:"Add a new sub-division to organize your structure"})]})]}),(0,s.jsx)("button",{onClick:po,style:{background:"rgba(255, 255, 255, 0.2)",border:"none",borderRadius:"8px",color:"white",cursor:"pointer",padding:"8px",fontSize:"20px",transition:"all 0.2s ease",backdropFilter:"blur(10px)"},onMouseOver:e=>e.target.style.background="rgba(255, 255, 255, 0.3)",onMouseOut:e=>e.target.style.background="rgba(255, 255, 255, 0.2)",children:(0,s.jsx)("i",{className:"bi bi-x-lg"})})]})}),(0,s.jsx)("div",{style:{position:"absolute",top:"-50%",right:"-10%",width:"200px",height:"200px",background:"radial-gradient(circle, rgba(255,255,255,0.1) 0%, transparent 70%)",borderRadius:"50%"}})]}),(0,s.jsxs)("div",{style:{padding:"24px 32px",flex:1,overflowY:"auto",minHeight:0},children:[(0,s.jsxs)("div",{style:{background:"linear-gradient(135deg, #667eea15 0%, #764ba215 100%)",border:"2px solid #667eea",borderRadius:"8px",padding:"16px 20px",marginBottom:"20px",display:"flex",alignItems:"center",gap:"12px"},children:[(0,s.jsx)("i",{className:"bi bi-funnel-fill",style:{color:"#667eea",fontSize:"20px"}}),(0,s.jsxs)("div",{style:{flex:1},children:[(0,s.jsx)("div",{style:{fontWeight:"600",color:"#495057",marginBottom:"4px"},children:"Parent Structure:"}),(0,s.jsxs)("div",{style:{display:"flex",alignItems:"center",flexWrap:"wrap",gap:"8px"},children:[(0,s.jsx)("span",{style:{background:"#667eea",color:"white",padding:"4px 12px",borderRadius:"20px",fontSize:"13px",fontWeight:"500"},children:(null===(c=B.find(e=>{var i;return String(e._id)===String("object"===typeof ne.division&&null!==(i=ne.division)&&void 0!==i&&i._id?ne.division._id:String(ne.division||""))}))||void 0===c?void 0:c.name)||("object"===typeof ne.division?null===(p=ne.division)||void 0===p?void 0:p.name:"")||"N/A"}),(0,s.jsx)("i",{className:"bi bi-chevron-right",style:{color:"#667eea"}}),(0,s.jsx)("span",{style:{background:"#764ba2",color:"white",padding:"4px 12px",borderRadius:"20px",fontSize:"13px",fontWeight:"500"},children:ne.name||"N/A"})]})]})]}),(0,s.jsxs)("div",{style:{backgroundColor:"white",borderRadius:"10px",border:"2px solid #e1e5f2",padding:"20px"},children:[(0,s.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"10px",marginBottom:"18px"},children:[(0,s.jsx)("i",{className:"bi bi-plus-circle-fill",style:{color:"#10b981",fontSize:"16px"}}),(0,s.jsx)("h4",{style:{margin:0,fontSize:"15px",fontWeight:"600",color:"#374151"},children:"New Sub-Section Details"})]}),(0,s.jsxs)("div",{style:{display:"grid",gridTemplateColumns:"2fr 1fr",gap:"20px"},children:[(0,s.jsxs)("div",{children:[(0,s.jsxs)("label",{style:{display:"flex",alignItems:"center",gap:"6px",fontSize:"14px",fontWeight:"600",color:"#374151",marginBottom:"10px"},children:[(0,s.jsx)("i",{className:"bi bi-type",style:{color:"#667eea"}}),"Sub-Section Name",(0,s.jsx)("span",{style:{color:"#ef4444",fontSize:"14px"},children:"*"})]}),(0,s.jsx)("input",{type:"text",value:le.name,onChange:e=>re({...le,name:e.target.value}),placeholder:"Enter a descriptive name for the sub-section",style:{width:"100%",padding:"14px",border:ae.name?"2px solid #ef4444":"2px solid #e5e7eb",borderRadius:"8px",fontSize:"14px",transition:"all 0.2s ease",backgroundColor:"#fff",fontFamily:"inherit",outline:"none",boxSizing:"border-box"},onFocus:e=>{ae.name||(e.target.style.borderColor="#667eea"),e.target.style.boxShadow="0 0 0 3px rgba(102, 126, 234, 0.1)"},onBlur:e=>{ae.name||(e.target.style.borderColor="#e5e7eb"),e.target.style.boxShadow="none"}}),ae.name&&(0,s.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"6px",color:"#ef4444",fontSize:"13px",marginTop:"8px",fontWeight:"500"},children:[(0,s.jsx)("i",{className:"bi bi-exclamation-circle-fill"}),ae.name]})]}),(0,s.jsxs)("div",{children:[(0,s.jsxs)("label",{style:{display:"flex",alignItems:"center",gap:"6px",fontSize:"14px",fontWeight:"600",color:"#374151",marginBottom:"10px"},children:[(0,s.jsx)("i",{className:"bi bi-hash",style:{color:"#667eea"}}),"Sub-Section Code/ID",(0,s.jsx)("span",{style:{color:"#ef4444",fontSize:"14px"},children:"*"})]}),(0,s.jsx)("input",{type:"text",value:le.code,onChange:e=>re({...le,code:e.target.value}),placeholder:"e.g., SS-001",style:{width:"100%",padding:"14px",border:ae.code?"2px solid #ef4444":"2px solid #e5e7eb",borderRadius:"8px",fontSize:"14px",transition:"all 0.2s ease",backgroundColor:"#fff",fontFamily:"inherit",outline:"none",boxSizing:"border-box"},onFocus:e=>{ae.code||(e.target.style.borderColor="#667eea"),e.target.style.boxShadow="0 0 0 3px rgba(102, 126, 234, 0.1)"},onBlur:e=>{ae.code||(e.target.style.borderColor="#e5e7eb"),e.target.style.boxShadow="none"}}),ae.code&&(0,s.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"6px",color:"#ef4444",fontSize:"13px",marginTop:"8px",fontWeight:"500"},children:[(0,s.jsx)("i",{className:"bi bi-exclamation-circle-fill"}),ae.code]})]})]})]})]}),(0,s.jsxs)("div",{style:{padding:"16px 32px 20px",borderTop:"1px solid #f3f4f6",backgroundColor:"#fafafa",display:"flex",gap:"12px",justifyContent:"flex-end",borderRadius:"0 0 16px 16px",flexShrink:0},children:[(0,s.jsxs)("button",{onClick:po,disabled:se,style:{padding:"12px 24px",border:"2px solid #d1d5db",borderRadius:"8px",backgroundColor:"white",color:"#6b7280",fontSize:"14px",fontWeight:"600",cursor:se?"not-allowed":"pointer",transition:"all 0.2s ease",opacity:se?.6:1},onMouseOver:e=>{se||(e.target.style.borderColor="#9ca3af",e.target.style.color="#374151")},onMouseOut:e=>{se||(e.target.style.borderColor="#d1d5db",e.target.style.color="#6b7280")},children:[(0,s.jsx)("i",{className:"bi bi-x-circle",style:{marginRight:"6px"}}),"Cancel"]}),(0,s.jsxs)("button",{onClick:async()=>{if(!Ui)return void Ji({type:"error",title:"Permission",message:"You do not have permission to create sub-sections."});const e=(()=>{const e={};return le.name.trim()||(e.name="Sub-section name is required"),le.code.trim()||(e.code="Sub-section code is required"),e})();if(Object.keys(e).length)ce(e);else try{var i,o;de(!0);const e=localStorage.getItem("token"),d=ne,a="object"===typeof d.division&&null!==(i=d.division)&&void 0!==i&&i._id?d.division._id:String(d.division||""),c=B.find(e=>String(e._id)===String(a))||{},p=_e.find(e=>{var i,o,n,t,l;const r=String(null!==(i=null!==(o=null!==(n=null!==(t=null!==(l=null===e||void 0===e?void 0:e._id)&&void 0!==l?l:null===e||void 0===e?void 0:e.id)&&void 0!==t?t:null===e||void 0===e?void 0:e.DIVISION_ID)&&void 0!==n?n:null===e||void 0===e?void 0:e.code)&&void 0!==o?o:null===e||void 0===e?void 0:e.DIVISION_CODE)&&void 0!==i?i:"");return r&&String(r)===String(c._id||a)}),u=d._raw||Se.find(e=>{var i,o,n,t,l;const r=String(null!==(i=null!==(o=null!==(n=null!==(t=null!==(l=null===e||void 0===e?void 0:e._id)&&void 0!==l?l:null===e||void 0===e?void 0:e.id)&&void 0!==t?t:null===e||void 0===e?void 0:e.SECTION_ID)&&void 0!==n?n:null===e||void 0===e?void 0:e.code)&&void 0!==o?o:null===e||void 0===e?void 0:e.SECTION_CODE)&&void 0!==i?i:"");return r&&String(r)===String(d._id)}),x=(null===u||void 0===u?void 0:u.hie_code)||(null===u||void 0===u?void 0:u.SECTION_CODE)||(null===u||void 0===u?void 0:u.code)||d.code||"",v=(null===p||void 0===p?void 0:p.DIVISION_CODE)||(null===p||void 0===p?void 0:p.division_code)||c.code||d.divisionCode||"",g={parentDivision:{id:v,division_code:v,division_name:(null===p||void 0===p?void 0:p.DIVISION_NAME)||(null===p||void 0===p?void 0:p.division_name)||c.name||("object"===typeof d.division?null===(o=d.division)||void 0===o?void 0:o.name:"")},parentSection:{id:x,hie_code:x,hie_name:(null===u||void 0===u?void 0:u.hie_name)||(null===u||void 0===u?void 0:u.SECTION_NAME)||(null===u||void 0===u?void 0:u.name)||d.name||""},subSection:{sub_hie_name:le.name.trim(),sub_hie_code:le.code.trim()},hrisSnapshot:{division:p||null,section:u||null}};console.log("\ud83d\udd0d Subsection Payload:",JSON.stringify(g,null,2));const h=await fetch(`${Gi}/mysql-subsections`,{method:"POST",headers:{Authorization:`Bearer ${e}`,"Content-Type":"application/json"},credentials:"include",body:JSON.stringify(g)});if(h.ok){const e=await h.json().catch(()=>null);po(),Ji({type:"success",title:"Success",message:"Sub-section created successfully."});const i=null===ne||void 0===ne?void 0:ne._id;if(i){var n,t,l,r;const o=String(i),s=null!==(n=null!==(t=null!==(l=null!==(r=null===e||void 0===e?void 0:e.data)&&void 0!==r?r:null===e||void 0===e?void 0:e.created)&&void 0!==l?l:null===e||void 0===e?void 0:e.subSection)&&void 0!==t?t:e)&&void 0!==n?n:null;s&&Te(e=>({...e,[o]:[...e[o]||[],s]})),await Qi(i,{force:!0})}}else{let e="Failed to create sub-section";try{const i=await h.json();e=(null===i||void 0===i?void 0:i.message)||e}catch(s){}Ji({type:"error",title:"Request Failed",message:e})}}catch(d){console.error("Error creating sub-section:",d),Ji({type:"error",title:"Unexpected Error",message:"Error creating sub-section."})}finally{de(!1)}},disabled:se,style:{padding:"12px 24px",border:"none",borderRadius:"8px",background:se?"linear-gradient(135deg, #9ca3af 0%, #6b7280 100%)":"linear-gradient(135deg, #10b981 0%, #059669 100%)",color:"white",fontSize:"14px",fontWeight:"600",cursor:se?"not-allowed":"pointer",transition:"all 0.2s ease",boxShadow:se?"none":"0 3px 10px rgba(16, 185, 129, 0.3)"},onMouseOver:e=>{se||(e.target.style.transform="translateY(-1px)",e.target.style.boxShadow="0 4px 15px rgba(16, 185, 129, 0.4)")},onMouseOut:e=>{se||(e.target.style.transform="translateY(0)",e.target.style.boxShadow="0 3px 10px rgba(16, 185, 129, 0.3)")},children:[(0,s.jsx)("i",{className:"bi "+(se?"bi-arrow-repeat":"bi-check-circle"),style:{marginRight:"8px",animation:se?"spin 1s linear infinite":"none"}}),se?"Creating...":"Create Sub-Section"]})]})]})}),pe&&xe&&(0,s.jsx)("div",{className:"modal-overlay",onClick:Xi,style:{position:"fixed",top:0,left:0,width:"100%",height:"100%",backgroundColor:"rgba(0, 0, 0, 0.6)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:11500,backdropFilter:"blur(2px)",padding:"20px",boxSizing:"border-box"},children:(0,s.jsxs)("div",{className:"modal-content",onClick:e=>e.stopPropagation(),style:{backgroundColor:"#fff",borderRadius:"16px",boxShadow:"0 20px 60px rgba(0, 0, 0, 0.15)",width:"100%",maxWidth:"950px",maxHeight:"calc(100vh - 40px)",position:"relative",border:"none",overflow:"hidden",display:"flex",flexDirection:"column"},children:[(0,s.jsxs)("div",{style:{background:"linear-gradient(135deg, #667eea 0%, #764ba2 100%)",color:"white",padding:"24px 32px 20px",borderRadius:"16px 16px 0 0",position:"relative",overflow:"hidden",flexShrink:0},children:[(0,s.jsx)("div",{style:{position:"relative",zIndex:2},children:(0,s.jsxs)("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between"},children:[(0,s.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"16px"},children:[(0,s.jsx)("div",{style:{backgroundColor:"rgba(255, 255, 255, 0.2)",borderRadius:"12px",padding:"12px",backdropFilter:"blur(10px)"},children:(0,s.jsx)("i",{className:"bi bi-pencil-square",style:{fontSize:"24px",color:"white"}})}),(0,s.jsxs)("div",{children:[(0,s.jsx)("h3",{style:{margin:0,fontSize:"22px",fontWeight:"700",letterSpacing:"-0.5px",textShadow:"0 2px 4px rgba(0, 0, 0, 0.1)"},children:"Edit Sub-Section"}),(0,s.jsx)("p",{style:{margin:"4px 0 0",fontSize:"14px",opacity:.9,fontWeight:"400"},children:"Modify the sub-section details"})]})]}),(0,s.jsx)("button",{onClick:Xi,disabled:me,style:{background:"rgba(255, 255, 255, 0.2)",border:"none",borderRadius:"8px",color:"white",cursor:me?"not-allowed":"pointer",padding:"8px",fontSize:"20px",transition:"all 0.2s ease",backdropFilter:"blur(10px)",opacity:me?.5:1},onMouseOver:e=>{me||(e.target.style.background="rgba(255, 255, 255, 0.3)")},onMouseOut:e=>{me||(e.target.style.background="rgba(255, 255, 255, 0.2)")},children:(0,s.jsx)("i",{className:"bi bi-x-lg"})})]})}),(0,s.jsx)("div",{style:{position:"absolute",top:"-50%",right:"-10%",width:"200px",height:"200px",background:"radial-gradient(circle, rgba(255,255,255,0.1) 0%, transparent 70%)",borderRadius:"50%"}})]}),(0,s.jsxs)("div",{style:{padding:"24px 32px",flex:1,overflowY:"auto",minHeight:0},children:[(0,s.jsxs)("div",{style:{background:"linear-gradient(135deg, #667eea15 0%, #764ba215 100%)",border:"2px solid #667eea",borderRadius:"8px",padding:"16px 20px",marginBottom:"20px",display:"flex",alignItems:"center",gap:"12px"},children:[(0,s.jsx)("i",{className:"bi bi-funnel-fill",style:{color:"#667eea",fontSize:"20px"}}),(0,s.jsxs)("div",{style:{flex:1},children:[(0,s.jsx)("div",{style:{fontWeight:"600",color:"#495057",marginBottom:"4px"},children:"Parent Structure:"}),(0,s.jsxs)("div",{style:{display:"flex",alignItems:"center",flexWrap:"wrap",gap:"8px"},children:[(0,s.jsx)("span",{style:{background:"#667eea",color:"white",padding:"4px 12px",borderRadius:"20px",fontSize:"13px",fontWeight:"500"},children:(null===xe||void 0===xe?void 0:xe.parentDivision)||"N/A"}),(0,s.jsx)("i",{className:"bi bi-chevron-right",style:{color:"#667eea"}}),(0,s.jsx)("span",{style:{background:"#764ba2",color:"white",padding:"4px 12px",borderRadius:"20px",fontSize:"13px",fontWeight:"500"},children:(null===xe||void 0===xe?void 0:xe.parentSection)||"N/A"})]})]})]}),(0,s.jsxs)("div",{style:{backgroundColor:"white",borderRadius:"10px",border:"2px solid #e1e5f2",padding:"20px"},children:[(0,s.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"10px",marginBottom:"18px"},children:[(0,s.jsx)("i",{className:"bi bi-pencil-fill",style:{color:"#667eea",fontSize:"16px"}}),(0,s.jsx)("h4",{style:{margin:0,fontSize:"15px",fontWeight:"600",color:"#374151"},children:"Edit Sub-Section Details"})]}),(0,s.jsxs)("div",{style:{display:"grid",gridTemplateColumns:"2fr 1fr",gap:"20px"},children:[(0,s.jsxs)("div",{children:[(0,s.jsxs)("label",{style:{display:"flex",alignItems:"center",gap:"6px",fontSize:"14px",fontWeight:"600",color:"#374151",marginBottom:"10px"},children:[(0,s.jsx)("i",{className:"bi bi-type",style:{color:"#667eea"}}),"Sub-Section Name",(0,s.jsx)("span",{style:{color:"#ef4444",fontSize:"14px"},children:"*"})]}),(0,s.jsx)("input",{type:"text",value:ge.name,onChange:e=>{he({...ge,name:e.target.value}),fe.name&&ye({...fe,name:""})},placeholder:"Enter a descriptive name for the sub-section",disabled:me,style:{width:"100%",padding:"14px",border:fe.name?"2px solid #ef4444":"2px solid #e5e7eb",borderRadius:"8px",fontSize:"14px",transition:"all 0.2s ease",backgroundColor:me?"#f3f4f6":"#fff",fontFamily:"inherit",outline:"none",boxSizing:"border-box"},onFocus:e=>{fe.name||me||(e.target.style.borderColor="#667eea",e.target.style.boxShadow="0 0 0 3px rgba(102, 126, 234, 0.1)")},onBlur:e=>{fe.name||(e.target.style.borderColor="#e5e7eb"),e.target.style.boxShadow="none"}}),fe.name&&(0,s.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"6px",color:"#ef4444",fontSize:"13px",marginTop:"8px",fontWeight:"500"},children:[(0,s.jsx)("i",{className:"bi bi-exclamation-circle-fill"}),fe.name]})]}),(0,s.jsxs)("div",{children:[(0,s.jsxs)("label",{style:{display:"flex",alignItems:"center",gap:"6px",fontSize:"14px",fontWeight:"600",color:"#374151",marginBottom:"10px"},children:[(0,s.jsx)("i",{className:"bi bi-hash",style:{color:"#667eea"}}),"Sub-Section Code/ID",(0,s.jsx)("span",{style:{color:"#ef4444",fontSize:"14px"},children:"*"})]}),(0,s.jsx)("input",{type:"text",value:ge.code,onChange:e=>{he({...ge,code:e.target.value}),fe.code&&ye({...fe,code:""})},placeholder:"e.g., SS-001",disabled:me,style:{width:"100%",padding:"14px",border:fe.code?"2px solid #ef4444":"2px solid #e5e7eb",borderRadius:"8px",fontSize:"14px",transition:"all 0.2s ease",backgroundColor:me?"#f3f4f6":"#fff",fontFamily:"inherit",outline:"none",boxSizing:"border-box"},onFocus:e=>{fe.code||me||(e.target.style.borderColor="#667eea",e.target.style.boxShadow="0 0 0 3px rgba(102, 126, 234, 0.1)")},onBlur:e=>{fe.code||(e.target.style.borderColor="#e5e7eb"),e.target.style.boxShadow="none"}}),fe.code&&(0,s.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"6px",color:"#ef4444",fontSize:"13px",marginTop:"8px",fontWeight:"500"},children:[(0,s.jsx)("i",{className:"bi bi-exclamation-circle-fill"}),fe.code]})]})]})]})]}),(0,s.jsxs)("div",{style:{padding:"16px 32px",borderTop:"1px solid #e5e7eb",backgroundColor:"#f9fafb",display:"flex",gap:"10px",justifyContent:"flex-end",borderRadius:"0 0 16px 16px",flexShrink:0},children:[(0,s.jsxs)("button",{onClick:Xi,disabled:me,style:{padding:"10px 20px",border:"2px solid #e5e7eb",borderRadius:"8px",backgroundColor:"white",color:"#6b7280",fontSize:"14px",fontWeight:"600",cursor:me?"not-allowed":"pointer",transition:"all 0.2s ease",opacity:me?.6:1,display:"flex",alignItems:"center",gap:"6px"},onMouseOver:e=>{me||(e.target.style.borderColor="#9ca3af",e.target.style.color="#374151",e.target.style.transform="translateY(-1px)",e.target.style.boxShadow="0 2px 8px rgba(0, 0, 0, 0.1)")},onMouseOut:e=>{me||(e.target.style.borderColor="#d1d5db",e.target.style.color="#6b7280",e.target.style.transform="translateY(0)",e.target.style.boxShadow="none")},children:[(0,s.jsx)("i",{className:"bi bi-x-circle",style:{fontSize:"14px"}}),"Cancel"]}),(0,s.jsxs)("button",{onClick:async()=>{if(!xe)return;if(!Hi)return void Ji({type:"error",title:"Permission",message:"You do not have permission to update sub-sections."});const e={};if(ge.name.trim()||(e.name="Sub-section name is required"),ge.code.trim()||(e.code="Sub-section code is required"),Object.keys(e).length>0)return void ye(e);be(!0);const i=localStorage.getItem("token");if(!i)return be(!1),void Ji({type:"error",title:"Auth",message:"Token missing. Please login."});try{var o,n,t,l;const e=(null===xe||void 0===xe||null===(o=xe.subSection)||void 0===o?void 0:o._id)||(null===xe||void 0===xe||null===(n=xe.subSection)||void 0===n?void 0:n._id)||(null===xe||void 0===xe||null===(t=xe.subSection)||void 0===t?void 0:t.id)||(null===xe||void 0===xe||null===(l=xe.subSection)||void 0===l?void 0:l.section_id)||"",s={sub_hie_name:ge.name.trim(),sub_hie_code:ge.code.trim(),hie_name:ge.name.trim(),hie_code:ge.code.trim(),name:ge.name.trim(),code:ge.code.trim()},d=await fetch(`${Gi}/mysql-subsections/${encodeURIComponent(e)}`,{method:"PUT",headers:{Authorization:`Bearer ${i}`,"Content-Type":"application/json"},credentials:"include",body:JSON.stringify(s)});if(!d.ok){let e=`Failed to update sub-section (HTTP ${d.status})`;try{const i=await d.json();e=(null===i||void 0===i?void 0:i.message)||e}catch(r){}throw new Error(e)}ue(!1),ve(null),he({name:"",code:""}),be(!1),setTimeout(()=>{Ji({type:"success",title:"Success!",message:"Sub-section updated successfully."})},150),await Qi(xe.sectionId,{force:!0})}catch(s){console.error("Edit sub-section failed:",s),be(!1),Ji({type:"error",title:"Failed",message:(null===s||void 0===s?void 0:s.message)||"Could not update sub-section."})}},disabled:me,style:{padding:"10px 24px",border:"none",borderRadius:"8px",background:me?"linear-gradient(135deg, #9ca3af 0%, #6b7280 100%)":"linear-gradient(135deg, #1e40af 0%, #3b82f6 50%, #60a5fa 100%)",color:"white",fontSize:"14px",fontWeight:"600",cursor:me?"not-allowed":"pointer",transition:"all 0.2s ease",boxShadow:me?"none":"0 3px 10px rgba(59, 130, 246, 0.4)",display:"flex",alignItems:"center",gap:"8px"},onMouseOver:e=>{me||(e.target.style.transform="translateY(-1px)",e.target.style.boxShadow="0 4px 15px rgba(59, 130, 246, 0.5)")},onMouseOut:e=>{me||(e.target.style.transform="translateY(0)",e.target.style.boxShadow="0 3px 10px rgba(59, 130, 246, 0.4)")},children:[(0,s.jsx)("i",{className:"bi "+(me?"bi-arrow-repeat":"bi-check-circle-fill"),style:{fontSize:"14px",animation:me?"spin 1s linear infinite":"none"}}),me?"Updating...":"Update Sub-Section"]})]})]})}),Oe&&Be&&(0,s.jsx)("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(0, 0, 0, 0.6)",backdropFilter:"blur(8px)",WebkitBackdropFilter:"blur(8px)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:1e4,padding:"20px"},onClick:Ki,children:(0,s.jsxs)("div",{style:{backgroundColor:"white",borderRadius:"16px",boxShadow:"0 20px 60px rgba(0, 0, 0, 0.3)",width:"95%",maxWidth:"1400px",height:"90vh",maxHeight:"90vh",display:"flex",flexDirection:"column",overflow:"hidden"},onClick:e=>e.stopPropagation(),children:[(0,s.jsxs)("div",{style:{padding:"24px 32px",borderBottom:"2px solid #e5e7eb",background:"linear-gradient(135deg, #667eea 0%, #764ba2 100%)",color:"white",display:"flex",alignItems:"center",justifyContent:"space-between",flexShrink:0},children:[(0,s.jsxs)("h3",{style:{fontSize:"24px",fontWeight:"700",margin:0,display:"flex",alignItems:"center",gap:"12px"},children:[(0,s.jsx)("i",{className:"bi bi-layers"}),"Sub-Sections"]}),(0,s.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"12px"},children:[Ui?(0,s.jsxs)("button",{onClick:()=>{We(!1),setTimeout(()=>{te(Be),re({name:"",code:""}),ce({}),oe(!0)},250)},style:{background:"#fff",color:"#764ba2",border:"none",borderRadius:"8px",fontWeight:700,fontSize:"15px",padding:"8px 18px",marginRight:"8px",boxShadow:"0 2px 8px rgba(102, 126, 234, 0.08)",cursor:"pointer",display:"flex",alignItems:"center",gap:"7px",transition:"background 0.2s, color 0.2s"},title:"Add Subsection",children:[(0,s.jsx)("i",{className:"bi bi-plus-circle"})," Add Subsection"]}):null,(0,s.jsx)("button",{onClick:Ki,style:{background:"rgba(255, 255, 255, 0.2)",border:"none",borderRadius:"8px",color:"white",fontSize:"20px",width:"40px",height:"40px",display:"flex",alignItems:"center",justifyContent:"center",cursor:"pointer",transition:"all 0.2s ease"},onMouseOver:e=>{e.target.style.background="rgba(255, 255, 255, 0.3)"},onMouseOut:e=>{e.target.style.background="rgba(255, 255, 255, 0.2)"},children:(0,s.jsx)("i",{className:"bi bi-x"})})]})]}),(0,s.jsxs)("div",{style:{background:"linear-gradient(135deg, #667eea15 0%, #764ba215 100%)",border:"2px solid #667eea",borderRadius:"8px",padding:"16px 20px",margin:"16px 32px",display:"flex",alignItems:"center",gap:"12px",flexShrink:0},children:[(0,s.jsx)("i",{className:"bi bi-funnel-fill",style:{color:"#667eea",fontSize:"20px"}}),(0,s.jsxs)("div",{style:{flex:1},children:[(0,s.jsx)("div",{style:{fontWeight:"600",color:"#495057",marginBottom:"4px"},children:"Active Filters:"}),(0,s.jsxs)("div",{style:{display:"flex",alignItems:"center",flexWrap:"wrap",gap:"8px"},children:[(0,s.jsx)("span",{style:{background:"#667eea",color:"white",padding:"4px 12px",borderRadius:"20px",fontSize:"13px",fontWeight:"500"},children:ao(Be.division)}),(0,s.jsx)("i",{className:"bi bi-chevron-right",style:{color:"#667eea"}}),(0,s.jsx)("span",{style:{background:"#764ba2",color:"white",padding:"4px 12px",borderRadius:"20px",fontSize:"13px",fontWeight:"500"},children:Be.name})]})]}),Array.isArray(ze[Be._id])&&ze[Be._id].length>0&&(0,s.jsxs)("div",{style:{background:"white",padding:"8px 16px",borderRadius:"20px",fontWeight:"600",color:"#667eea",fontSize:"14px",border:"2px solid #667eea"},children:[ze[Be._id].length," ",1===ze[Be._id].length?"sub-section":"sub-sections"]})]}),(0,s.jsx)("div",{style:{flex:1,overflowY:"auto",padding:"24px 32px"},children:Me[Be._id]?(0,s.jsxs)("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",padding:"40px 0",color:"#6b7280"},children:[(0,s.jsx)("div",{className:"spinner-border",role:"status",style:{width:40,height:40,marginBottom:16},children:(0,s.jsx)("span",{className:"visually-hidden",children:"Loading..."})}),(0,s.jsx)("div",{children:"Loading sub-sections..."})]}):De[Be._id]?(0,s.jsxs)("div",{style:{padding:"40px 20px",textAlign:"center",color:"#ef4444",display:"flex",flexDirection:"column",alignItems:"center",gap:"12px"},children:[(0,s.jsx)("i",{className:"bi bi-exclamation-triangle",style:{fontSize:"48px"}}),(0,s.jsx)("p",{style:{margin:0,fontSize:"15px"},children:De[Be._id]})]}):Array.isArray(ze[Be._id])&&ze[Be._id].length>0?(0,s.jsx)("div",{style:{background:"white",borderRadius:"12px",border:"2px solid #e5e7eb",overflow:"hidden",boxShadow:"0 2px 8px rgba(0, 0, 0, 0.05)"},children:(0,s.jsxs)("table",{style:{width:"100%",borderCollapse:"collapse",fontSize:"14px"},children:[(0,s.jsx)("thead",{children:(0,s.jsxs)("tr",{style:{background:"linear-gradient(135deg, #667eea 0%, #764ba2 100%)",color:"white"},children:[(0,s.jsx)("th",{style:{padding:"16px 20px",textAlign:"left",fontWeight:"700",fontSize:"13px",textTransform:"uppercase",letterSpacing:"0.5px"},children:"Sub-Section Name"}),(0,s.jsx)("th",{style:{padding:"16px 20px",textAlign:"left",fontWeight:"700",fontSize:"13px",textTransform:"uppercase",letterSpacing:"0.5px"},children:"Code"}),(0,s.jsx)("th",{style:{padding:"16px 20px",textAlign:"left",fontWeight:"700",fontSize:"13px",textTransform:"uppercase",letterSpacing:"0.5px"},children:"Created Date"}),(0,s.jsx)("th",{style:{padding:"16px 20px",textAlign:"center",fontWeight:"700",fontSize:"13px",textTransform:"uppercase",letterSpacing:"0.5px"},children:"Transferring"}),(0,s.jsx)("th",{style:{padding:"16px 20px",textAlign:"center",fontWeight:"700",fontSize:"13px",textTransform:"uppercase",letterSpacing:"0.5px"},children:"Actions"})]})}),(0,s.jsx)("tbody",{children:ze[Be._id].map((e,i)=>{var o,n,t,l,r,d;return(0,s.jsxs)("tr",{style:{borderBottom:i<ze[Be._id].length-1?"1px solid #e5e7eb":"none",transition:"all 0.2s ease"},onMouseOver:e=>{e.currentTarget.style.background="#f9fafb"},onMouseOut:e=>{e.currentTarget.style.background="transparent"},children:[(0,s.jsx)("td",{style:{padding:"12px 20px",fontWeight:"600",color:"#1f2937"},children:(null===e||void 0===e||null===(o=e.subSection)||void 0===o?void 0:o.sub_hie_name)||(null===e||void 0===e||null===(n=e.subSection)||void 0===n?void 0:n.hie_name)||(null===e||void 0===e||null===(t=e.subSection)||void 0===t?void 0:t.name)||"-"}),(0,s.jsx)("td",{style:{padding:"12px 20px"},children:(0,s.jsx)("span",{style:{fontFamily:"monospace",color:"#667eea",background:"#eef2ff",padding:"4px 10px",borderRadius:6,fontSize:"13px",fontWeight:"600",display:"inline-block"},children:(null===e||void 0===e||null===(l=e.subSection)||void 0===l?void 0:l.sub_hie_code)||(null===e||void 0===e||null===(r=e.subSection)||void 0===r?void 0:r.hie_code)||(null===e||void 0===e||null===(d=e.subSection)||void 0===d?void 0:d.code)||"-"})}),(0,s.jsx)("td",{style:{padding:"12px 20px",color:"#6b7280"},children:(0,s.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[(0,s.jsx)("i",{className:"bi bi-calendar3"}),null!==e&&void 0!==e&&e.createdAt?Zi(new Date(e.createdAt)):"\u2014"]})}),(0,s.jsx)("td",{style:{padding:"12px 20px",textAlign:"center"},children:(0,s.jsxs)("div",{style:{display:"flex",alignItems:"center",justifyContent:"center",gap:6},children:[Vi?(0,s.jsx)("button",{className:"btn-professional",onClick:()=>(async e=>{if(Vi){oi(e),Ve(!0),Ge(new Set),ei(!0),Ke([]);try{var i,o,n,t,l,r,s,d,a,c,p,u;const x=localStorage.getItem("token");if(!x)throw new Error("No authentication token");const v=await eo(e._id,x),g=e=>void 0===e||null===e?"":String(e).trim().toLowerCase(),h=(e,i)=>{const o=g(i);return!!o&&(e||[]).some(e=>{const i=g(e);return i&&(i===o||i.includes(o)||o.includes(i))})},m=(null===e||void 0===e||null===(i=e.parentDivision)||void 0===i?void 0:i.division_code)||(null===e||void 0===e||null===(o=e.parentDivision)||void 0===o?void 0:o.divisionCode)||(null===e||void 0===e||null===(n=e.parentDivision)||void 0===n?void 0:n.code)||"",b=(null===e||void 0===e||null===(t=e.parentDivision)||void 0===t?void 0:t.division_name)||(null===e||void 0===e||null===(l=e.parentDivision)||void 0===l?void 0:l.divisionName)||(null===e||void 0===e||null===(r=e.parentDivision)||void 0===r?void 0:r.name)||"",f=(null===e||void 0===e||null===(s=e.parentSection)||void 0===s?void 0:s.hie_code)||(null===e||void 0===e||null===(d=e.parentSection)||void 0===d?void 0:d.hieCode)||(null===e||void 0===e||null===(a=e.parentSection)||void 0===a?void 0:a.code)||"",y=(null===e||void 0===e||null===(c=e.parentSection)||void 0===c?void 0:c.hie_name)||(null===e||void 0===e||null===(p=e.parentSection)||void 0===p?void 0:p.hieName)||(null===e||void 0===e||null===(u=e.parentSection)||void 0===u?void 0:u.name)||"";console.log("\ud83d\udd0d Fetching employees from cache for (relaxed match):",{divisionCode:m,divisionName:b,sectionCode:f,sectionName:y});const S=await fetch(`${Gi}/hris-cache/employees`,{method:"GET",headers:{Authorization:`Bearer ${x}`,"Content-Type":"application/json"},credentials:"include"});if(!S.ok)throw new Error(`HTTP ${S.status}`);const j=await S.json(),_=(null===j||void 0===j?void 0:j.data)||j||[];console.log("\ud83d\udcca Fetched from cache - Total employees:",_.length);const w=e=>{var i,o,n,t,l,r,s;return[null===e||void 0===e?void 0:e.HIE_CODE_4,null===e||void 0===e?void 0:e.hie_code_4,null===e||void 0===e?void 0:e.DIVISION_CODE,null===e||void 0===e?void 0:e.division_code,null===e||void 0===e?void 0:e.divisionCode,null===e||void 0===e||null===(i=e.currentwork)||void 0===i?void 0:i.HIE_CODE_4,null===e||void 0===e||null===(o=e.currentwork)||void 0===o?void 0:o.DIVISION_CODE,null===e||void 0===e||null===(n=e.currentwork)||void 0===n?void 0:n.division_code,null===e||void 0===e||null===(t=e.currentwork)||void 0===t?void 0:t.divisionCode,null===e||void 0===e?void 0:e.HIE_NAME_3,null===e||void 0===e?void 0:e.hie_name_3,null===e||void 0===e?void 0:e.DIVISION_NAME,null===e||void 0===e?void 0:e.division_name,null===e||void 0===e?void 0:e.divisionName,null===e||void 0===e||null===(l=e.currentwork)||void 0===l?void 0:l.HIE_NAME_3,null===e||void 0===e||null===(r=e.currentwork)||void 0===r?void 0:r.DIVISION_NAME,null===e||void 0===e||null===(s=e.currentwork)||void 0===s?void 0:s.division_name].filter(Boolean)},N=e=>{var i,o,n,t,l,r,s;return[null===e||void 0===e?void 0:e.HIE_CODE_3,null===e||void 0===e?void 0:e.hie_code_3,null===e||void 0===e?void 0:e.SECTION_CODE,null===e||void 0===e?void 0:e.section_code,null===e||void 0===e?void 0:e.sectionCode,null===e||void 0===e||null===(i=e.currentwork)||void 0===i?void 0:i.HIE_CODE_3,null===e||void 0===e||null===(o=e.currentwork)||void 0===o?void 0:o.SECTION_CODE,null===e||void 0===e||null===(n=e.currentwork)||void 0===n?void 0:n.section_code,null===e||void 0===e||null===(t=e.currentwork)||void 0===t?void 0:t.sectionCode,null===e||void 0===e?void 0:e.HIE_NAME_4,null===e||void 0===e?void 0:e.hie_name_4,null===e||void 0===e?void 0:e.SECTION_NAME,null===e||void 0===e?void 0:e.section_name,null===e||void 0===e?void 0:e.sectionName,null===e||void 0===e||null===(l=e.currentwork)||void 0===l?void 0:l.HIE_NAME_4,null===e||void 0===e||null===(r=e.currentwork)||void 0===r?void 0:r.SECTION_NAME,null===e||void 0===e||null===(s=e.currentwork)||void 0===s?void 0:s.section_name].filter(Boolean)};let C=_.filter(e=>{const i=w(e),o=N(e),n=m&&h(i,m)||b&&h(i,b),t=f&&h(o,f)||y&&h(o,y);return n&&t});0===C.length&&(console.warn("No employees found with strict matching; trying relaxed matching (partial / name-based)"),C=_.filter(e=>{const i=w(e),o=N(e),n=m?h(i,m)||h([m],i.join(" ")):!!b&&h(i,b),t=f?h(o,f)||h([f],o.join(" ")):!!y&&h(o,y);return(n||!m&&b&&h(i,b))&&(t||!f&&y&&h(o,y))})),console.log("\u2705 Filtered employees (after relaxed matching):",C.length);const k=C.filter(i=>{const o=String((null===i||void 0===i?void 0:i.EMP_NUMBER)||(null===i||void 0===i?void 0:i.empNumber)||(null===i||void 0===i?void 0:i.EMP_ID)||(null===i||void 0===i?void 0:i.emp_id)||""),n=(v||[]).some(i=>String(i.employeeId)===o&&String(i.sub_section_id)===String(e._id)),t=(ai||[]).some(i=>String(i.employeeId)===o&&String(i.sub_section_id)===String(e._id));return!n&&!t});console.log("\u2705 Not transferred employees (after filtering):",k.length);const I=k.filter(ro);console.log("\ud83c\udfaf Active not-transferred employees:",I.length,"(filtered out:",k.length-I.length,")"),Ke(I),ei(!1)}catch(x){console.error("Error fetching employees:",x),ei(!1),Ji({type:"error",title:"Error",message:"Failed to fetch employees from HRIS API"})}}else Ji({type:"error",title:"Permission",message:"You do not have permission to transfer employees."})})(e),style:{padding:"6px 8px",fontSize:13,display:"flex",alignItems:"center",justifyContent:"center",minWidth:"32px",minHeight:"32px",backgroundColor:"#10b981",color:"white",border:"none"},title:"Add Employee - Shows all not-transferred employees",children:(0,s.jsx)("i",{className:"bi bi-person-plus"})}):null,qi?(0,s.jsx)("button",{className:"btn-professional",onClick:()=>to(e),style:{padding:"6px 8px",fontSize:13,display:"flex",alignItems:"center",justifyContent:"center",minWidth:"32px",minHeight:"32px",backgroundColor:"#f59e0b",color:"white",border:"none"},title:"Recall - Shows all transferred employees",children:(0,s.jsx)("i",{className:"bi bi-arrow-counterclockwise"})}):null]})}),(0,s.jsx)("td",{style:{padding:"12px 20px",textAlign:"center"},children:(0,s.jsxs)("div",{style:{display:"flex",alignItems:"center",justifyContent:"center",gap:6},children:[Hi?(0,s.jsx)("button",{className:"btn-professional btn-primary",onClick:()=>((e,i)=>{var o,n,t,l,r,s;const d=ao(null===Be||void 0===Be?void 0:Be.division),a=(null===Be||void 0===Be?void 0:Be.name)||"N/A";ve({sectionId:e,subSection:i,parentDivision:d,parentSection:a}),he({name:(null===i||void 0===i||null===(o=i.subSection)||void 0===o?void 0:o.sub_hie_name)||(null===i||void 0===i||null===(n=i.subSection)||void 0===n?void 0:n.hie_name)||(null===i||void 0===i||null===(t=i.subSection)||void 0===t?void 0:t.name)||"",code:(null===i||void 0===i||null===(l=i.subSection)||void 0===l?void 0:l.sub_hie_code)||(null===i||void 0===i||null===(r=i.subSection)||void 0===r?void 0:r.hie_code)||(null===i||void 0===i||null===(s=i.subSection)||void 0===s?void 0:s.code)||""}),ye({}),ue(!0)})(Be._id,e),style:{padding:"6px 8px",fontSize:13,display:"flex",alignItems:"center",justifyContent:"center",minWidth:"32px",minHeight:"32px"},title:"Edit Sub-Section",children:(0,s.jsx)("i",{className:"bi bi-pencil"})}):null,Yi?(0,s.jsx)("button",{className:"btn-professional btn-danger",onClick:()=>{return i=Be._id,o=e._id,He({sectionId:i,subSectionId:o}),void Fe(!0);var i,o},style:{padding:"6px 8px",fontSize:13,display:"flex",alignItems:"center",justifyContent:"center",minWidth:"32px",minHeight:"32px"},title:"Delete Sub-Section",children:(0,s.jsx)("i",{className:"bi bi-trash"})}):null]})})]},e._id)})})]})}):(0,s.jsxs)("div",{style:{padding:"40px 20px",textAlign:"center",color:"#6b7280",display:"flex",flexDirection:"column",alignItems:"center",gap:"12px"},children:[(0,s.jsx)("i",{className:"bi bi-inbox",style:{fontSize:"48px",opacity:.5}}),(0,s.jsxs)("p",{style:{margin:0,fontSize:"15px"},children:["No sub-sections yet. Click the ",(0,s.jsx)("strong",{children:"+"})," button to create one."]})]})})]})}),$e&&(0,s.jsx)("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(0, 0, 0, 0.7)",backdropFilter:"blur(10px)",WebkitBackdropFilter:"blur(10px)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:11e3,padding:"20px"},onClick:no,children:(0,s.jsxs)("div",{style:{backgroundColor:"white",borderRadius:"16px",boxShadow:"0 20px 60px rgba(0, 0, 0, 0.4)",width:"90%",maxWidth:"500px",overflow:"hidden",animation:"slideIn 0.3s ease-out"},onClick:e=>e.stopPropagation(),children:[(0,s.jsxs)("div",{style:{padding:"24px 28px",background:"linear-gradient(135deg, #ef4444 0%, #dc2626 100%)",color:"white",display:"flex",alignItems:"center",gap:"12px"},children:[(0,s.jsx)("i",{className:"bi bi-exclamation-triangle-fill",style:{fontSize:"28px"}}),(0,s.jsx)("h3",{style:{fontSize:"22px",fontWeight:"700",margin:0},children:"Confirm Deletion"})]}),(0,s.jsx)("div",{style:{padding:"28px"},children:(0,s.jsx)("p",{style:{fontSize:"16px",color:"#374151",margin:0,lineHeight:"1.6"},children:"Are you sure you want to delete this sub-section? This action cannot be undone."})}),(0,s.jsxs)("div",{style:{padding:"20px 28px",borderTop:"1px solid #e5e7eb",background:"#f9fafb",display:"flex",justifyContent:"flex-end",gap:"12px"},children:[(0,s.jsxs)("button",{onClick:no,style:{padding:"12px 24px",border:"2px solid #d1d5db",borderRadius:"8px",backgroundColor:"white",color:"#6b7280",fontSize:"14px",fontWeight:"600",cursor:"pointer",transition:"all 0.2s ease"},onMouseOver:e=>{e.target.style.borderColor="#9ca3af",e.target.style.color="#374151"},onMouseOut:e=>{e.target.style.borderColor="#d1d5db",e.target.style.color="#6b7280"},children:[(0,s.jsx)("i",{className:"bi bi-x-circle",style:{marginRight:"8px"}}),"Cancel"]}),(0,s.jsxs)("button",{onClick:async()=>{if(!Ue)return;if(!Yi)return Fe(!1),He(null),Ji({type:"error",title:"Permission",message:"You do not have permission to delete sub-sections."});const{sectionId:e,subSectionId:i}=Ue,o=localStorage.getItem("token");if(!o)return Fe(!1),He(null),Ji({type:"error",title:"Auth",message:"Token missing. Please login."});try{const n=await fetch(`${Gi}/mysql-subsections/${i}`,{method:"DELETE",headers:{Authorization:`Bearer ${o}`},credentials:"include"});if(!n.ok)throw new Error(`HTTP ${n.status}`);Fe(!1),He(null),setTimeout(()=>{Ji({type:"success",title:"Success!",message:"Sub-section deleted successfully."})},150),await Qi(e,{force:!0})}catch(n){console.error("Delete sub-section failed:",n),Fe(!1),He(null),setTimeout(()=>{Ji({type:"error",title:"Failed",message:"Could not delete sub-section."})},150)}},style:{padding:"12px 24px",border:"none",borderRadius:"8px",background:"linear-gradient(135deg, #ef4444 0%, #dc2626 100%)",color:"white",fontSize:"14px",fontWeight:"600",cursor:"pointer",transition:"all 0.2s ease",boxShadow:"0 3px 10px rgba(239, 68, 68, 0.3)"},onMouseOver:e=>{e.target.style.transform="translateY(-1px)",e.target.style.boxShadow="0 4px 15px rgba(239, 68, 68, 0.4)"},onMouseOut:e=>{e.target.style.transform="translateY(0)",e.target.style.boxShadow="0 3px 10px rgba(239, 68, 68, 0.3)"},children:[(0,s.jsx)("i",{className:"bi bi-trash",style:{marginRight:"8px"}}),"Delete"]})]})]})}),Ye&&(0,s.jsx)("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(0, 0, 0, 0.5)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:1e4,padding:"20px"},children:(0,s.jsxs)("div",{style:{background:"white",borderRadius:"16px",maxWidth:"1000px",width:"100%",maxHeight:"90vh",display:"flex",flexDirection:"column",boxShadow:"0 20px 60px rgba(0, 0, 0, 0.3)",overflow:"hidden"},children:[(0,s.jsxs)("div",{style:{background:"linear-gradient(135deg, #667eea 0%, #764ba2 100%)",padding:"24px 32px",display:"flex",alignItems:"center",justifyContent:"space-between"},children:[(0,s.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"12px"},children:[(0,s.jsx)("i",{className:"bi bi-people-fill",style:{fontSize:"24px",color:"white"}}),(0,s.jsxs)("h2",{style:{margin:0,color:"white",fontSize:"20px",fontWeight:"600"},children:["Employee List - ",(null===ii||void 0===ii||null===(u=ii.subSection)||void 0===u?void 0:u.sub_hie_name)||(null===ii||void 0===ii||null===(x=ii.subSection)||void 0===x?void 0:x.hie_name)||"Sub-Section"]})]}),(0,s.jsx)("button",{onClick:()=>{Ve(!1),oi(null),Ke([]),Ri(""),Ge(new Set),Ze(!1)},style:{background:"rgba(255, 255, 255, 0.2)",border:"none",borderRadius:"8px",width:"36px",height:"36px",display:"flex",alignItems:"center",justifyContent:"center",cursor:"pointer",transition:"all 0.2s ease",color:"white",fontSize:"20px"},onMouseOver:e=>e.target.style.background="rgba(255, 255, 255, 0.3)",onMouseOut:e=>e.target.style.background="rgba(255, 255, 255, 0.2)",children:(0,s.jsx)("i",{className:"bi bi-x"})})]}),(0,s.jsxs)("div",{style:{background:"linear-gradient(135deg, #667eea15 0%, #764ba215 100%)",border:"2px solid #667eea",borderRadius:"8px",padding:"16px 20px",margin:"16px 32px",display:"flex",alignItems:"center",gap:"12px"},children:[(0,s.jsx)("i",{className:"bi bi-funnel-fill",style:{color:"#667eea",fontSize:"20px"}}),(0,s.jsxs)("div",{style:{flex:1},children:[(0,s.jsx)("div",{style:{fontWeight:"600",color:"#495057",marginBottom:"4px"},children:"Active Filters:"}),(0,s.jsxs)("div",{style:{display:"flex",alignItems:"center",flexWrap:"wrap",gap:"8px"},children:[(0,s.jsx)("span",{style:{background:"#667eea",color:"white",padding:"4px 12px",borderRadius:"20px",fontSize:"13px",fontWeight:"500"},children:(null===ii||void 0===ii||null===(v=ii.parentDivision)||void 0===v?void 0:v.division_name)||"N/A"}),(0,s.jsx)("i",{className:"bi bi-chevron-right",style:{color:"#667eea"}}),(0,s.jsx)("span",{style:{background:"#764ba2",color:"white",padding:"4px 12px",borderRadius:"20px",fontSize:"13px",fontWeight:"500"},children:(null===ii||void 0===ii||null===(g=ii.parentSection)||void 0===g?void 0:g.hie_name)||"N/A"}),(0,s.jsx)("i",{className:"bi bi-chevron-right",style:{color:"#667eea"}}),(0,s.jsx)("span",{style:{background:"#f093fb",color:"white",padding:"4px 12px",borderRadius:"20px",fontSize:"13px",fontWeight:"500"},children:(null===ii||void 0===ii||null===(h=ii.subSection)||void 0===h?void 0:h.sub_hie_name)||(null===ii||void 0===ii||null===(m=ii.subSection)||void 0===m?void 0:m.hie_name)||"Sub-Section"})]})]})]}),(0,s.jsx)("div",{style:{padding:"16px 32px",borderBottom:"1px solid #e5e7eb",background:"#f9fafb"},children:(0,s.jsxs)("div",{style:{position:"relative"},children:[(0,s.jsx)("i",{className:"bi bi-search",style:{position:"absolute",left:"14px",top:"50%",transform:"translateY(-50%)",color:"#9ca3af",fontSize:"16px"}}),(0,s.jsx)("input",{type:"text",placeholder:"Search by Employee ID or Name...",value:Mi,onChange:e=>Ri(e.target.value),style:{width:"100%",padding:"12px 16px 12px 42px",border:"2px solid #e5e7eb",borderRadius:"8px",fontSize:"14px",outline:"none",transition:"all 0.2s ease"},onFocus:e=>{e.target.style.borderColor="#667eea",e.target.style.boxShadow="0 0 0 3px rgba(102, 126, 234, 0.1)"},onBlur:e=>{e.target.style.borderColor="#e5e7eb",e.target.style.boxShadow="none"}}),(0,s.jsxs)("div",{style:{marginTop:"8px",color:"#6b7280",fontSize:"13px"},children:["Showing ",(0,s.jsx)("strong",{children:"active"})," employees only"]})]})}),(0,s.jsx)("div",{style:{padding:"24px 32px",flex:1,overflow:"auto"},children:Xe?(0,s.jsxs)("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",padding:"60px 20px",gap:"16px"},children:[(0,s.jsx)("div",{className:"spinner-border",role:"status",style:{color:"#667eea"},children:(0,s.jsx)("span",{className:"visually-hidden",children:"Loading..."})}),(0,s.jsx)("p",{style:{color:"#6b7280",margin:0},children:"Loading employees from HRIS..."})]}):(()=>{const e=Qe.filter(e=>{if(!Mi.trim())return!0;const i=Mi.toLowerCase().trim(),o=String((null===e||void 0===e?void 0:e.EMP_NUMBER)||(null===e||void 0===e?void 0:e.empNumber)||(null===e||void 0===e?void 0:e.EMP_ID)||(null===e||void 0===e?void 0:e.emp_id)||"").toLowerCase(),n=String((null===e||void 0===e?void 0:e.FULLNAME)||(null===e||void 0===e?void 0:e.fullName)||(null===e||void 0===e?void 0:e.CALLING_NAME)||(null===e||void 0===e?void 0:e.calling_name)||(null===e||void 0===e?void 0:e.name)||"").toLowerCase();return o.includes(i)||n.includes(i)});return 0===e.length?(0,s.jsxs)("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",padding:"60px 20px",gap:"12px"},children:[(0,s.jsx)("i",{className:"bi bi-person-x",style:{fontSize:"48px",color:"#d1d5db"}}),(0,s.jsx)("p",{style:{color:"#6b7280",margin:0,fontSize:"16px"},children:Mi?"No employees match your search":"No employees found for this division and section"})]}):(0,s.jsx)("div",{style:{border:"1px solid #e5e7eb",borderRadius:"12px",overflow:"hidden"},children:(0,s.jsxs)("table",{style:{width:"100%",borderCollapse:"collapse"},children:[(0,s.jsx)("thead",{children:(0,s.jsxs)("tr",{style:{background:"linear-gradient(135deg, #667eea 0%, #764ba2 100%)"},children:[(0,s.jsx)("th",{style:{padding:"14px 16px",width:"40px",textAlign:"center"},children:(0,s.jsx)("input",{type:"checkbox",checked:(()=>{try{const e=Qe.filter(e=>{if(!Mi.trim())return!0;const i=Mi.toLowerCase().trim(),o=String((null===e||void 0===e?void 0:e.EMP_NUMBER)||(null===e||void 0===e?void 0:e.empNumber)||(null===e||void 0===e?void 0:e.EMP_ID)||(null===e||void 0===e?void 0:e.emp_id)||"").toLowerCase(),n=String((null===e||void 0===e?void 0:e.FULLNAME)||(null===e||void 0===e?void 0:e.fullName)||(null===e||void 0===e?void 0:e.CALLING_NAME)||(null===e||void 0===e?void 0:e.calling_name)||(null===e||void 0===e?void 0:e.name)||"").toLowerCase();return o.includes(i)||n.includes(i)});return e.length>0&&qe.size===e.length}catch(e){return!1}})(),onChange:e=>{((e,i)=>{if(e){const e=new Set((i||Qe).map(e=>String((null===e||void 0===e?void 0:e.EMP_NUMBER)||(null===e||void 0===e?void 0:e.empNumber)||(null===e||void 0===e?void 0:e.EMP_ID)||(null===e||void 0===e?void 0:e.emp_id)||"")));Ge(e)}else Ge(new Set)})(!!e.target.checked,Qe.filter(e=>{if(!Mi.trim())return!0;const i=Mi.toLowerCase().trim(),o=String((null===e||void 0===e?void 0:e.EMP_NUMBER)||(null===e||void 0===e?void 0:e.empNumber)||(null===e||void 0===e?void 0:e.EMP_ID)||(null===e||void 0===e?void 0:e.emp_id)||"").toLowerCase(),n=String((null===e||void 0===e?void 0:e.FULLNAME)||(null===e||void 0===e?void 0:e.fullName)||(null===e||void 0===e?void 0:e.CALLING_NAME)||(null===e||void 0===e?void 0:e.calling_name)||(null===e||void 0===e?void 0:e.name)||"").toLowerCase();return o.includes(i)||n.includes(i)}))},title:"Select all visible employees"})}),(0,s.jsx)("th",{style:{padding:"14px 16px",textAlign:"left",color:"white",fontWeight:"600",fontSize:"13px"},children:"EMPLOYEE ID"}),(0,s.jsx)("th",{style:{padding:"14px 16px",textAlign:"left",color:"white",fontWeight:"600",fontSize:"13px"},children:"NAME"}),(0,s.jsx)("th",{style:{padding:"14px 16px",textAlign:"center",color:"white",fontWeight:"600",fontSize:"13px"},children:"STATUS"}),(0,s.jsx)("th",{style:{padding:"14px 16px",textAlign:"center",color:"white",fontWeight:"600",fontSize:"13px"},children:"ACTION"})]})}),(0,s.jsx)("tbody",{children:e.map((i,o)=>{const n=(null===i||void 0===i?void 0:i.EMP_NUMBER)||(null===i||void 0===i?void 0:i.empNumber)||(null===i||void 0===i?void 0:i.EMP_ID)||(null===i||void 0===i?void 0:i.emp_id);return(0,s.jsxs)("tr",{style:{borderBottom:o<e.length-1?"1px solid #e5e7eb":"none",transition:"all 0.2s ease"},onMouseOver:e=>e.currentTarget.style.background="#f9fafb",onMouseOut:e=>e.currentTarget.style.background="transparent",children:[(0,s.jsx)("td",{style:{padding:"12px 10px",textAlign:"center"},children:(0,s.jsx)("input",{type:"checkbox",checked:qe.has(String(n)),onChange:()=>(e=>{const i=String((null===e||void 0===e?void 0:e.EMP_NUMBER)||(null===e||void 0===e?void 0:e.empNumber)||(null===e||void 0===e?void 0:e.EMP_ID)||(null===e||void 0===e?void 0:e.emp_id)||"");Ge(e=>{const o=new Set(Array.from(e));return o.has(i)?o.delete(i):o.add(i),o})})(i),title:"Select employee for bulk transfer"})}),(0,s.jsx)("td",{style:{padding:"12px 16px",fontSize:"14px",color:"#1f2937",fontWeight:"600"},children:n||"N/A"}),(0,s.jsx)("td",{style:{padding:"12px 16px",fontSize:"14px",color:"#1f2937"},children:(null===i||void 0===i?void 0:i.FULLNAME)||(null===i||void 0===i?void 0:i.fullName)||(null===i||void 0===i?void 0:i.CALLING_NAME)||(null===i||void 0===i?void 0:i.calling_name)||(null===i||void 0===i?void 0:i.name)||"N/A"}),(0,s.jsx)("td",{style:{padding:"12px 16px",textAlign:"center"},children:(()=>{const e=1===(null===i||void 0===i?void 0:i.ACTIVE_HRM_FLG)||"ACTIVE"===(null===i||void 0===i?void 0:i.STATUS)||"ACTIVE"===(null===i||void 0===i?void 0:i.status)||!0===(null===i||void 0===i?void 0:i.isActive);return(0,s.jsx)("span",{style:{padding:"4px 12px",borderRadius:"12px",fontSize:"12px",fontWeight:"600",background:e?"#dcfce7":"#fee2e2",color:e?"#16a34a":"#dc2626",display:"inline-block"},children:e?"Active":"Inactive"})})()}),(0,s.jsx)("td",{style:{padding:"12px 16px",textAlign:"center"},children:(0,s.jsxs)("button",{onClick:()=>(ri(i),void ti(!0)),style:{padding:"8px 16px",border:"none",borderRadius:"6px",background:"linear-gradient(135deg, #667eea 0%, #764ba2 100%)",color:"white",fontSize:"13px",fontWeight:"600",cursor:"pointer",transition:"all 0.2s ease",display:"inline-flex",alignItems:"center",gap:"6px"},onMouseOver:e=>{e.currentTarget.style.transform="translateY(-1px)",e.currentTarget.style.boxShadow="0 4px 12px rgba(102, 126, 234, 0.4)"},onMouseOut:e=>{e.currentTarget.style.transform="translateY(0)",e.currentTarget.style.boxShadow="none"},title:"Transfer employee to this sub-section",children:[(0,s.jsx)("i",{className:"bi bi-arrow-left-right"}),"Transfer"]})})]},n||o)})})]})})})()}),(0,s.jsxs)("div",{style:{padding:"20px 32px",borderTop:"1px solid #e5e7eb",background:"#f9fafb",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[(0,s.jsx)("div",{style:{fontSize:"14px",color:"#6b7280"},children:(()=>{const e=Qe.filter(e=>{if(!Mi.trim())return!0;const i=Mi.toLowerCase().trim(),o=String((null===e||void 0===e?void 0:e.EMP_NUMBER)||(null===e||void 0===e?void 0:e.empNumber)||(null===e||void 0===e?void 0:e.EMP_ID)||(null===e||void 0===e?void 0:e.emp_id)||"").toLowerCase(),n=String((null===e||void 0===e?void 0:e.FULLNAME)||(null===e||void 0===e?void 0:e.fullName)||(null===e||void 0===e?void 0:e.CALLING_NAME)||(null===e||void 0===e?void 0:e.calling_name)||(null===e||void 0===e?void 0:e.name)||"").toLowerCase();return o.includes(i)||n.includes(i)}).length;return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("strong",{style:{color:"#1f2937"},children:e})," employee",1!==e?"s":""," found",Mi&&e!==Qe.length&&(0,s.jsxs)("span",{style:{marginLeft:"8px",color:"#9ca3af"},children:["(filtered from ",Qe.length,")"]})]})})()}),(0,s.jsx)("button",{onClick:()=>Ze(!0),disabled:0===qe.size,style:{padding:"10px 24px",border:"none",borderRadius:"8px",background:0===qe.size?"#d1d5db":"linear-gradient(135deg, #667eea 0%, #764ba2 100%)",color:"white",fontSize:"14px",fontWeight:"600",cursor:0===qe.size?"not-allowed":"pointer",transition:"all 0.2s ease",marginLeft:"12px"},children:"Transfer Selected"})]})]})}),ni&&li&&ii&&(0,s.jsx)("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(0, 0, 0, 0.5)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:10001,padding:"20px"},children:(0,s.jsxs)("div",{style:{background:"white",borderRadius:"16px",maxWidth:"550px",width:"100%",boxShadow:"0 20px 60px rgba(0, 0, 0, 0.3)",overflow:"hidden"},children:[(0,s.jsxs)("div",{style:{background:"linear-gradient(135deg, #667eea 0%, #764ba2 100%)",padding:"24px 32px",display:"flex",alignItems:"center",gap:"12px"},children:[(0,s.jsx)("i",{className:"bi bi-arrow-left-right-circle",style:{fontSize:"28px",color:"white"}}),(0,s.jsx)("h3",{style:{margin:0,color:"white",fontSize:"20px",fontWeight:"600"},children:"Confirm Transfer"})]}),(0,s.jsxs)("div",{style:{padding:"32px"},children:[(0,s.jsxs)("div",{style:{background:"#f9fafb",borderRadius:"12px",padding:"20px",marginBottom:"24px",border:"2px solid #e5e7eb"},children:[(0,s.jsx)("div",{style:{fontSize:"16px",color:"#374151",marginBottom:"20px",lineHeight:"1.6"},children:"Are you sure you want to transfer this employee?"}),(0,s.jsxs)("div",{style:{background:"white",borderRadius:"8px",padding:"16px",marginBottom:"16px",border:"1px solid #e5e7eb"},children:[(0,s.jsx)("div",{style:{fontSize:"12px",color:"#6b7280",marginBottom:"4px"},children:"Employee"}),(0,s.jsx)("div",{style:{fontSize:"16px",color:"#1f2937",fontWeight:"600"},children:(null===li||void 0===li?void 0:li.FULLNAME)||(null===li||void 0===li?void 0:li.fullName)||(null===li||void 0===li?void 0:li.CALLING_NAME)||"N/A"}),(0,s.jsxs)("div",{style:{fontSize:"13px",color:"#667eea",marginTop:"4px"},children:["ID: ",(null===li||void 0===li?void 0:li.EMP_NUMBER)||(null===li||void 0===li?void 0:li.empNumber)||"N/A"]})]}),(0,s.jsxs)("div",{style:{background:"white",borderRadius:"8px",padding:"16px",border:"1px solid #e5e7eb"},children:[(0,s.jsxs)("div",{style:{fontSize:"12px",color:"#6b7280",marginBottom:"8px"},children:[(0,s.jsx)("i",{className:"bi bi-arrow-down"})," Transferring to:"]}),(0,s.jsxs)("div",{style:{marginLeft:"16px"},children:[(0,s.jsxs)("div",{style:{fontSize:"14px",color:"#1f2937",marginBottom:"6px"},children:[(0,s.jsx)("strong",{children:"Sub-Section:"})," ",(null===ii||void 0===ii||null===(b=ii.subSection)||void 0===b?void 0:b.sub_hie_name)||(null===ii||void 0===ii||null===(f=ii.subSection)||void 0===f?void 0:f.hie_name)||"N/A"]}),(0,s.jsxs)("div",{style:{fontSize:"13px",color:"#6b7280",marginBottom:"4px"},children:[(0,s.jsx)("strong",{children:"Section:"})," ",(null===ii||void 0===ii||null===(y=ii.parentSection)||void 0===y?void 0:y.hie_name)||"N/A"]}),(0,s.jsxs)("div",{style:{fontSize:"13px",color:"#6b7280"},children:[(0,s.jsx)("strong",{children:"Division:"})," ",(null===ii||void 0===ii||null===(S=ii.parentDivision)||void 0===S?void 0:S.division_name)||"N/A"]})]})]})]}),(0,s.jsxs)("div",{style:{display:"flex",gap:"12px",justifyContent:"flex-end"},children:[(0,s.jsxs)("button",{onClick:()=>{ti(!1),ri(null)},disabled:si,style:{padding:"12px 24px",border:"2px solid #d1d5db",borderRadius:"8px",backgroundColor:"white",color:"#6b7280",fontSize:"14px",fontWeight:"600",cursor:si?"not-allowed":"pointer",transition:"all 0.2s ease",opacity:si?.5:1},onMouseOver:e=>{si||(e.target.style.borderColor="#9ca3af",e.target.style.color="#374151")},onMouseOut:e=>{si||(e.target.style.borderColor="#d1d5db",e.target.style.color="#6b7280")},children:[(0,s.jsx)("i",{className:"bi bi-x-circle",style:{marginRight:"8px"}}),"Cancel"]}),(0,s.jsx)("button",{onClick:async()=>{if(!Vi)return ti(!1),ri(null),Ji({type:"error",title:"Permission",message:"You do not have permission to transfer employees."});if(!li||!ii)return;di(!0);const e=localStorage.getItem("token");if(!e)return di(!1),ti(!1),Ji({type:"error",title:"Auth",message:"Token missing. Please login."});try{var i,o,n,t,l,r,s,d,a;const c={employeeId:String((null===li||void 0===li?void 0:li.EMP_NUMBER)||(null===li||void 0===li?void 0:li.empNumber)||(null===li||void 0===li?void 0:li.EMP_ID)||""),employeeName:(null===li||void 0===li?void 0:li.FULLNAME)||(null===li||void 0===li?void 0:li.fullName)||(null===li||void 0===li?void 0:li.CALLING_NAME)||"",division_code:(null===ii||void 0===ii||null===(i=ii.parentDivision)||void 0===i?void 0:i.division_code)||"",division_name:(null===ii||void 0===ii||null===(o=ii.parentDivision)||void 0===o?void 0:o.division_name)||"",hie_code:(null===ii||void 0===ii||null===(n=ii.parentSection)||void 0===n?void 0:n.hie_code)||"",hie_name:(null===ii||void 0===ii||null===(t=ii.parentSection)||void 0===t?void 0:t.hie_name)||"",sub_section_id:(null===ii||void 0===ii?void 0:ii._id)||"",sub_hie_code:(null===ii||void 0===ii||null===(l=ii.subSection)||void 0===l?void 0:l.sub_hie_code)||(null===ii||void 0===ii||null===(r=ii.subSection)||void 0===r?void 0:r.hie_code)||"",sub_hie_name:(null===ii||void 0===ii||null===(s=ii.subSection)||void 0===s?void 0:s.sub_hie_name)||(null===ii||void 0===ii||null===(d=ii.subSection)||void 0===d?void 0:d.hie_name)||"",transferredAt:(new Date).toISOString(),employeeData:li};console.log("\ud83d\udce4 Transferring employee:",c);const p=await fetch(`${Gi}/mysql-subsections/transfer`,{method:"POST",headers:{Authorization:`Bearer ${e}`,"Content-Type":"application/json"},credentials:"include",body:JSON.stringify(c)});if(!p.ok)throw new Error(`HTTP ${p.status}`);const u=await p.json();console.log("\u2705 Transfer successful - API response:",u);const x={employeeId:c.employeeId,sub_section_id:c.sub_section_id};ci(e=>[...e,x]),Ke(e=>e.filter(e=>String((null===e||void 0===e?void 0:e.EMP_NUMBER)||(null===e||void 0===e?void 0:e.empNumber)||(null===e||void 0===e?void 0:e.EMP_ID)||"")!==String(c.employeeId))),Ge(e=>{const i=new Set(Array.from(e));return i.has(String(c.employeeId))&&i.delete(String(c.employeeId)),i}),ti(!1),ri(null),di(!1),Ji({type:"success",title:"Success!",message:`Employee ${c.employeeName} has been successfully transferred to ${c.sub_hie_name}!`}),console.log("\u2705 Transfer complete - Record saved to DB with ID:",null===u||void 0===u||null===(a=u.data)||void 0===a?void 0:a._id)}catch(c){console.error("\u274c Transfer failed:",c),di(!1),ti(!1),Ji({type:"error",title:"Transfer Failed",message:"Failed to transfer employee. Please try again."})}},disabled:si,style:{padding:"12px 24px",border:"none",borderRadius:"8px",background:si?"#9ca3af":"linear-gradient(135deg, #667eea 0%, #764ba2 100%)",color:"white",fontSize:"14px",fontWeight:"600",cursor:si?"not-allowed":"pointer",transition:"all 0.2s ease",boxShadow:"0 3px 10px rgba(102, 126, 234, 0.3)",display:"flex",alignItems:"center",gap:"8px"},onMouseOver:e=>{si||(e.target.style.transform="translateY(-1px)",e.target.style.boxShadow="0 4px 15px rgba(102, 126, 234, 0.4)")},onMouseOut:e=>{si||(e.target.style.transform="translateY(0)",e.target.style.boxShadow="0 3px 10px rgba(102, 126, 234, 0.3)")},children:si?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("span",{className:"spinner-border spinner-border-sm",role:"status","aria-hidden":"true"}),"Transferring..."]}):(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("i",{className:"bi bi-check-circle"}),"Confirm Transfer"]})})]})]})]})}),mi&&(0,s.jsx)("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(0, 0, 0, 0.5)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:1e4,padding:"20px"},children:(0,s.jsxs)("div",{style:{background:"white",borderRadius:"16px",maxWidth:"1000px",width:"100%",maxHeight:"90vh",display:"flex",flexDirection:"column",boxShadow:"0 20px 60px rgba(0, 0, 0, 0.3)",overflow:"hidden"},children:[(0,s.jsxs)("div",{style:{background:"linear-gradient(135deg, #f59e0b 0%, #d97706 100%)",padding:"24px 32px",display:"flex",alignItems:"center",justifyContent:"space-between"},children:[(0,s.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"12px"},children:[(0,s.jsx)("i",{className:"bi bi-arrow-counterclockwise",style:{fontSize:"24px",color:"white"}}),(0,s.jsxs)("h2",{style:{margin:0,color:"white",fontSize:"20px",fontWeight:"600"},children:["Transferred Employees - ",(null===ii||void 0===ii||null===(j=ii.subSection)||void 0===j?void 0:j.sub_hie_name)||(null===ii||void 0===ii||null===(_=ii.subSection)||void 0===_?void 0:_.hie_name)||"Sub-Section"]})]}),(0,s.jsx)("button",{onClick:()=>{bi(!1),oi(null),Ci([]),Li(""),yi(new Set),ji(!1)},style:{background:"rgba(255, 255, 255, 0.2)",border:"none",borderRadius:"8px",width:"36px",height:"36px",display:"flex",alignItems:"center",justifyContent:"center",cursor:"pointer",transition:"all 0.2s ease",color:"white",fontSize:"20px"},onMouseOver:e=>e.target.style.background="rgba(255, 255, 255, 0.3)",onMouseOut:e=>e.target.style.background="rgba(255, 255, 255, 0.2)",children:(0,s.jsx)("i",{className:"bi bi-x"})})]}),(0,s.jsxs)("div",{style:{background:"linear-gradient(135deg, #667eea15 0%, #764ba215 100%)",border:"2px solid #667eea",borderRadius:"8px",padding:"16px 20px",margin:"16px 32px",display:"flex",alignItems:"center",gap:"12px"},children:[(0,s.jsx)("i",{className:"bi bi-funnel-fill",style:{color:"#667eea",fontSize:"20px"}}),(0,s.jsxs)("div",{style:{flex:1},children:[(0,s.jsx)("div",{style:{fontWeight:"600",color:"#495057",marginBottom:"4px"},children:"Active Filters:"}),(0,s.jsxs)("div",{style:{display:"flex",alignItems:"center",flexWrap:"wrap",gap:"8px"},children:[(0,s.jsx)("span",{style:{background:"#667eea",color:"white",padding:"4px 12px",borderRadius:"20px",fontSize:"13px",fontWeight:"500"},children:(null===ii||void 0===ii||null===(w=ii.parentDivision)||void 0===w?void 0:w.division_name)||"N/A"}),(0,s.jsx)("i",{className:"bi bi-chevron-right",style:{color:"#667eea"}}),(0,s.jsx)("span",{style:{background:"#764ba2",color:"white",padding:"4px 12px",borderRadius:"20px",fontSize:"13px",fontWeight:"500"},children:(null===ii||void 0===ii||null===(N=ii.parentSection)||void 0===N?void 0:N.hie_name)||"N/A"}),(0,s.jsx)("i",{className:"bi bi-chevron-right",style:{color:"#667eea"}}),(0,s.jsx)("span",{style:{background:"#f093fb",color:"white",padding:"4px 12px",borderRadius:"20px",fontSize:"13px",fontWeight:"500"},children:(null===ii||void 0===ii||null===(C=ii.subSection)||void 0===C?void 0:C.sub_hie_name)||(null===ii||void 0===ii||null===(k=ii.subSection)||void 0===k?void 0:k.hie_name)||"Sub-Section"})]})]})]}),(0,s.jsx)("div",{style:{padding:"16px 32px",borderBottom:"1px solid #e5e7eb",background:"#fef3c7"},children:(0,s.jsxs)("div",{style:{position:"relative"},children:[(0,s.jsx)("i",{className:"bi bi-search",style:{position:"absolute",left:"14px",top:"50%",transform:"translateY(-50%)",color:"#d97706",fontSize:"16px"}}),(0,s.jsx)("input",{type:"text",placeholder:"Search by Employee ID or Name...",value:Di,onChange:e=>Li(e.target.value),style:{width:"100%",padding:"12px 16px 12px 42px",border:"2px solid #fbbf24",borderRadius:"8px",fontSize:"14px",outline:"none",transition:"all 0.2s ease",background:"white"},onFocus:e=>{e.target.style.borderColor="#f59e0b",e.target.style.boxShadow="0 0 0 3px rgba(245, 158, 11, 0.1)"},onBlur:e=>{e.target.style.borderColor="#fbbf24",e.target.style.boxShadow="none"}}),(0,s.jsxs)("div",{style:{marginTop:"8px",color:"#6b7280",fontSize:"13px"},children:["Showing ",(0,s.jsx)("strong",{children:"active"})," transferred employees only"]})]})}),(0,s.jsx)("div",{style:{padding:"24px 32px",flex:1,overflow:"auto"},children:ki?(0,s.jsxs)("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",padding:"60px 20px",gap:"16px"},children:[(0,s.jsx)("div",{className:"spinner-border",role:"status",style:{color:"#f59e0b"},children:(0,s.jsx)("span",{className:"visually-hidden",children:"Loading..."})}),(0,s.jsx)("p",{style:{color:"#6b7280",margin:0},children:"Loading transferred employees..."})]}):(()=>{const e=Ni.filter(e=>{if(!Di.trim())return!0;const i=Di.toLowerCase().trim(),o=String((null===e||void 0===e?void 0:e.EMP_NUMBER)||(null===e||void 0===e?void 0:e.empNumber)||(null===e||void 0===e?void 0:e.EMP_ID)||(null===e||void 0===e?void 0:e.emp_id)||"").toLowerCase(),n=String((null===e||void 0===e?void 0:e.FULLNAME)||(null===e||void 0===e?void 0:e.fullName)||(null===e||void 0===e?void 0:e.CALLING_NAME)||(null===e||void 0===e?void 0:e.calling_name)||(null===e||void 0===e?void 0:e.name)||"").toLowerCase();return o.includes(i)||n.includes(i)});return 0===e.length?(0,s.jsxs)("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",padding:"60px 20px",gap:"12px"},children:[(0,s.jsx)("i",{className:"bi bi-inbox",style:{fontSize:"48px",color:"#d1d5db"}}),(0,s.jsx)("p",{style:{color:"#6b7280",margin:0,fontSize:"16px"},children:Di?"No transferred employees match your search":"No transferred employees found for this sub-section"})]}):(0,s.jsx)("div",{style:{border:"1px solid #e5e7eb",borderRadius:"12px",overflow:"hidden"},children:(0,s.jsxs)("table",{style:{width:"100%",borderCollapse:"collapse"},children:[(0,s.jsx)("thead",{children:(0,s.jsxs)("tr",{style:{background:"linear-gradient(135deg, #f59e0b 0%, #d97706 100%)"},children:[(0,s.jsx)("th",{style:{padding:"14px 16px",width:"40px",textAlign:"center"},children:(0,s.jsx)("input",{type:"checkbox",checked:(()=>{try{const e=Ni.filter(e=>{if(!Di.trim())return!0;const i=Di.toLowerCase().trim(),o=String((null===e||void 0===e?void 0:e.EMP_NUMBER)||(null===e||void 0===e?void 0:e.empNumber)||(null===e||void 0===e?void 0:e.EMP_ID)||(null===e||void 0===e?void 0:e.emp_id)||"").toLowerCase(),n=String((null===e||void 0===e?void 0:e.FULLNAME)||(null===e||void 0===e?void 0:e.fullName)||(null===e||void 0===e?void 0:e.CALLING_NAME)||(null===e||void 0===e?void 0:e.calling_name)||(null===e||void 0===e?void 0:e.name)||"").toLowerCase();return o.includes(i)||n.includes(i)});return e.length>0&&fi.size===e.length}catch(e){return!1}})(),onChange:e=>{const i=!!e.target.checked,o=Ni.filter(e=>{if(!Di.trim())return!0;const i=Di.toLowerCase().trim(),o=String((null===e||void 0===e?void 0:e.EMP_NUMBER)||(null===e||void 0===e?void 0:e.empNumber)||(null===e||void 0===e?void 0:e.EMP_ID)||(null===e||void 0===e?void 0:e.emp_id)||"").toLowerCase(),n=String((null===e||void 0===e?void 0:e.FULLNAME)||(null===e||void 0===e?void 0:e.fullName)||(null===e||void 0===e?void 0:e.CALLING_NAME)||(null===e||void 0===e?void 0:e.calling_name)||(null===e||void 0===e?void 0:e.name)||"").toLowerCase();return o.includes(i)||n.includes(i)});if(i){const e=new Set(o.map(e=>String((null===e||void 0===e?void 0:e.EMP_NUMBER)||(null===e||void 0===e?void 0:e.empNumber)||(null===e||void 0===e?void 0:e.EMP_ID)||(null===e||void 0===e?void 0:e.emp_id)||"")));yi(e)}else yi(new Set)},title:"Select all visible transferred employees"})}),(0,s.jsx)("th",{style:{padding:"14px 16px",textAlign:"left",color:"white",fontWeight:"600",fontSize:"13px"},children:"EMPLOYEE ID"}),(0,s.jsx)("th",{style:{padding:"14px 16px",textAlign:"left",color:"white",fontWeight:"600",fontSize:"13px"},children:"NAME"}),(0,s.jsx)("th",{style:{padding:"14px 16px",textAlign:"center",color:"white",fontWeight:"600",fontSize:"13px"},children:"STATUS"}),(0,s.jsx)("th",{style:{padding:"14px 16px",textAlign:"center",color:"white",fontWeight:"600",fontSize:"13px"},children:"ACTION"})]})}),(0,s.jsx)("tbody",{children:e.map((i,o)=>{const n=(null===i||void 0===i?void 0:i.EMP_NUMBER)||(null===i||void 0===i?void 0:i.empNumber)||(null===i||void 0===i?void 0:i.EMP_ID)||(null===i||void 0===i?void 0:i.emp_id);return(0,s.jsxs)("tr",{style:{borderBottom:o<e.length-1?"1px solid #e5e7eb":"none",transition:"all 0.2s ease"},onMouseOver:e=>e.currentTarget.style.background="#fef3c7",onMouseOut:e=>e.currentTarget.style.background="transparent",children:[(0,s.jsx)("td",{style:{padding:"12px 10px",textAlign:"center"},children:(0,s.jsx)("input",{type:"checkbox",checked:fi.has(String(n)),onChange:()=>{const e=String(n);yi(i=>{const o=new Set(Array.from(i));return o.has(e)?o.delete(e):o.add(e),o})},title:"Select transferred employee for recall"})}),(0,s.jsx)("td",{style:{padding:"12px 16px",fontSize:"14px",color:"#1f2937",fontWeight:"600"},children:n||"N/A"}),(0,s.jsx)("td",{style:{padding:"12px 16px",fontSize:"14px",color:"#1f2937"},children:(null===i||void 0===i?void 0:i.FULLNAME)||(null===i||void 0===i?void 0:i.fullName)||(null===i||void 0===i?void 0:i.CALLING_NAME)||(null===i||void 0===i?void 0:i.calling_name)||(null===i||void 0===i?void 0:i.name)||"N/A"}),(0,s.jsx)("td",{style:{padding:"12px 16px",textAlign:"center"},children:(()=>{const e=1===(null===i||void 0===i?void 0:i.ACTIVE_HRM_FLG)||"ACTIVE"===(null===i||void 0===i?void 0:i.STATUS)||"ACTIVE"===(null===i||void 0===i?void 0:i.status)||!0===(null===i||void 0===i?void 0:i.isActive);return(0,s.jsx)("span",{style:{padding:"4px 12px",borderRadius:"12px",fontSize:"12px",fontWeight:"600",background:e?"#dcfce7":"#fee2e2",color:e?"#16a34a":"#dc2626",display:"inline-block"},children:e?"Active":"Inactive"})})()}),(0,s.jsx)("td",{style:{padding:"12px 16px",textAlign:"center"},children:(0,s.jsxs)("button",{onClick:()=>{bi(!1),setTimeout(()=>{(e=>{vi(e),ui(!0)})(i)},200)},style:{padding:"8px 16px",border:"none",borderRadius:"6px",background:"linear-gradient(135deg, #ef4444 0%, #dc2626 100%)",color:"white",fontSize:"13px",fontWeight:"600",cursor:"pointer",transition:"all 0.2s ease",display:"inline-flex",alignItems:"center",gap:"6px"},onMouseOver:e=>{e.currentTarget.style.transform="translateY(-1px)",e.currentTarget.style.boxShadow="0 4px 12px rgba(239, 68, 68, 0.4)"},onMouseOut:e=>{e.currentTarget.style.transform="translateY(0)",e.currentTarget.style.boxShadow="none"},title:"Recall employee transfer from this sub-section",children:[(0,s.jsx)("i",{className:"bi bi-arrow-counterclockwise"}),"Recall"]})})]},n||o)})})]})})})()}),(0,s.jsxs)("div",{style:{padding:"20px 32px",borderTop:"1px solid #e5e7eb",background:"#f9fafb",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[(0,s.jsx)("div",{style:{fontSize:"14px",color:"#6b7280"},children:(()=>{const e=Ni.filter(e=>{if(!Di.trim())return!0;const i=Di.toLowerCase().trim(),o=String((null===e||void 0===e?void 0:e.EMP_NUMBER)||(null===e||void 0===e?void 0:e.empNumber)||(null===e||void 0===e?void 0:e.EMP_ID)||(null===e||void 0===e?void 0:e.emp_id)||"").toLowerCase(),n=String((null===e||void 0===e?void 0:e.FULLNAME)||(null===e||void 0===e?void 0:e.fullName)||(null===e||void 0===e?void 0:e.CALLING_NAME)||(null===e||void 0===e?void 0:e.calling_name)||(null===e||void 0===e?void 0:e.name)||"").toLowerCase();return o.includes(i)||n.includes(i)}).length;return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("strong",{style:{color:"#1f2937"},children:e})," transferred employee",1!==e?"s":"",Di&&e!==Ni.length&&(0,s.jsxs)("span",{style:{marginLeft:"8px",color:"#9ca3af"},children:["(filtered from ",Ni.length,")"]})]})})()}),(0,s.jsx)("button",{onClick:()=>ji(!0),disabled:0===fi.size,style:{padding:"10px 24px",border:"none",borderRadius:"8px",background:0===fi.size?"#d1d5db":"linear-gradient(135deg, #ef4444 0%, #dc2626 100%)",color:"white",fontSize:"14px",fontWeight:"600",cursor:0===fi.size?"not-allowed":"pointer",transition:"all 0.2s ease",marginLeft:"12px"},children:"Recall Selected"})]})]})}),pi&&xi&&ii&&(0,s.jsx)("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(0, 0, 0, 0.5)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:10001,padding:"20px"},children:(0,s.jsxs)("div",{style:{background:"white",borderRadius:"16px",maxWidth:"550px",width:"100%",boxShadow:"0 20px 60px rgba(0, 0, 0, 0.3)",overflow:"hidden"},children:[(0,s.jsxs)("div",{style:{background:"linear-gradient(135deg, #ef4444 0%, #dc2626 100%)",padding:"24px 32px",display:"flex",alignItems:"center",gap:"12px"},children:[(0,s.jsx)("i",{className:"bi bi-arrow-counterclockwise",style:{fontSize:"28px",color:"white"}}),(0,s.jsx)("h3",{style:{margin:0,color:"white",fontSize:"20px",fontWeight:"600"},children:"Confirm Recall Transfer"})]}),(0,s.jsxs)("div",{style:{padding:"32px"},children:[(0,s.jsxs)("div",{style:{background:"#fef2f2",borderRadius:"12px",padding:"20px",marginBottom:"24px",border:"2px solid #fecaca"},children:[(0,s.jsx)("div",{style:{fontSize:"16px",color:"#991b1b",marginBottom:"20px",lineHeight:"1.6",fontWeight:"600"},children:"Are you sure you want to recall the transfer for this employee?"}),(0,s.jsx)("div",{style:{fontSize:"14px",color:"#7f1d1d",marginBottom:"20px",lineHeight:"1.6"},children:"This will remove the employee from this sub-section."}),(0,s.jsxs)("div",{style:{background:"white",borderRadius:"8px",padding:"16px",marginBottom:"16px",border:"1px solid #fecaca"},children:[(0,s.jsx)("div",{style:{fontSize:"12px",color:"#991b1b",marginBottom:"4px"},children:"Employee"}),(0,s.jsx)("div",{style:{fontSize:"16px",color:"#1f2937",fontWeight:"600"},children:(null===xi||void 0===xi?void 0:xi.FULLNAME)||(null===xi||void 0===xi?void 0:xi.fullName)||(null===xi||void 0===xi?void 0:xi.CALLING_NAME)||"N/A"}),(0,s.jsxs)("div",{style:{fontSize:"13px",color:"#dc2626",marginTop:"4px"},children:["ID: ",(null===xi||void 0===xi?void 0:xi.EMP_NUMBER)||(null===xi||void 0===xi?void 0:xi.empNumber)||"N/A"]})]}),(0,s.jsxs)("div",{style:{background:"white",borderRadius:"8px",padding:"16px",border:"1px solid #fecaca"},children:[(0,s.jsxs)("div",{style:{fontSize:"12px",color:"#991b1b",marginBottom:"8px"},children:[(0,s.jsx)("i",{className:"bi bi-building"})," Current Assignment:"]}),(0,s.jsxs)("div",{style:{marginLeft:"16px"},children:[(0,s.jsxs)("div",{style:{fontSize:"14px",color:"#1f2937",marginBottom:"6px"},children:[(0,s.jsx)("strong",{children:"Sub-Section:"})," ",(null===ii||void 0===ii||null===(I=ii.subSection)||void 0===I?void 0:I.sub_hie_name)||(null===ii||void 0===ii||null===(E=ii.subSection)||void 0===E?void 0:E.hie_name)||"N/A"]}),(0,s.jsxs)("div",{style:{fontSize:"13px",color:"#6b7280",marginBottom:"4px"},children:[(0,s.jsx)("strong",{children:"Section:"})," ",(null===ii||void 0===ii||null===(A=ii.parentSection)||void 0===A?void 0:A.hie_name)||"N/A"]}),(0,s.jsxs)("div",{style:{fontSize:"13px",color:"#6b7280"},children:[(0,s.jsx)("strong",{children:"Division:"})," ",(null===ii||void 0===ii||null===(z=ii.parentDivision)||void 0===z?void 0:z.division_name)||"N/A"]})]})]})]}),(0,s.jsxs)("div",{style:{display:"flex",gap:"12px",justifyContent:"flex-end"},children:[(0,s.jsxs)("button",{onClick:()=>{ui(!1),vi(null)},disabled:gi,style:{padding:"12px 24px",border:"2px solid #d1d5db",borderRadius:"8px",backgroundColor:"white",color:"#6b7280",fontSize:"14px",fontWeight:"600",cursor:gi?"not-allowed":"pointer",transition:"all 0.2s ease",opacity:gi?.5:1},onMouseOver:e=>{gi||(e.target.style.borderColor="#9ca3af",e.target.style.color="#374151")},onMouseOut:e=>{gi||(e.target.style.borderColor="#d1d5db",e.target.style.color="#6b7280")},children:[(0,s.jsx)("i",{className:"bi bi-x-circle",style:{marginRight:"8px"}}),"Cancel"]}),(0,s.jsx)("button",{onClick:async()=>{if(!qi)return ui(!1),vi(null),Ji({type:"error",title:"Permission",message:"You do not have permission to recall transfers."});if(!xi||!ii)return;hi(!0);const e=localStorage.getItem("token");if(!e)return hi(!1),ui(!1),Ji({type:"error",title:"Auth",message:"Token missing. Please login."});const i=(null===xi||void 0===xi?void 0:xi.EMP_NUMBER)||(null===xi||void 0===xi?void 0:xi.empNumber)||(null===xi||void 0===xi?void 0:xi.EMP_ID)||(null===xi||void 0===xi?void 0:xi.emp_id),o=(null===xi||void 0===xi?void 0:xi.FULLNAME)||(null===xi||void 0===xi?void 0:xi.fullName)||(null===xi||void 0===xi?void 0:xi.CALLING_NAME)||(null===xi||void 0===xi?void 0:xi.calling_name)||(null===xi||void 0===xi?void 0:xi.name)||"Employee";try{console.log("RECALL PAYLOAD:",{employeeId:String(i),sub_section_id:null===ii||void 0===ii?void 0:ii._id}),console.log("\ud83d\udd04 Recalling transfer for:",{empId:i,sub_section_id:ii._id});const t=`${Gi}/mysql-subsections/recall-transfer?employeeId=${encodeURIComponent(String(i))}&sub_section_id=${encodeURIComponent(String(ii._id))}`;let l=await fetch(t,{method:"DELETE",headers:{Authorization:`Bearer ${e}`,"Content-Type":"application/json"},credentials:"include",body:JSON.stringify({employeeId:String(i),sub_section_id:ii._id})});if(l.ok||(console.warn("DELETE recall failed, attempting POST fallback...",l.status),l=await fetch(`${Gi}/mysql-subsections/recall-transfer`,{method:"POST",headers:{Authorization:`Bearer ${e}`,"Content-Type":"application/json"},credentials:"include",body:JSON.stringify({employeeId:String(i),sub_section_id:ii._id})})),!l.ok)throw new Error(`HTTP ${l.status}`);const r=await l.json();ci(e=>e.filter(e=>!(String(e.employeeId)===String(i)&&String(e.sub_section_id)===String(ii._id))));try{await eo(ii._id,e)}catch(n){console.warn("\u26a0\ufe0f Failed to refresh transferred list after recall:",n)}Ke(e=>e.some(e=>String((null===e||void 0===e?void 0:e.EMP_NUMBER)||(null===e||void 0===e?void 0:e.empNumber)||(null===e||void 0===e?void 0:e.EMP_ID)||"")===String(i))?e:[...e,xi]),yi(e=>{const o=new Set(Array.from(e));return o.has(String(i))&&o.delete(String(i)),o}),ui(!1),vi(null),hi(!1),Ji({type:"success",title:"Recalled!",message:`Successfully recalled the transfer for ${o}!`}),console.log("\u2705 Recall successful:",r),mi&&await to(ii)}catch(t){console.error("\u274c Recall failed:",t),hi(!1),ui(!1),Ji({type:"error",title:"Recall Failed",message:"Failed to recall the transfer. Please try again."})}},disabled:gi,style:{padding:"12px 24px",border:"none",borderRadius:"8px",background:gi?"#9ca3af":"linear-gradient(135deg, #ef4444 0%, #dc2626 100%)",color:"white",fontSize:"14px",fontWeight:"600",cursor:gi?"not-allowed":"pointer",transition:"all 0.2s ease",boxShadow:"0 3px 10px rgba(239, 68, 68, 0.3)",display:"flex",alignItems:"center",gap:"8px"},onMouseOver:e=>{gi||(e.target.style.transform="translateY(-1px)",e.target.style.boxShadow="0 4px 15px rgba(239, 68, 68, 0.4)")},onMouseOut:e=>{gi||(e.target.style.transform="translateY(0)",e.target.style.boxShadow="0 3px 10px rgba(239, 68, 68, 0.3)")},children:gi?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("span",{className:"spinner-border spinner-border-sm",role:"status","aria-hidden":"true"}),"Recalling..."]}):(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("i",{className:"bi bi-check-circle"}),"Confirm Recall"]})})]})]})]})}),Si&&ii&&(0,s.jsx)("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(0, 0, 0, 0.5)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:10001,padding:"20px"},children:(0,s.jsxs)("div",{style:{background:"white",borderRadius:"16px",maxWidth:"700px",width:"100%",boxShadow:"0 20px 60px rgba(0, 0, 0, 0.3)",overflow:"hidden"},children:[(0,s.jsxs)("div",{style:{background:"linear-gradient(135deg, #ef4444 0%, #dc2626 100%)",padding:"20px 28px",display:"flex",alignItems:"center",gap:"12px"},children:[(0,s.jsx)("i",{className:"bi bi-arrow-counterclockwise",style:{fontSize:"22px",color:"white"}}),(0,s.jsxs)("h3",{style:{margin:0,color:"white",fontSize:"18px",fontWeight:"600"},children:["Confirm Bulk Recall (",fi.size," selected)"]})]}),(0,s.jsxs)("div",{style:{padding:"24px"},children:[(0,s.jsxs)("p",{style:{fontSize:"14px",color:"#374151",marginBottom:"12px"},children:["You're about to recall the transfer for ",(0,s.jsx)("strong",{children:fi.size})," employee",1!==fi.size?"s":""," from:"]}),(0,s.jsxs)("div",{style:{padding:"12px 16px",background:"#fef2f2",borderRadius:"8px",border:"1px solid #fecaca"},children:[(0,s.jsx)("div",{style:{fontSize:"14px",color:"#1f2937",fontWeight:"600"},children:(null===ii||void 0===ii||null===(T=ii.subSection)||void 0===T?void 0:T.sub_hie_name)||(null===ii||void 0===ii||null===(M=ii.subSection)||void 0===M?void 0:M.hie_name)||"N/A"}),(0,s.jsx)("div",{style:{fontSize:"13px",color:"#6b7280"},children:(null===ii||void 0===ii||null===(R=ii.parentSection)||void 0===R?void 0:R.hie_name)||"Section: N/A"}),(0,s.jsx)("div",{style:{fontSize:"13px",color:"#6b7280"},children:(null===ii||void 0===ii||null===(D=ii.parentDivision)||void 0===D?void 0:D.division_name)||"Division: N/A"})]}),(0,s.jsxs)("div",{style:{marginTop:"18px"},children:[(0,s.jsx)("strong",{style:{color:"#374151"},children:"Selected employees preview:"}),(0,s.jsxs)("div",{style:{marginTop:"8px",maxHeight:"160px",overflowY:"auto",border:"1px solid #e5e7eb",borderRadius:"8px",padding:"8px"},children:[Array.from(fi).slice(0,10).map((e,i)=>{const o=Ni.find(i=>String((null===i||void 0===i?void 0:i.EMP_NUMBER)||(null===i||void 0===i?void 0:i.empNumber)||(null===i||void 0===i?void 0:i.EMP_ID)||(null===i||void 0===i?void 0:i.emp_id)||"")===e),n=(null===o||void 0===o?void 0:o.FULLNAME)||(null===o||void 0===o?void 0:o.fullName)||(null===o||void 0===o?void 0:o.CALLING_NAME)||(null===o||void 0===o?void 0:o.calling_name)||(null===o||void 0===o?void 0:o.name)||e;return(0,s.jsxs)("div",{style:{padding:"6px 8px",borderBottom:"1px dashed #e5e7eb",fontSize:"13px"},children:[e," - ",n]},e+i)}),fi.size>10&&(0,s.jsxs)("div",{style:{padding:"6px 8px",color:"#6b7280",fontSize:"13px"},children:["+ ",fi.size-10," more..."]})]})]})]}),(0,s.jsxs)("div",{style:{padding:"20px 28px",borderTop:"1px solid #e5e7eb",background:"#f9fafb",display:"flex",justifyContent:"flex-end",gap:"12px"},children:[(0,s.jsx)("button",{onClick:()=>ji(!1),disabled:_i,style:{padding:"10px 20px",border:"2px solid #d1d5db",borderRadius:"8px",backgroundColor:"white",color:"#6b7280",fontSize:"13px",fontWeight:"600",cursor:_i?"not-allowed":"pointer"},children:"Cancel"}),(0,s.jsx)("button",{onClick:async()=>{if(!qi)return ji(!1),Ji({type:"error",title:"Permission",message:"You do not have permission to recall transfers."});if(!ii||0===fi.size)return;wi(!0);const e=localStorage.getItem("token");if(!e)return wi(!1),ji(!1),Ji({type:"error",title:"Auth",message:"Token missing. Please login."});try{const o=Array.from(fi),n=o.map(e=>({employeeId:String(e),sub_section_id:ii._id}));let t=await fetch(`${Gi}/mysql-subsections/recall-transfer/bulk`,{method:"POST",headers:{Authorization:`Bearer ${e}`,"Content-Type":"application/json"},credentials:"include",body:JSON.stringify(n)});if(t.ok){const e=await t.json();console.log("Bulk recall result:",e)}else{console.warn("Bulk recall failed; falling back to individual recals",t.status);const i=[];for(const o of n){const n=await fetch(`${Gi}/mysql-subsections/recall-transfer`,{method:"POST",headers:{Authorization:`Bearer ${e}`,"Content-Type":"application/json"},credentials:"include",body:JSON.stringify(o)});i.push(n)}if(i.some(e=>!e.ok))throw new Error("One or more individual recalls failed during fallback")}Ci(e=>e.filter(e=>!fi.has(String((null===e||void 0===e?void 0:e.EMP_NUMBER)||(null===e||void 0===e?void 0:e.empNumber)||(null===e||void 0===e?void 0:e.EMP_ID)||(null===e||void 0===e?void 0:e.emp_id)||"")))),ci(e=>e.filter(e=>!fi.has(String(e.employeeId||e.employee_id||e.empId||e.emp_id)))),yi(new Set),ji(!1),wi(!1),Ji({type:"success",title:"Recalled",message:`${o.length} transfer${1!==o.length?"s":""} recalled successfully`});try{await eo(ii._id,e)}catch(i){console.warn("Failed to refresh transferred employees after bulk recall",i)}}catch(o){console.error("Bulk recall failed:",o),wi(!1),ji(!1),Ji({type:"error",title:"Recall Failed",message:"Bulk recall failed. Check console for details."})}},disabled:_i,style:{padding:"10px 20px",border:"none",borderRadius:"8px",background:_i?"#9ca3af":"linear-gradient(135deg, #ef4444 0%, #dc2626 100%)",color:"white",fontSize:"13px",fontWeight:"600",cursor:_i?"not-allowed":"pointer"},children:_i?"Recalling...":`Confirm (${fi.size})`})]})]})})]})}},154:(e,i,o)=>{o.d(i,{M5:()=>d,Vv:()=>s});let n=null;const t=()=>(n||(n=document.createElement("div"),n.id="modern-alert-container",n.className="modern-alert-container",document.body.appendChild(n)),n),l=()=>`alert-${Date.now()}-${Math.random().toString(36).substr(2,9)}`,r=e=>{const i={success:"bi-check-circle-fill",error:"bi-x-circle-fill",warning:"bi-exclamation-triangle-fill",info:"bi-info-circle-fill",question:"bi-question-circle-fill"};return i[e]||i.info},s=e=>{let{type:i="info",title:o="",message:n="",duration:s=3e3,showConfetti:d=!1}=e;const c=t(),u=l(),x=document.createElement("div");if(x.id=u,x.className=`modern-alert modern-alert-${i} modern-alert-enter`,x.innerHTML=`\n    <div class="modern-alert-content">\n      <div class="modern-alert-icon">\n        <i class="bi ${r(i)}"></i>\n      </div>\n      <div class="modern-alert-body">\n        ${o?`<div class="modern-alert-title">${o}</div>`:""}\n        <div class="modern-alert-message">${n}</div>\n      </div>\n      <button class="modern-alert-close" onclick="this.closest('.modern-alert').remove()">\n        <i class="bi bi-x"></i>\n      </button>\n    </div>\n    <div class="modern-alert-progress"></div>\n  `,c.appendChild(x),setTimeout(()=>{x.classList.remove("modern-alert-enter"),x.classList.add("modern-alert-active")},10),d&&"success"===i&&p(),s>0){const e=x.querySelector(".modern-alert-progress");e&&(e.style.animationDuration=`${s}ms`),setTimeout(()=>{a(u)},s)}return u},d=e=>{let{title:i="Confirm",message:o="Are you sure?",confirmText:n="Confirm",cancelText:s="Cancel",type:d="warning",showIcon:a=!0}=e;return new Promise(e=>{const p=t(),u=l(),x=document.createElement("div");x.id=u,x.className="modern-dialog-overlay modern-dialog-enter",x.innerHTML=`\n      <div class="modern-dialog modern-dialog-${d}">\n        <div class="modern-dialog-content">\n          ${a?`\n            <div class="modern-dialog-icon">\n              <i class="bi ${r("danger"===d?"error":d)}"></i>\n            </div>\n          `:""}\n          <div class="modern-dialog-body">\n            <h3 class="modern-dialog-title">${i}</h3>\n            <p class="modern-dialog-message">${o}</p>\n          </div>\n        </div>\n        <div class="modern-dialog-footer">\n          <button class="modern-btn modern-btn-cancel" data-action="cancel">\n            <i class="bi bi-x-circle"></i>\n            ${s}\n          </button>\n          <button class="modern-btn modern-btn-confirm modern-btn-${d}" data-action="confirm">\n            <i class="bi bi-check-circle"></i>\n            ${n}\n          </button>\n        </div>\n      </div>\n    `,p.appendChild(x),setTimeout(()=>{x.classList.remove("modern-dialog-enter"),x.classList.add("modern-dialog-active")},10),x.addEventListener("click",i=>{if(i.target.closest("[data-action]")){const o=i.target.closest("[data-action]").dataset.action;c(u),e("confirm"===o)}else i.target===x&&(c(u),e(!1))})})},a=e=>{const i=document.getElementById(e);i&&(i.classList.remove("modern-alert-active"),i.classList.add("modern-alert-exit"),setTimeout(()=>{i.remove()},300))},c=e=>{const i=document.getElementById(e);i&&(i.classList.remove("modern-dialog-active"),i.classList.add("modern-dialog-exit"),setTimeout(()=>{i.remove()},300))},p=()=>{const e=document.body;for(let i=0;i<50;i++){const i=document.createElement("div");i.className="confetti",i.style.left=100*Math.random()+"%",i.style.animationDelay=.5*Math.random()+"s",i.style.backgroundColor=u(),e.appendChild(i),setTimeout(()=>i.remove(),3e3)}},u=()=>{const e=["#ff6b6b","#4ecdc4","#45b7d1","#f9ca24","#6c5ce7","#a29bfe","#fd79a8"];return e[Math.floor(Math.random()*e.length)]}}}]);
//# sourceMappingURL=110.df3e3505.chunk.js.map